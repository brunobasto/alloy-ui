AUI.add("aui-scheduler-base",function(ab){var O=ab.Lang,av=O.isString,a=O.isArray,d=O.isDate,I=O.isNumber,B=O.isObject,H=function(A){return(A instanceof ab.Scheduler);},s=function(A){return(A instanceof ab.SchedulerView);},Z=function(A){return(A instanceof ab.SchedulerEvent);},t=function(A){return(ab.SchedulerCalendar&&(A instanceof ab.SchedulerCalendar));},h=ab.DataType.DateMath,V=ab.WidgetStdMod,T=".",o="",p=" ",r="scheduler-base",ah="data-view-name",F="activeView",au="clearfix",E="controls",aj="controlsNode",am="current",aa="currentDate",X="currentDateNode",ai="date",af="endDate",ag="eventClass",aw="events",aB="hd",v="header",at="headerNode",m="helper",R="icon",j="iconNextNode",ap="iconPrevNode",az="locale",l="name",P="nav",M="navNode",ao="navigationDateFormat",n="next",c="nextDate",ar="prev",ak="prevDate",aA="rendered",L="scheduler",ax="startDate",D="strings",e="today",ac="todayNode",u="triggerNode",y="view",N="viewStack",aC="views",W="viewsNode",z=ab.getClassName,ad=z(m,au),i=z(R),an=z(r,E),S=z(r,am,ai),f=z(r,aB),U=z(r,R,n),C=z(r,R,ar),ay=z(r,P),x=z(r,e),Y=z(r,y),g=z(r,y,o),q=z(r,aC),al='<div class="'+an+'"></div>',w='<div class="'+S+'"></div>',b='<div class="'+f+'"></div>',aD='<a href="#" class="'+[i,U].join(p)+'">Next</a>',ae='<a href="#" class="'+[i,C].join(p)+'">Prev</a>',k='<div class="'+ay+'"></div>',Q='<a href="#" class="'+x+'">{today}</a>',aq='<a href="#" class="'+[Y,g].join(p)+'{name}" data-view-name="{name}">{label}</a>',J='<div class="'+q+'"></div>';var K=function(){};K.ATTRS={eventClass:{valueFn:function(){return ab.SchedulerEvent;}},events:{value:[],setter:"_setEvents",validator:a}};ab.mix(K.prototype,{addEvent:function(aE){var A=this;var aF=A.get(aw);if(ab.Array.indexOf(aF,aE)>-1){ab.Array.removeItem(aF,aE);}aF.push(aE);A.set(aw,aF);},addEvents:function(aE){var A=this;ab.Array.each(A._normalizeEvents(aE),ab.bind(A.addEvent,A));},eachEvent:function(aF){var A=this;var aE=A.get(aw);ab.Array.each(aE,aF,A);},removeEvent:function(aE){var A=this;var aF=A.get(aw);if(aF.length){ab.Array.removeItem(aF,aE);A.set(aw,aF);}},removeEvents:function(aE){var A=this;ab.Array.each(A._normalizeEvents(aE),ab.bind(A.removeEvent,A));},_normalizeEvents:function(aF){var A=this;var aE=[];aF=ab.Array(aF);ab.Array.each(aF,function(aG){if(Z(aG)){aE.push(aG);}else{if(t(aG)){if(H(A)){aG.set(L,A);}aE=aE.concat(A._normalizeEvents(aG.get(aw)));}else{aG=new (A.get(ag))(aG);aE.push(aG);}}if(H(A)){aG.set(L,A);aG.set(ag,A.get(ag));}});return aE;},_setEvents:function(aE){var A=this;return A._normalizeEvents(aE);}});ab.SchedulerEventSupport=K;var G=ab.Component.create({NAME:r,ATTRS:{activeView:{validator:s},eventRecorder:{setter:"_setEventRecorder"},strings:{value:{day:"Day",month:"Month",today:"Today",week:"Week",year:"Year"}},navigationDateFormat:{getter:function(aF){var A=this;var aE=A.get(F);if(aE){return aE.get(ao);}return aF;},value:"%A - %d %b %Y",validator:av},views:{setter:"_setViews",value:[]},currentDate:{valueFn:function(){return new Date();},validator:d},firstDayOfWeek:{value:0,validator:I},controlsNode:{valueFn:function(){return ab.Node.create(al);}},currentDateNode:{valueFn:function(){return ab.Node.create(w);}},headerNode:{valueFn:function(){return ab.Node.create(b);}},iconNextNode:{valueFn:function(){return ab.Node.create(aD);}},iconPrevNode:{valueFn:function(){return ab.Node.create(ae);}},navNode:{valueFn:function(){return ab.Node.create(k);}},todayNode:{valueFn:function(){return ab.Node.create(this._processTemplate(Q));}},viewsNode:{valueFn:function(){return ab.Node.create(J);}}},HTML_PARSER:{controlsNode:T+an,currentDateNode:T+S,headerNode:T+f,iconNextNode:T+U,iconPrevNode:T+C,navNode:T+ay,todayNode:T+x,viewsNode:T+q},UI_ATTRS:[aa],AUGMENTS:[ab.SchedulerEventSupport,ab.WidgetStdMod],prototype:{viewStack:null,initializer:function(){var A=this;A[N]={};A[aj]=A.get(aj);A[X]=A.get(X);A[v]=A.get(at);A[j]=A.get(j);A[ap]=A.get(ap);A[M]=A.get(M);A[ac]=A.get(ac);A[W]=A.get(W);A.after({activeViewChange:A._afterActiveViewChange,render:A._afterRender});},bindUI:function(){var A=this;A._bindDelegate();},syncUI:function(){var A=this;A.syncStdContent();},flushEvents:function(){var A=this;ab.Array.each(A.get(aw),function(aE){aE.eachRepeatedEvent(function(aF){delete aF._filtered;});delete aE._filtered;});},getEventsByDay:function(aE,aF){var A=this;aE=h.safeClearTime(aE);return A._getEvents(aE,function(aG){return h.compare(aG.getClearStartDate(),aE)||(aF&&h.compare(aG.getClearEndDate(),aE));});},getIntersectEvents:function(aE){var A=this;aE=h.safeClearTime(aE);return A._getEvents(aE,function(aG){var aF=aG.getClearStartDate();var aH=aG.getClearEndDate();return(h.compare(aE,aF)||h.compare(aE,aH)||h.between(aE,aF,aH));});},sortEventsByDateAsc:function(aE){var A=this;aE.sort(function(aI,aG){var aH=aI.get(af);var aF=aG.get(af);var aK=aI.get(ax);var aJ=aG.get(ax);if(h.after(aK,aJ)||(h.compare(aK,aJ)&&h.before(aH,aF))){return 1;}else{return -1;}});},getViewByName:function(aE){var A=this;return A[N][aE];},getStrings:function(){var A=this;return A.get(D);},getString:function(aE){var A=this;return A.getStrings()[aE];},renderView:function(aE){var A=this;if(aE){aE.show();if(!aE.get(aA)){if(!A.bodyNode){A.setStdModContent(V.BODY,o);}aE.render(A.bodyNode);}}},plotViewEvents:function(aE){var A=this;aE.plotEvents(A.get(aw));},syncEventsUI:function(){var A=this;A.plotViewEvents(A.get(F));},_afterActiveViewChange:function(aG){var aE=this;if(aE.get(aA)){var aF=aG.newVal;var A=aG.prevVal;if(A){A.hide();}aE.renderView(aF);}},_afterRender:function(aE){var A=this;A.renderView(A.get(F));},_bindDelegate:function(){var A=this;A[W].delegate("click",A._onClickViewTrigger,T+Y,A);A[aj].delegate("click",A._onClickPrevIcon,T+C,A);A[aj].delegate("click",A._onClickNextIcon,T+U,A);A[aj].delegate("click",A._onClickToday,T+x,A);},_createViewTriggerNode:function(aE){var A=this;if(!aE.get(u)){var aF=aE.get(l);aE.set(u,ab.Node.create(O.sub(aq,{name:aF,label:(A.getString(aF)||aF)})));}return aE.get(u);},_getEvents:function(aE,aH){var A=this;var aG=A.get(aw);
var aF=[];ab.Array.each(aG,function(aI){if(aH.apply(A,[aI])){aF.push(aI);}else{if(aI.isRepeatableDate(aE)){var aJ=aI.repeatByDate(aE);aF.push(aJ);}}});A.sortEventsByDateAsc(aF);return aF;},_onClickToday:function(aE){var A=this;A.set(aa,A.get(F).getToday());aE.preventDefault();},_onClickNextIcon:function(aE){var A=this;A.set(aa,A.get(F).get(c));aE.preventDefault();},_onClickPrevIcon:function(aE){var A=this;A.set(aa,A.get(F).get(ak));aE.preventDefault();},_onClickViewTrigger:function(aE){var A=this;var aF=aE.currentTarget.attr(ah);A.set(F,A.getViewByName(aF));aE.preventDefault();},_processTemplate:function(aE){var A=this;return O.sub(aE,A.getStrings());},_setEventRecorder:function(aE){var A=this;if(aE){aE.set(L,A);aE.set(ag,A.get(ag));}},_setViews:function(aF){var A=this;var aE=[];ab.Array.each(aF,function(aG){if(s(aG)&&!aG.get(aA)){aG.set(L,A);aG.set(ag,A.get(ag));aE.push(aG);A[N][aG.get(l)]=aG;}});if(!A.get(F)){A.set(F,aF[0]);}return aE;},syncStdContent:function(){var A=this;var aE=A.get(aC);A[M].append(A[ap]);A[M].append(A[j]);A[aj].append(A[ac]);A[aj].append(A[M]);A[aj].append(A[X]);ab.Array.each(aE,function(aF){A[W].append(A._createViewTriggerNode(aF));});A[v].append(A[aj]);A[v].append(A[W]);A[v].addClass(ad);A.setStdModContent(V.HEADER,A[v].getDOM());},_uiSetCurrentDate:function(aG){var A=this;var aF=ab.DataType.Date.format(aG,{format:A.get(ao),locale:A.get(az)});A[X].html(aF);if(A.get(aA)){var aE=A.get(F);if(aE){aE._uiSetCurrentDate(aG);}A.syncEventsUI();}}}});ab.Scheduler=G;},"@VERSION@",{skinnable:true,requires:["aui-scheduler-view","datasource"]});AUI.add("aui-scheduler-view",function(cE){var cS=cE.Lang,bb=cS.isBoolean,y=cS.isFunction,aL=cS.isNumber,c7=cS.isObject,cs=cS.isString,ce=function(A){return parseFloat(A)||0;},ch=function(dc,A){return Math.round(dc/A)*A;},au=cE.DataType.DateMath,cz=cE.WidgetStdMod,aT=au.WEEK_LENGTH,cj="scheduler-view",aK="scheduler-view-day",cZ="scheduler-view-month",b9="scheduler-view-table",cJ="scheduler-view-week",bp="activeColumn",cd="activeView",O="allDay",a1="boundingBox",da="cancel",ak="col",aB="colDaysNode",cH="colHeaderDaysNode",J="colblank",x="coldata",aN="colday",a="colgrid",Y="colspan",n="coltime",bK="columnData",a9="columnDayHeader",aP="columnShims",aY="columnTableGrid",bx="columnTime",aX="container",aU="content",bo="creationEndDate",ab="creationStartDate",bw="currentDate",bY="data",cP="day",U="days",C="delegateConfig",cc="disabled",a6="displayDaysInterval",Z="div",bI="division",c2="dotted",ad="down",G="draggingEvent",cr="duration",aF="endDate",bj="event",c1="eventClass",cb="eventPlaceholder",c9="eventRecorder",s="eventWidth",cy="filterFn",aM="first",cK="firstDayOfWeek",b2="fixedHeight",bs="grid",bV="gridContainer",bk="grip",c8="hd",cB="header",bu="headerDateFormat",c5="headerTableNode",bf="headerView",bG="headerViewConfig",aR="headerViewLabelNode",co="height",bm="horizontal",a0="host",aI="hourHeight",u="icon",u="icon",ao="isoTime",ae="label",a7="lasso",a2="left",aC="locale",ag="marker",bl="markercell",bd="markercellsNode",K="markers",b4="markersNode",b6="month",bq="monthContainerNode",cL="monthRowContainer",e="monthRows",D="mousedown",M="mousemove",a5="mouseup",aV="next",db="node",an="nomonth",av="noscroll",cA="offsetHeight",cC="offsetWidth",cF="pad",aO="paddingNode",cU="parentEvent",S="parentNode",bR="proxy",al="px",ah="region",a3="rendered",cw="repeated",cm="resizer",ct="resizerNode",cg="resizing",be="right",bO="row",bN="rowsContainerNode",ci="save",r="scheduler",aH="scheduler-event",aa="scrollable",T="shim",cI="startDate",X="startXY",cu="strings",a4="table",B="tableGridNode",bW="tableNode",b7="tableRowContainer",cY="tableRows",bT="tbody",g="td",bL="time",am="timesNode",i="title",ap="today",bP="top",c6="tr",bU="view",aA="visible",cV="week",b0="width",v="data-colnumber",k="a",bH=",",cf="-",cl=".",ca="",b1="%",W=" ",E=cE.getClassName,bJ=E(cj,av),af=E(cj,aa);var bc=cE.Component.create({NAME:cj,AUGMENTS:[cE.WidgetStdMod],ATTRS:{bodyContent:{value:ca},eventClass:{valueFn:function(){return cE.SchedulerEvent;}},filterFn:{validator:y,value:function(A){return true;}},height:{value:600},isoTime:{value:false,validator:bb},name:{value:ca,validator:cs},navigationDateFormat:{value:"%A - %d %B, %Y",validator:cs},nextDate:{getter:"getNextDate",readOnly:true},prevDate:{getter:"getPrevDate",readOnly:true},scheduler:{lazyAdd:false,setter:"_setScheduler"},scrollable:{value:true,validator:bb},triggerNode:{setter:cE.one},visible:{value:false}},BIND_UI_ATTRS:[aa],prototype:{initializer:function(){var A=this;A.after("render",A._afterRender);},syncUI:function(){var A=this;A.syncStdContent();},adjustCurrentDate:function(){var A=this;var dd=A.get(r);var dc=dd.get(bw);dd.set(bw,dc);},flushViewCache:function(){},getNextDate:function(){},getPrevDate:function(){},getToday:function(){return au.clearTime(new Date());},limitDate:function(dc,dd){var A=this;if(au.after(dc,dd)){dc=au.clone(dd);}return dc;},plotEvents:function(){},syncStdContent:function(){},syncEventUI:function(A){},_uiSetCurrentDate:function(A){},_afterRender:function(dc){var A=this;A.adjustCurrentDate();A._uiSetScrollable(A.get(aa));},_setScheduler:function(dd){var A=this;var dc=A.get(r);if(dc){A.removeTarget(dc);}if(dd){A.addTarget(dd);dd.after("eventsChange",cE.bind(A.flushViewCache,A));}return dd;},_uiSetScrollable:function(dd){var A=this;var dc=A.bodyNode;if(dc){dc.toggleClass(af,dd);dc.toggleClass(bJ,!dd);}},_uiSetVisible:function(dc){var A=this;bc.superclass._uiSetVisible.apply(this,arguments);if(dc&&A.get(a3)){A.adjustCurrentDate();}}}});cE.SchedulerView=bc;var b8=cS.sub;var l=cE.cached(function(){var de=cE.config.doc,dc=de.createElement("div"),A=de.getElementsByTagName("body")[0],dd=0.1;if(A){dc.style.cssText="position:absolute;visibility:hidden;overflow:scroll;width:20px;";dc.appendChild(de.createElement("p")).style.height="1px";A.insertBefore(dc,A.firstChild);dd=dc.offsetWidth-dc.clientWidth;A.removeChild(dc);}return dd;},null,0.1);var N=function(A,dc){return function(de){var dd=de.all(A);return(dd.size()>=dc)?dd:null;
};},h=E(u),H=E(u,bk,c2,bm),aQ=E(aH),bC=E(aH,cc),cp=E(aH,bR),R=E(r,ap),ar=E(r,ap,c8),z=E(cj,x),d=E(cj,a),cM=E(cj,bs),cN=E(cj,bs,aX),aS=E(cj,cP,cm,u),cn=E(cj,cP,cm),bF=E(cj,ag,bI),cO=E(cj,bl),L=E(cj,K),bX=E(cj,cP,a4),cR=E(cj,cP,cB,a4),t=E(cj,cP,cB,cP),bE=E(cj,cP,cB,cP,cF,be),cq=E(cj,cP,cB,cP,aM),bi=E(cj,cP,cB,ak),br=E(cj,cP,cB,bU,ae),c3=E(cj,cP,a4,ak),aG=E(cj,cP,a4,ak,T),Q=E(cj,cP,a4,J),I=E(cj,cP,a4,aN),cW=E(cj,cP,a4,n),bM=E(cj,cP,a4,bL),p='<div class="'+cn+'">'+'<div class="'+[h,H,aS].join(W)+'"></div>'+"</div>",ai='<div class="'+cO+'">'+'<div class="'+bF+'"></div>'+"</div>",o='<span class="'+br+'">{label}</span>',ay='<table cellspacing="0" cellpadding="0" class="'+bX+'">'+"<tbody>"+'<tr class="'+d+'" height="1">'+'<td height="0" class="'+[c3,Q].join(W)+'"></td>'+'<td class="'+cN+'" colspan="1">'+'<div class="'+cM+'">'+'<div class="'+L+'"></div>'+"</div>"+"</td>"+"</tr>"+'<tr class="'+z+'">'+'<td class="'+[c3,cW].join(W)+'"></td>'+"</tr>"+"</tbody>"+"</table>",by='<td class="'+[c3,I].join(W)+'" data-colnumber="{colNumber}">'+'<div class="'+aG+'"></div>'+"</td>",j='<div class="'+bM+'">{hour}</div>',az='<table cellspacing="0" cellpadding="0" class="'+cR+'">'+"<tbody>"+'<tr class="'+bi+'"></tr>'+"</tbody>"+"</table>",bB='<th class="'+t+'" data-colnumber="{colNumber}"><a href="#">&nbsp;</a></th>',ax='<td class="'+[t,cq].join(W)+'"></td>',w='<th class="'+[t,bE].join(W)+'">&nbsp;</th>';var c4=cE.Component.create({NAME:aK,ATTRS:{bodyContent:{value:ca},days:{value:1,validator:aL},delegateConfig:{value:{},setter:function(dc){var A=this;return cE.merge({dragConfig:{useShim:false},bubbleTargets:A,container:A.get(a1),nodes:cl+aQ,invalid:"input, select, button, a, textarea, "+cl+bC},dc||{});},validator:c7},eventWidth:{value:95,validator:aL},filterFn:{value:function(A){return(A.getHoursDuration()<=24&&!A.get(O));}},headerDateFormat:{value:"%d %A",validator:cs},headerView:{value:true,validator:bb},headerViewConfig:{setter:function(dc){var A=this;return cE.merge({displayDaysInterval:1,displayRows:6,filterFn:function(dd){return((dd.getHoursDuration()>24)||dd.get(O));},height:"auto",visible:true},dc||{});},value:{}},hourHeight:{value:52,validator:aL},name:{value:cP},strings:{value:{allDay:"All day"}},headerTableNode:{valueFn:function(){return cE.Node.create(az);}},headerViewLabelNode:{valueFn:function(){var dc=this;var A=dc.get(cu);return cE.Node.create(b8(o,{label:A[O]}));}},resizerNode:{valueFn:function(){return cE.Node.create(p);}},tableNode:{valueFn:function(){return cE.Node.create(ay);}},colDaysNode:{valueFn:"_valueColDaysNode"},colHeaderDaysNode:{valueFn:"_valueColHeaderDaysNode"},markercellsNode:{valueFn:"_valueMarkercellsNode"},timesNode:{valueFn:"_valueTimesNode"}},HTML_PARSER:{colDaysNode:N(cl+I,1),colHeaderDaysNode:N(cl+t,2),headerTableNode:cl+cR,headerViewLabelNode:cl+br,markercellsNode:N(cl+cO,24),resizerNode:cl+cn,tableNode:cl+bX,timesNode:N(cl+bM,24)},EXTENDS:cE.SchedulerView,prototype:{initializer:function(){var A=this;A[aB]=A.get(aB);A[cH]=A.get(cH);A[c5]=A.get(c5);A[bd]=A.get(bd);A[ct]=A.get(ct);A[bW]=A.get(bW);A[am]=A.get(am);A[bp]=null;A[bK]=A[bW].one(cl+z);A[a9]=A.headerTableNode.one(cl+bi);A[aP]=A[aB].all(cl+aG);A[bx]=A[bW].one(cl+cW);A[bV]=A[bW].one(cl+cN);A[b4]=A[bW].one(cl+L);if(A.get(bf)){A[bf]=new cE.SchedulerTableView(A.get(bG));}},renderUI:function(){var A=this;A[bx].setContent(A[am]);A[b4].setContent(A[bd]);A[aB].appendTo(A[bK]);A[cH].appendTo(A[a9]);if(A[bf]){A[bf].set(r,A.get(r));A[bf].render();}},bindUI:function(){var A=this;A[c5].delegate("click",cE.bind(A._onClickDaysHeader,A),cl+t);A[bK].delegate("mousedown",cE.bind(A._onMouseDownTableCol,A),cl+c3);A[bK].delegate("mouseenter",cE.bind(A._onMouseEnterEvent,A),cl+aQ);A[bK].delegate("mouseleave",cE.bind(A._onMouseLeaveEvent,A),cl+aQ);A[bK].delegate("mousemove",cE.bind(A._onMouseMoveTableCol,A),cl+I);A[bK].delegate("mouseup",cE.bind(A._onMouseUpTableCol,A),cl+c3);A.on("drag:end",A._onEventDragEnd);A.on("drag:start",A._onEventDragStart);A.on("drag:tickAlignY",A._dragTickAlignY);A.on("schedulerChange",A._onSchedulerChange);A.after("drag:align",A._afterDragAlign);},syncUI:function(){var A=this;c4.superclass.syncUI.apply(this,arguments);A[bV].attr(Y,A.get(U));A._setupDragDrop();},syncStdContent:function(){var dc=this;dc.setStdModContent(cz.BODY,dc[bW].getDOM());var A=cE.NodeList.create(dc[c5]);if(dc[bf]){A.push(dc[bf].get(a1));A.push(dc.get(aR));}dc.setStdModContent(cz.HEADER,A);},calculateEventHeight:function(dd){var dc=this;var A=dc.get(aI);return Math.max(dd*(A/60),A/2);},calculateTop:function(dc){var A=this;return((dc.getHours()*60)+dc.getMinutes()+(dc.getSeconds()/60))*(A.get(aI)/60);},getNextDate:function(){var A=this;var dc=A.get(r).get(bw);return au.add(dc,au.DAY,1);},getPrevDate:function(){var A=this;var dc=A.get(r).get(bw);return au.subtract(dc,au.DAY,1);},getColumnByDate:function(dc){var A=this;return A[aB].item(A.getDateDaysOffset(dc));},getColumnShimByDate:function(dc){var A=this;return A[aP].item(A.getDateDaysOffset(dc));},getDateByColumn:function(dd){var A=this;var dc=au.safeClearTime(A.get(r).get(bw));return au.add(dc,au.DAY,dd);},getDateDaysOffset:function(dd){var A=this;var dc=au.safeClearTime(A.get(r).get(bw));return au.getDayOffset(au.safeClearTime(dd),dc);},getYCoordTime:function(df){var dc=this;var A=dc.get(aI);var dg=ce((df/A).toFixed(2));var de=Math.floor((dg*100)%100*0.6);var dd=Math.floor(dg);return[dd,de,0];},plotEvent:function(dd){var A=this;var de=dd.get(db);if(de.size()<2){dd.addPaddingNode();}var dg=dd.get(db).item(0);var dc=dd.get(db).item(1);var df=A.getColumnShimByDate(dd.get(aF));var dh=A.getColumnShimByDate(dd.get(cI));if(dh){dh.append(dg);if(dd.get(aA)){dg.show();}}else{dg.hide();}if(df){if(df.compareTo(dh)||dd.isDayBoundaryEvent()){dc.hide();}else{df.append(dc);if(dd.get(aA)){dc.show();}}}else{dc.hide();}A.syncEventTopUI(dd);A.syncEventHeightUI(dd);},plotEvents:function(){var A=this;var dc=A.get(r);var dd=A.get(cy);A[aP].each(function(dh,dg){var de=dc.getEventsByDay(A.getDateByColumn(dg),true);
var df=[];dh.empty();cE.Array.each(de,function(di){if(dd.apply(A,[di])){A.plotEvent(di);df.push(di);}});A.syncEventsIntersectionUI(df);});if(A.get(bf)){A.syncHeaderViewUI();}},syncColumnsUI:function(){var A=this;A[aB].each(function(de,dd){var dc=A.getDateByColumn(dd);de.toggleClass(R,au.isToday(dc));});},syncDaysHeaderUI:function(){var dd=this;var de=dd.get(r).get(bw);var dc=dd.get(bu);var A=dd.get(aC);dd[cH].all(k).each(function(dh,dg){var df=au.add(de,au.DAY,dg);var di=cE.DataType.Date.format(df,{format:dc,locale:A});dh.toggleClass(ar,au.isToday(df));dh.html(di);});},syncEventsIntersectionUI:function(dc){var A=this;var dd=A.get(s);A.get(r).flushEvents();cE.Array.each(dc,function(df){var dh=A.findEventIntersections(df,dc);var dg=dh.length;var de=(dd/dg);cE.Array.each(dh,function(dj,dk){var di=dj.get(db).item(0);var dm=de*dk;var dl=de*1.7;if(dk===(dg-1)){dl=dd-dm;}di.setStyle(b0,dl+b1);di.setStyle(a2,dm+b1);var dn=di.get(S);if(dn){dn.insert(di,dk);}dj._filtered=true;});});},syncEventHeightUI:function(de){var dc=this;var di=de.get(aF);var A=de.get(cI);var df=au.clone(A);df.setHours(24,0,0);var dg=au.getMinutesOffset(dc.limitDate(di,df),A);de.get(db).item(0).set(cA,dc.calculateEventHeight(dg));var dd=de.get(db).item(1);if(dd.inDoc()){var dh=au.getMinutesOffset(di,au.toMidnight(de.getClearEndDate()));dd.set(cA,dc.calculateEventHeight(dh));}},syncEventTopUI:function(dc){var A=this;dc.get(db).item(0).setStyle(bP,A.calculateTop(dc.get(cI))+al);dc.get(db).item(1).setStyle(bP,0);},syncHeaderViewUI:function(){var A=this;if(A.get(bf)){A[bf].plotEvents();var dd=A[bf].get(a1);dd.setStyle("marginRight",l());var dc=dd.one(cl+bh);A[bf].set(co,dc.get(cA));A._fillHeight();}},calculateYDelta:function(dd,dc){var A=this;return(dc[1]-dd[1])/(A.get(aI)/2)*30;},findEventIntersections:function(dc,dd){var A=this;var de=[];cE.Array.each(dd,function(df){if(!dc._filtered&&dc.intersectHours(df)){de.push(df);}});return de;},getXYDelta:function(dc){var A=this;var dd=dc.currentTarget.getXY(),de=[dc.pageX,dc.pageY];return cE.Array.map(dd,function(dg,df){return(de[df]-dg);});},getTickY:function(){var A=this;return ch(Math.ceil(A.get(aI)/2),10);},roundToNearestHour:function(dc,dd){var A=this;dc.setHours(dd[0],ch(dd[1],A.getTickY()),dd[2]);},_afterDragAlign:function(dd){var dc=this;var A=dd.target;if(!dc[X]){dc[X]=A.actXY;}A.actXY[0]=null;},_dragTickAlignX:function(dd){var dc=this;var dg=dc[G];if(dg&&!dc[cg]){var de=dc[cb];var df=ce(dd.attr(v))-dc.startColNumber;dc.draggingEventStartDate=au.add(dg.get(cI),au.DAY,df);var A=au.clone(dc.draggingEventStartDate);au.copyHours(A,de.get(cI));de.move(A);dc.plotEvent(de);}},_dragTickAlignY:function(A){var di=this;var dc=di.get(r);var dk=dc.get(c9);var df=di[G];if(df){var dj=A.target.get(a0);var dg=di[cb];var dh=di.calculateYDelta(di[X],dj.actXY);if(di[cg]){var de=au.add(di.draggingEventEndDate,au.MINUTES,dh);if(au.getMinutesOffset(de,di.draggingEventStartDate)<=dk.get(cr)){return;}dg.set(aF,de);}else{dg.move(au.add(di.draggingEventStartDate,au.MINUTES,dh));}di.plotEvent(dg);}},_setupDragDrop:function(){var dc=this;if(!dc[cb]){var dd=dc.get(r);dc[cb]=new (dc.get(c1))({scheduler:dd});dc[cb].removeTarget(dd);dc[cb].get(db).addClass(cp).hide();}if(!dc.delegate){dc.delegate=new cE.DD.Delegate(dc.get(C));}var A=dc.delegate.dd;A.unplug(cE.Plugin.DDConstrained);A.unplug(cE.Plugin.DDNodeScroll);var de=dc.bodyNode.get(ah);de.bottom=Infinity;de.top=-Infinity;A.plug(cE.Plugin.DDConstrained,{bubbleTargets:dc,constrain:de,stickY:true,tickY:dc.get(aI)/2});A.plug(cE.Plugin.DDNodeScroll,{node:dc.bodyNode,scrollDelay:150});},_uiSetCurrentDate:function(dc){var A=this;A.syncColumnsUI();A.syncDaysHeaderUI();},_onClickDaysHeader:function(de){var A=this;var dd=A.get(r);if(de.target.test(k)){var df=dd.getViewByName(cP);if(df){var dc=ce(de.currentTarget.attr(v));dd.set(bw,A.getDateByColumn(dc));dd.set(cd,df);}}de.preventDefault();},_onEventDragEnd:function(dc){var A=this;var de=A[G];if(de){var dd=A[cb];dd.set(aA,false);de.set(aA,true);de.copyDates(dd);A.get(r).syncEventsUI();}A[X]=null;A[G]=null;},_onEventDragStart:function(dd){var A=this;var df=A[G]=A.delegate.dd.get(db).getData(aH);if(df){var de=A[cb];de.copyPropagateAttrValues(df);A.plotEvent(de);df.set(aA,false);A.draggingEventStartDate=au.clone(df.get(cI));A.draggingEventEndDate=au.clone(df.get(aF));var dc=A.getColumnByDate(df.get(cI));A.startColNumber=dc?ce(dc.attr(v)):0;}},_onMouseDownTableCol:function(dc){var dh=this;var dg=dc.target;var de=dh.get(r);var di=de.get(c9);if(di&&!de.get(cc)){di.hideOverlay();if(dg.test(cl+aG)){dh[X]=[dc.pageX,dc.pageY];var dj=ce(dc.currentTarget.attr(v));var dd=dh.getDateByColumn(dj);var A=dh.getXYDelta(dc);dh.roundToNearestHour(dd,dh.getYCoordTime(A[1]));var df=au.add(dd,au.MINUTES,di.get(cr));di.move(dd);di.set(O,false);di.set(aF,df);dh[ab]=dd;dh[bo]=df;dc.halt();}else{if(dg.test([cl+cn,cl+aS].join(bH))){dh[cg]=true;}}}dh.get(a1).unselectable();},_onMouseEnterEvent:function(dc){var A=this;var dd=dc.currentTarget;A[ct].appendTo(dd);},_onMouseLeaveEvent:function(dc){var A=this;if(!A[cg]){A._removeResizer();}},_onMouseMoveTableCol:function(df){var A=this;var de=df.currentTarget;var dc=A.get(r).get(c9);if(A[bp]!==de){A[bp]=de;A._dragTickAlignX(A[bp]);}var dd=A[bo];var dg=A[ab];if(dg){var dh=ch(A.calculateYDelta(A[X],[df.pageX,df.pageY]),A.getTickY());if(A._delta!==dh){if(dh>0){dc.set(aF,au.add(dd,au.MINUTES,dh));}else{dc.set(cI,au.add(dg,au.MINUTES,dh));}A.plotEvent(dc);A._delta=dh;}}},_onMouseUpTableCol:function(de){var A=this;var dd=A.get(r);var dc=dd.get(c9);if(dc&&!dd.get(cc)){if(A[ab]){A.plotEvent(dc);dc.showOverlay();}}A[ab]=null;A[bo]=null;A[cg]=false;A[X]=null;A._removeResizer();A.get(a1).selectable();},_onSchedulerChange:function(dc){var A=this;if(A[bf]){A[bf].set(r,dc.newVal);}},_removeResizer:function(){var A=this;A[ct].remove();},_valueColDaysNode:function(){var A=this;var de=A.get(U);var dc=[],dd=0;while(de--){dc.push(cE.Lang.sub(by,{colNumber:dd++}));}return cE.NodeList.create(dc.join(ca));},_valueColHeaderDaysNode:function(){var A=this;
var de=A.get(U);var dc=[],dd=0;dc.push(ax);while(de--){dc.push(cE.Lang.sub(bB,{colNumber:dd++}));}dc.push(w);return cE.NodeList.create(dc.join(ca));},_valueMarkercellsNode:function(){var A=this;var dc=[],dd;for(dd=0;dd<=23;dd++){dc.push(ai);}return cE.NodeList.create(dc.join(ca));},_valueTimesNode:function(){var A=this;var de=A.get(ao);var dd=[],dc;for(dc=0;dc<=23;dc++){dd.push(b8(j,{hour:de?au.toIsoTimeString(dc):au.toUsTimeString(dc,false,true)}));}return cE.NodeList.create(dd.join(ca));}}});cE.SchedulerDayView=c4;var aq=cE.Component.create({NAME:cJ,ATTRS:{bodyContent:{value:ca},days:{value:7},headerViewConfig:{value:{displayDaysInterval:aT}},name:{value:cV}},EXTENDS:cE.SchedulerDayView,prototype:{adjustCurrentDate:function(){var A=this;var de=A.get(r);var dc=de.get(bw);var dd=de.get(cK);de.set(bw,au.getFirstDayOfWeek(dc,dd));},getNextDate:function(){var A=this;var dd=A.get(r);var dc=dd.get(bw);var de=A._firstDayOfWeek(dc);return au.add(de,au.WEEK,1);},getPrevDate:function(){var A=this;var dd=A.get(r);var dc=dd.get(bw);var de=A._firstDayOfWeek(dc);return au.subtract(de,au.WEEK,1);},getToday:function(){var A=this;var dc=aq.superclass.getToday.apply(this,arguments);return A._firstDayOfWeek(dc);},_firstDayOfWeek:function(dd){var A=this;var de=A.get(r);var dc=de.get(cK);return au.getFirstDayOfWeek(dd,dc);}}});cE.SchedulerWeekView=aq;var h=E(u),m=E(u,"arrowstop-1-l"),cX=E(u,"arrowstop-1-r"),q=E(cj,a4,a),aW=E(cj,a4,a,aM),aw=E(cj,a4,a,ap),bz=E(cj,a4,aX),at=E(cj,a4,cB,ak),cT=E(cj,a4,cB,cP),c=E(cj,a4,cB,a4),F=E(cj,a4,a7),cD=E(cj,a4,bO),bZ=E(cj,a4,bO,aX),bh=E(cj,a4,bY),cx=E(cj,a4,bY,ak),bS=E(cj,a4,bY,ak,i),cv=E(cj,a4,bY,ak,i,ad),b3=E(cj,a4,bY,ak,i,aM),c0=E(cj,a4,bY,ak,i,aV),bD=E(cj,a4,bY,ak,i,ap),aD=E(cj,a4,bY,bj),b=E(cj,a4,bY,bj,a2),cG=E(cj,a4,bY,bj,cw),aj=E(cj,a4,bY,bj,be),ac=E(cj,a4,bY,aM),aJ=E(cj,a4,bs),b5=E(cj,a4,bs,aM),aZ='<div class="'+bz+'">'+'<div class="'+bZ+'"></div>'+"</div>",ck='<td class="'+q+'">&nbsp;</td>',f='<th class="'+cT+'"><div>&nbsp;</div></th>',V='<table cellspacing="0" cellpadding="0" class="'+c+'">'+"<tbody>"+'<tr class="'+at+'"></tr>'+"</tbody>"+"</table>",bQ='<div class="'+F+'"></div>',bv='<div class="'+cD+'" style="top: {top}%; height: {height}%;"></div>',bA='<table cellspacing="0" cellpadding="0" class="'+bh+'">'+"<tbody></tbody>"+"</table>",a8='<table cellspacing="0" cellpadding="0" class="'+aJ+'">'+"<tbody>"+"<tr></tr>"+"</tbody>"+"</table>",P='<span class="'+[h,m].join(W)+'"></span>',bn='<span class="'+[h,cX].join(W)+'"></span>',bt='<td class="'+cx+'"><div></div></td>',cQ="<tr></tr>";var ba=cE.Component.create({NAME:b9,ATTRS:{bodyContent:{value:ca},displayDaysInterval:{value:42},displayRows:{value:4},fixedHeight:{value:true},name:{value:a4},headerDateFormat:{value:"%a"},navigationDateFormat:{value:"%b %Y"},scrollable:{value:false},headerTableNode:{valueFn:function(){return cE.Node.create(V);}},colHeaderDaysNode:{valueFn:"_valueColHeaderDaysNode"},rowsContainerNode:{valueFn:function(){return cE.Node.create(aZ);}},tableGridNode:{valueFn:"_valueTableGridNode"}},HTML_PARSER:{colHeaderDaysNode:N(cl+cT,7),headerTableNode:cl+c,rowsContainerNode:cl+bz,tableGridNode:N(cl+aJ,7)},EXTENDS:cE.SchedulerView,prototype:{evtDateStack:null,evtDataTableStack:null,initializer:function(){var A=this;A.evtDateStack={};A.evtDataTableStack={};A[cH]=A.get(cH);A[c5]=A.get(c5);A[bN]=A.get(bN);A[B]=A.get(B);A[a9]=A.headerTableNode.one(cl+at);A[aY]=cE.NodeList.create();A[b7]=A[bN].one(cl+bZ);A[cY]=cE.NodeList.create();},bindUI:function(){var A=this;var dc=A.get(r).get(c9);dc.on({cancel:cE.bind(A.removeLasso,A),save:cE.bind(A.removeLasso,A)});A[bN].on({mousedown:cE.bind(A._onMouseDownGrid,A),mousemove:cE.bind(A._onMouseMoveGrid,A),mouseup:cE.bind(A._onMouseUpGrid,A)});},renderUI:function(){var dc=this;var df=dc.get(a6);var dd=Math.ceil(df/aT);var dh=100/dd;for(var de=0;de<dd;de++){var A=dc._getTableGridNode(de);var dg=cE.Node.create(cS.sub(bv,{height:dh,top:dh*de}));dg.append(A.toggleClass(b5,(de===0)));dc[cY].push(dg);}dc[cH].appendTo(dc[a9]);dc[cY].appendTo(dc[b7]);},buildEventsTable:function(dc,dg){var dp=this;var dh=dp.get(a6);var dl=dp.get("displayRows");var dq=dp.get(cy);var dn=au.clearTime(dp._findCurrentIntervalEnd());var dk=au.clearTime(dp._findCurrentIntervalStart());var dj=String(dk.getTime()).concat(dc.getTime()).concat(dg.getTime());var di=dp.evtDataTableStack[dj];if(!di){di=cE.Node.create(bA);var dm=di.one(bT);var de=cE.Node.create(cQ);dp.loopDates(dc,dg,function(ds,dr){var dt=cE.Node.create(bt);dt.addClass(bS).toggleClass(b3,(dr===0)).toggleClass(bD,au.isToday(ds)).toggleClass(c0,au.isToday(au.subtract(ds,au.DAY,1))).toggleClass(cv,au.isToday(au.subtract(ds,au.WEEK,1)));de.append(dt.setContent(ds.getDate()));});dm.append(de);var A;for(A=0;A<dl;A++){var df=0;var dd=cE.Node.create(cQ);dp.loopDates(dc,dg,function(dC,dx){if(df<=dx){var dD=dp.getIntersectEvents(dC),dA=dD[A];var du=cE.Node.create(bt);if(dA&&dq.apply(dp,[dA])){var ds=dA.get(cI);var dy=!au.isDayOverlap(ds,dC);var dz=au.after(dC,ds)&&!au.isDayOverlap(dC,dc);if(dy||dz){var dt=dA.get(db);var dv=au.getFirstDayOfWeek(new Date(Math.max(ds,dk)));var dB=Math.floor(au.getDayOffset(dC,dv)/aT);if(dt.size()<=dB){dA.addPaddingNode();}var dw=dt.item(dB);dw.setStyles({height:"auto",left:0,top:0,width:"auto"});dA.syncNodeUI();var dr=du.one(Z);dw.appendTo(dr);var dE=dp._getEvtSplitInfo(dA,dC,dc,dg);du.attr(Y,dE.colspan);dr.addClass(aD);if(dE.left){dr.addClass(b).prepend(P);}if(dE.right){dr.addClass(aj).append(bn);}if(dA.get(cU)){dr.addClass(cG);}df+=dE.colspan;}else{df++;}}else{df++;}dd.append(du);}});dm.append(dd);}dp.evtDataTableStack[dj]=di;}return di;},flushViewCache:function(){var A=this;A.evtDateStack={};A.evtDataTableStack={};},getIntersectEvents:function(dc){var A=this;var df=A.get(r);var de=String(dc.getTime());if(!A.evtDateStack[de]){var dd=df.getIntersectEvents(dc);A.evtDateStack[de]=dd.filter(A.get(cy));}return A.evtDateStack[de];},getNextDate:function(){var A=this;var de=A.get(r);var dc=de.get(bw);var dd=A.get(a6);return au.add(dc,au.DAY,dd);
},getPrevDate:function(){var A=this;var de=A.get(r);var dc=de.get(bw);var dd=A.get(a6);return au.subtract(dc,au.DAY,dd);},loopDates:function(A,de,dh,di,dg){var dj=this;var dc=au.clone(A);var dd=de.getTime(),df;for(df=0;dc.getTime()<=dd;df++){dh.apply(dj,[dc,df]);dc=au.add(dc,(di||au.DAY),(dg||1));}},plotEvents:function(){var dc=this;var df=dc._findCurrentIntervalStart();var A=au.safeClearTime(df);dc.flushViewCache();dc.bodyNode.all(cl+bh).remove();var dd=dc.get(a6);var de=Math.min(dd,aT);dc[cY].each(function(dj,dh){var dg=au.add(A,au.DAY,de*dh);var dk=au.add(dg,au.DAY,de-1);var di=dc.buildEventsTable(dg,dk);if(dh===0){di.addClass(ac);}dj.append(di);});},removeLasso:function(){var A=this;if(A.lasso){A.lasso.remove();}},renderLasso:function(di,dc){var dp=this;var df=di;var dh=dc;if(di[1]>dc[1]){df=dc;dh=di;}var dq=df[0],dk=df[1],dd=dh[0],A=dh[1];dp.removeLasso();dp.lasso=cE.NodeList.create();for(var de=dk;de<=A;de++){var dg=dp.gridCellHeight,dn=dp.gridCellWidth,dl=0,dj=(dg*de);if(de===dk){if(dk===A){dl+=Math.min(dq,dd)*dn;dn*=Math.abs(dd-dq)+1;}else{dl+=dq*dn;dn*=aT-dq;}}else{if(de===A){dn*=dd+1;}else{dn*=aT;}}var dm=cE.Node.create(bQ);dp.lasso.push(dm);dp[bN].append(dm);dm.sizeTo(dn,dg);dm.setXY(dp._offsetXY([dl,dj],1));}},syncDaysHeaderUI:function(){var dd=this;var dg=dd.get(r);var de=dg.get(bw);var dc=dd.get(bu);var A=dd.get(aC);var df=dd._findFirstDayOfWeek(de);dd.colHeaderDaysNode.all(Z).each(function(dj,di){var dh=au.add(df,au.DAY,di);var dk=cE.DataType.Date.format(dh,{format:dc,locale:A});dj.html(dk);});},syncGridUI:function(){var dl=this;var df=dl.getToday();var dc=dl.get(r);dl[aY].removeClass(aw);var de=dl._findCurrentIntervalStart();var dh=dl._findCurrentIntervalEnd();if(au.between(df,de,dh)){var A=dc.get(cK);var dj=dl._findFirstDayOfWeek(df);var dg=au.getWeekNumber(df,A)-au.getWeekNumber(de,A);var dk=(df.getDate()-dj.getDate());var dd=dl._getCellIndex([dk,dg]);var di=dl[aY].item(dd);if(di){di.addClass(aw);}}},syncStdContent:function(){var A=this;A.setStdModContent(cz.BODY,A[bN].getDOM());A.setStdModContent(cz.HEADER,A[c5].getDOM());},_findCurrentIntervalEnd:function(){var A=this;var de=A.get(r);var dc=de.get(bw);var dd=A.get(a6);return au.add(dc,au.DAY,dd);},_findCurrentIntervalStart:function(){var A=this;var dc=A.get(r);return dc.get(bw);},_findFirstDayOfWeek:function(dd){var A=this;var de=A.get(r);var dc=de.get(cK);return au.getFirstDayOfWeek(dd,dc);},_getCellIndex:function(dc){var A=this;return dc[1]*aT+dc[0];},_getEvtLabel:function(dd){var dc=this;var de=dd.get(aF);var A=dd.get(cI);return[A.getHours(),cf,de.getHours(),W,dd.get(aU)].join(ca);},_getEvtSplitInfo:function(dg,dj,A,de){var dh=this;var dc=dg.getClearStartDate();var df=dg.getClearEndDate();var di=au.getDayOffset(de,dj);var dd={colspan:Math.min(au.getDayOffset(df,dj),di)+1,left:au.before(dc,A),right:au.after(df,de)};return dd;},_getPositionDate:function(dd){var dc=this;var de=dc._findCurrentIntervalStart();var A=au.safeClearTime(dc._findFirstDayOfWeek(de));return au.add(A,au.DAY,dc._getCellIndex(dd));},_getTableGridNode:function(dh){var dc=this;var de=dc.get(a6);var A=dc[B].item(dh);var dg=A.one(c6);for(var dd=0;dd<Math.min(de,aT);dd++){var df=cE.Node.create(ck);dg.append(df);dc[aY].push(df);}return A;},_offsetXY:function(de,dd){var A=this;var dc=A[bN].getXY();return[de[0]+dc[0]*dd,de[1]+dc[1]*dd];},_onMouseDownGrid:function(dg){var A=this;var dh=dg.target;if(dh.test([cl+q,cl+cx].join(bH))){A._recording=true;var de=A.get(a6);var dc=Math.ceil(de/aT);var df=Math.min(de,aT);A.gridCellHeight=A[bN].get(cA)/dc;A.gridCellWidth=A[bN].get(cC)/df;var dd=A._offsetXY([dg.pageX,dg.pageY],-1);A.lassoStartPosition=A.lassoLastPosition=A._findPosition(dd);A.renderLasso(A.lassoStartPosition,A.lassoLastPosition);A[bN].unselectable();}},_onMouseMoveGrid:function(df){var dc=this;var dg=df.currentTarget;var dd=dc._offsetXY([df.pageX,df.pageY],-1);var de=dc.lassoLastPosition||dc.lassoStartPosition;var A=dc._findPosition(dd);var dh=de&&((A[0]!==de[0])||(A[1]!==de[1]));if(dh&&dc._recording){dc.lassoLastPosition=A;dc.renderLasso(dc.lassoStartPosition,A);}},_onMouseUpGrid:function(dh){var dc=this;var dg=dc.get(r);var de=dg.get(c9);if(de&&dc._recording&&!dg.get(cc)){var df=dc._getPositionDate(dc.lassoStartPosition);var dd=dc._getPositionDate(dc.lassoLastPosition);var A=new Date(Math.min(df,dd));A.setHours(0,0,0);var di=new Date(Math.max(df,dd));di.setHours(23,59,59);de.set(O,true);de.set(aF,di);de.set(cI,A);de.showOverlay([dh.pageX,dh.pageY]);dc._recording=false;}},_findPosition:function(de){var A=this;var dd=Math.floor(de[0]/A.gridCellWidth);var dc=Math.floor(de[1]/A.gridCellHeight);return[dd,dc];},_uiSetCurrentDate:function(dc){var A=this;A.syncDaysHeaderUI();A.syncGridUI();},_valueColHeaderDaysNode:function(){var A=this;var dc=A.get(a6);var dd=Math.min(dc,aT);return A._valueNodeList(dd,f);},_valueTableGridNode:function(){var A=this;var dc=A.get(a6);var dd=Math.min(dc,aT);return A._valueNodeList(dd,a8);},_valueNodeList:function(de,dd){var A=this;var dc=[];while(de--){dc.push(dd);}return cE.NodeList.create(dc.join(ca));}}});cE.SchedulerTableView=ba;var bg=E(cZ,a4,bY,ak,an);var aE=cE.Component.create({NAME:cZ,ATTRS:{displayDaysInterval:{readOnly:true,value:42},name:{value:b6}},EXTENDS:cE.SchedulerTableView,prototype:{getNextDate:function(){var A=this;var dd=A.get(r);var dc=dd.get(bw);return au.add(dc,au.MONTH,1);},getPrevDate:function(){var A=this;var dd=A.get(r);var dc=dd.get(bw);return au.subtract(dc,au.MONTH,1);},plotEvents:function(){var A=this;cE.SchedulerMonthView.superclass.plotEvents.apply(A,arguments);var dd=A.get(r);var dc=dd.get(bw);var dg=au.findMonthEnd(dc);var df=au.findMonthStart(dc);var de=A._findCurrentIntervalStart();var dh=A[b7].all(cl+bS);dh.each(function(dk,di){var dj=au.add(de,au.DAY,di);if(au.before(dj,df)||au.after(dj,dg)){dk.addClass(bg);}});},_findCurrentIntervalStart:function(){var A=this;var de=A.get(r);var dc=de.get(bw);var dd=au.findMonthStart(dc);return A._findFirstDayOfWeek(dd);},_findFirstDayOfWeek:function(dd){var A=this;
var de=A.get(r);var dc=de.get(cK);return au.getFirstDayOfWeek(dd,dc);}}});cE.SchedulerMonthView=aE;},"@VERSION@",{skinnable:true,requires:["aui-scheduler-event","aui-calendar","aui-button-item","dd-drag","dd-delegate","dd-drop","dd-constrain"]});AUI.add("aui-scheduler-event",function(aL){var ao=aL.Lang,bk=ao.isString,f=ao.isDate,ba=ao.isFunction,G=ao.isObject,bd=ao.isBoolean,ae=ao.isNumber,aZ=aL.ColorUtil,j=aL.DataType.DateMath,a6=aL.cached(function(A){return A.substring(0,1).toUpperCase()+A.substring(1);}),bf="-",t="&ndash;",az=".",p="",q=" ",l="_",aN="_propagateSet",Q="activeView",T="borderColor",aP="borderColorRGB",aJ="borderStyle",br="borderWidth",I="Change",a4="color",aX="colorBrightnessFactor",be="colorSaturationFactor",aH="content",w="disabled",a1="duration",aQ="endDate",aT="eventClass",ar="eventStack",bl="events",av="hidden",H="hsbColor",au="icon",ab="icons",a2="id",aY="isoTime",bq="locale",a0="never",n="node",h="overlay",aM="parentEvent",bw="recorder",aO="repeat",bj="repeated",P="repeatedEvents",bc="repeater",ah="scheduler",aw="scheduler-event",ay="scheduler-event-recorder",bn="startDate",a8="template",aW="title",e="titleDateFormat",ap="visible",d="%H:%M",a7="%I:%M",E=aL.getClassName,k=E(au),s=E(aw),aR=E(aw,aH),C=E(aw,av),bh=E(aw,w),aq=E(aw,bw),aC=E(aw,bj),an=E(aw,bc),D=E(aw,aW),bp=E(aw,ab),v=E(aw,au,w),b=E(aw,au,bj),bt=E(aw,au,bc);var V=aL.Component.create({NAME:aw,ATTRS:{allDay:{value:false,validator:bd},borderStyle:{value:"solid",validator:bk},borderWidth:{value:"1px",validator:bk},colorBrightnessFactor:{value:0.75,validator:ae},colorSaturationFactor:{value:1.5,validator:ae},content:{value:"(no title)",validator:bk},color:{lazyAdd:false,setter:"_setColor",value:"#D96666",validator:bk},titleDateFormat:{getter:"_getTitleDateFormat",validator:bk},endDate:{setter:"_setDate",valueFn:function(){var A=j.clone(this.get(bn));A.setHours(A.getHours()+1);return A;}},eventClass:{valueFn:function(){return aL.SchedulerEvent;}},disabled:{value:false,validator:bd},node:{valueFn:function(){return aL.NodeList.create(aL.Node.create(this.EVENT_NODE_TEMPLATE).setData(aw,this));}},parentEvent:{},repeat:{value:p,setter:"_setRepeat"},scheduler:{lazyAdd:false,setter:"_setScheduler"},startDate:{setter:"_setDate",valueFn:function(){return new Date();}},visible:{value:true,validator:bd}},EXTENDS:aL.Base,PROPAGATE_ATTRS:[bn,aQ,aH,a4,aX,be,aJ,br,e,ap,w],prototype:{EVENT_NODE_TEMPLATE:'<div class="'+s+'">'+'<div class="'+D+'"></div>'+'<div class="'+aR+'"></div>'+'<div class="'+bp+'">'+'<span class="'+[k,b].join(q)+'"></span>'+'<span class="'+[k,bt].join(q)+'"></span>'+'<span class="'+[k,v].join(q)+'"></span>'+"</div>"+"</div>",eventStack:null,initializer:function(){var A=this;var L=A.get(n);A[ar]={};aL.Array.each(A.get(aT).PROPAGATE_ATTRS,function(X){A.after(X+I,A._propagateAttrChange);});A._bindUIAttrs();A.syncNodeUI(true);},destroy:function(){var A=this;A.eachRepeatedEvent(function(L,X){L.destroy();});A[ar]={};A.get(n).remove(true);},addPaddingNode:function(){var A=this;A.get(n).push(aL.Node.create(A.EVENT_NODE_TEMPLATE).setData(aw,A));A.syncNodeUI();},copyDates:function(L){var A=this;A.set(aQ,j.clone(L.get(aQ)));A.set(bn,j.clone(L.get(bn)));},copyPropagateAttrValues:function(L,X){var A=this;A.copyDates(L);aL.Array.each(A.get(aT).PROPAGATE_ATTRS,function(Y){if(!((X||{}).hasOwnProperty(Y))){var bB=L.get(Y);if(!G(bB)){A.set(Y,bB);}}});},getBorderColor:function(){var A=this;return A[aP].hex;},getDaysDuration:function(){var A=this;return j.getDayOffset(A.get(aQ),A.get(bn));},getHoursDuration:function(){var A=this;return j.getHoursOffset(A.get(aQ),A.get(bn));},getMinutesDuration:function(){var A=this;return j.getMinutesOffset(A.get(aQ),A.get(bn));},getSecondsDuration:function(){var A=this;return j.getSecondsOffset(A.get(aQ),A.get(bn));},sameEndDate:function(L){var A=this;return j.compare(A.get(aQ),L.get(aQ));},sameStartDate:function(L){var A=this;return j.compare(A.get(bn),L.get(bn));},isAfter:function(Y){var X=this;var L=X.get(bn);var A=Y.get(bn);return j.after(L,A);},isBefore:function(Y){var X=this;var L=X.get(bn);var A=Y.get(bn);return j.before(L,A);},repeatByDate:function(X){var L=this;var Y=L.uidByDate(X);if(!L[ar][Y]){var A=j.clone(X);var bC=j.clone(X);j.copyHours(A,L.get(bn));j.copyHours(bC,L.get(aQ));var bB=new L.get(aT)({endDate:bC,parentEvent:L,scheduler:L.get(ah),startDate:A});bB.copyPropagateAttrValues(L);L[ar][Y]=bB;}return L[ar][Y];},intersects:function(Y){var X=this;var bB=X.get(aQ);var L=X.get(bn);var A=Y.get(bn);return(X.sameStartDate(Y)||j.between(A,L,bB));},intersectHours:function(X){var L=this;var bB=L.get(aQ);var A=L.get(bn);var Y=j.clone(A);j.copyHours(Y,X.get(bn));return(j.compare(A,Y)||j.between(Y,A,bB));},isDayBoundaryEvent:function(){var A=this;return j.isDayBoundary(A.get(bn),A.get(aQ));},isDayOverlapEvent:function(){var A=this;return j.isDayOverlap(A.get(bn),A.get(aQ));},isRepeatableDate:function(L){var A=this;var X=A.get(aO);return(X&&X.validate(A,L));},getClearEndDate:function(){var A=this;return j.safeClearTime(A.get(aQ));},getClearStartDate:function(){var A=this;return j.safeClearTime(A.get(bn));},move:function(L){var A=this;var X=A.getMinutesDuration();A.set(bn,L);A.set(aQ,j.add(j.clone(L),j.MINUTES,X));},uidByDate:function(L){var A=this;L=f(L)?j.safeClearTime(L):A.getClearStartDate();return[aw,L.getTime()].join(l);},setContent:function(X,L){var A=this;A.get(n).each(function(bB){var Y=bB.one(g+aR);Y.setContent(X);});if(L){A.eachRepeatedEvent(function(Y,bB){Y.setContent(X);});}},setTitle:function(X,L){var A=this;A.get(n).each(function(Y){var bB=Y.one(g+D);bB.setContent(X);});if(L){A.eachRepeatedEvent(function(Y,bB){Y.setTitle(X);});}},syncNodeUI:function(L){var A=this;A._syncUIAttrs();A.syncNodeColorUI(L);A.syncNodeTitleUI(L);A.syncNodeContentUI(L);},syncNodeColorUI:function(L){var A=this;var Y=A.get(n);var bB=A.getBorderColor();if(Y){var X={borderWidth:A.get(br),borderColor:bB,backgroundColor:A.get(a4),borderStyle:A.get(aJ)};Y.setStyles(X);}if(L){A.eachRepeatedEvent(function(bC,bD){bC.syncNodeColorUI();
});}},syncNodeContentUI:function(L){var A=this;A.setContent(A.get(aH),L);},syncNodeTitleUI:function(L){var A=this;var Y=A._formatDate(A.get(bn));var X=A._formatDate(A.get(aQ));A.setTitle([Y,X].join(q+t+q),L);},split:function(){var A=this,X=j.clone(A.get(bn)),Y=j.clone(A.get(aQ));if(A.isDayOverlapEvent()&&!A.isDayBoundaryEvent()){var L=j.clone(X);L.setHours(24,0,0,0);return[[X,j.toMidnight(j.clone(X))],[L,j.clone(Y)]];}return[[X,Y]];},eachRepeatedEvent:function(L){var A=this;aL.each(A[ar],L,A);},unlink:function(){var A=this;if(A.get(aM)){A.set(aM,null);}else{A.eachRepeatedEvent(function(L,X){L.unlink();});}A[ar]={};A.syncNodeUI();},_afterDisabledChange:function(L){var A=this;A._uiSetDisabled(L.newVal);},_afterVisibleChange:function(L){var A=this;A._uiSetVisible(L.newVal);},_afterRepeatChange:function(L){var A=this;A._uiSetRepeat(L.newVal);},_afterParentEventChange:function(L){var A=this;A._uiSetParentEvent(L.newVal);},_bindUIAttrs:function(){var A=this;A.after({disabledChange:A._afterDisabledChange,visibleChange:A._afterVisibleChange,parentEventChange:A._afterParentEventChange,repeatChange:A._afterRepeatChange});A._syncUIAttrs();},_propagateAttrChange:function(Y){var A=this;var X=Y.attrName;var L=Y.newVal;A.eachRepeatedEvent(function(bB,bC){var bD=bB[aN+a6(X)];if(bD){bD.apply(A,[bB,X,L]);}else{bB.set(X,Y.newVal);}bB.syncNodeUI();});A.syncNodeUI();},_propagateSetEndDate:function(A,L,Y){var X=j.clone(A.get(aQ));j.copyHours(X,Y);A.set(aQ,X);},_propagateSetStartDate:function(L,X,Y){var A=j.clone(L.get(bn));j.copyHours(A,Y);L.set(bn,A);},_setColor:function(L){var A=this;A[H]=aZ.rgb2hsb(aZ.getRGB(L));A[T]=aL.clone(A[H]);A[T].b*=A.get(aX);A[T].s*=A.get(be);A[aP]=aZ.hsb2rgb(A[T]);return L;},_setDate:function(L){var A=this;if(ae(L)){L=new Date(L);}return L;},_setRepeat:function(L){var A=this;if(bk(L)){L=aL.SchedulerEventRepeat[L];}return G(L)?L:null;},_setScheduler:function(X){var A=this;var L=A.get(ah);if(L){A.removeTarget(L);}A.addTarget(X);return X;},_syncUIAttrs:function(){var A=this;A._uiSetDisabled(A.get(w));A._uiSetVisible(A.get(ap));A._uiSetParentEvent(A.get(aM));A._uiSetRepeat(A.get(aO));},_formatDate:function(X,Y){var L=this;var A=L.get(bq);Y=Y||L.get(e);return aL.DataType.Date.format(X,{format:Y,locale:A});},_getTitleDateFormat:function(X){var A=this;if(!bk(X)){var L=A.get(ah);X=(L&&L.get(Q).get(aY))?d:a7;}return X;},_uiSetDisabled:function(L){var A=this;A.get(n).toggleClass(bh,!!L);},_uiSetParentEvent:function(L){var A=this;A.get(n).toggleClass(aC,!!L);},_uiSetRepeat:function(X){var A=this;var L=!!X&&X!==aL.SchedulerEventRepeat[a0];A.get(n).toggleClass(an,L);},_uiSetVisible:function(L){var A=this;A.get(n).toggleClass(C,!L);}}});aL.SchedulerEvent=V;aL.SchedulerEventRepeat={never:{description:"Never repeat",validate:function(A,L){return false;},value:"never"},daily:{description:"Every day",validate:function(A,L){return true;},value:"daily"},monthly:{description:"Every month",validate:function(L,X){var Y=L.get(aQ);var A=L.get(bn);return(A.getDate()===X.getDate());},value:"monthly"},monWedFri:{description:"Every Monday, Wednesday and Friday",validate:function(A,L){return j.isMonWedOrFri(L);},value:"monWedFri"},tuesThurs:{description:"Every Tuesday and Thursday",validate:function(A,L){return j.isTueOrThu(L);},value:"tuesThurs"},weekDays:{description:"Every week days",validate:function(A,L){return j.isWeekDay(L);},value:"weekDays"},weekly:{description:"Every week",validate:function(L,X){var Y=L.get(aQ);var A=L.get(bn);return(A.getDay()===X.getDay());},value:"weekly"},yearly:{description:"Every year",validate:function(L,X){var Y=L.get(aQ);var A=L.get(bn);return((A.getMonth()===X.getMonth())&&(A.getDay()===X.getDay()));},value:"yearly"}};var ax=aL.Lang,a=ax.isArray,G=ax.isObject,Q="activeView",J="allDay",c="arrow",aV="body",aB="bodyContent",o="boundingBox",aA="cancel",a3="click",aH="content",aU="date",aI="dateFormat",ak="delete",bb="description",R="edit",bv="event",aT="eventClass",B="footerContent",aF="form",z="header",u="hide",aY="isoTime",aG="link",n="node",O="offsetHeight",bi="offsetWidth",h="overlay",S="overlayOffset",bw="recorder",bs="rendered",aO="repeat",a5="save",ah="scheduler",m="schedulerChange",aw="scheduler-event",ay="scheduler-event-recorder",aE="shadow",aD="show",F="startDateChange",N="strings",a8="template",aW="title",bu="tl",ad="toolbar",bm="submit",bo="value",aS="visibleChange",aa="when",am="x",al="y",ag="cancel",M="delete",y="edit",aK="save",bx="-",g=".",af="",i="#",r=aL.IO.prototype._serialize,E=aL.getClassName,s=E(ah,bv),aq=E(ah,bv,bw),by=E(ah,bv,bw,h),x=E(ah,bv,bw,h,c),bg=E(ah,bv,bw,h,c,aE),aj=E(ah,bv,bw,h,aV),a9=E(ah,bv,bw,h,aH),ai=E(ah,bv,bw,h,aU),U=E(ah,bv,bw,h,aF),bA=E(ah,bv,bw,h,z),W=E(ah,bv,bw,h,aG),at=E(ah,bv,bw,h,aO),D=E(ah,bv,aW),K=new aL.Template('<div class="',bg," ",x,'"></div>','<div class="',x,'"></div>','<input type="hidden" name="startDate" value="{startDate}" />','<input type="hidden" name="endDate" value="{endDate}" />','<div class="',bA,'">','<input class="',a9,'" name="content" value="{content}" />',"</div>",'<div class="',aj,'">','<label class="',ai,'">{date}</label>','<select class="',at,'" name="repeat">','<tpl for="eventRepeat">','<option {[ (parent.repeat && parent.repeat.value) == parent.eventRepeat[$i].value ? \'selected="selected"\' : "" ]} value="{value}">{description}</option>',"</tpl>","</select>","</div>"),ac='<a class="'+W+'" href="javascript:;">{delete}</a>',bz='<form class="'+U+'" id="schedulerEventRecorderForm"></form>';var Z=aL.Component.create({NAME:ay,ATTRS:{allDay:{value:false},content:{value:af},duration:{value:60},dateFormat:{validator:bk,value:"%a, %B %d,"},event:{},eventClass:{valueFn:function(){return aL.SchedulerEvent;}},strings:{value:{},setter:function(A){return aL.merge({"delete":"Delete","description-hint":"e.g., Dinner at Brian's","no-repeat":"No repeat",cancel:"Cancel",description:"Description",edit:"Edit",repeat:"Repeat",save:"Save",when:"When"},A||{});},validator:G},overlay:{validator:G,value:{align:{points:[bu,bu]},visible:false,width:300,zIndex:500}},overlayOffset:{value:[15,-38],validator:a},template:{value:K},toolbar:{setter:function(X){var L=this;
var A=L.get(N);return aL.merge({children:[{handler:aL.bind(L._handleSaveEvent,L),label:A[a5]},{handler:aL.bind(L._handleCancelEvent,L),label:A[aA]}]},X||{});},validator:G,value:{}}},EXTENDS:aL.SchedulerEvent,prototype:{initializer:function(){var A=this;A.get(n).addClass(aq);A.publish(ag,{defaultFn:A._defCancelEventFn});A.publish(M,{defaultFn:A._defDeleteEventFn});A.publish(y,{defaultFn:A._defEditEventFn});A.publish(aK,{defaultFn:A._defSaveEventFn});A.after(m,A._afterSchedulerChange);A[h]=new aL.Overlay(A.get(h));A[ad]=new aL.Toolbar(A.get(ad));},_afterSchedulerChange:function(Y){var A=this;var X=Y.newVal;var L=X.get(o);L.delegate(a3,aL.bind(A._onClickSchedulerEvent,A),g+s);},_defCancelEventFn:function(L){var A=this;A.get(n).remove();A.hideOverlay();},_defDeleteEventFn:function(X){var A=this;var L=A.get(ah);L.removeEvent(A.get(bv));A.hideOverlay();L.syncEventsUI();},_defEditEventFn:function(X){var A=this;var L=A.get(ah);A.hideOverlay();L.syncEventsUI();},_defSaveEventFn:function(X){var A=this;var L=A.get(ah);L.addEvent(X.newSchedulerEvent);A.hideOverlay();L.syncEventsUI();},_handleCancelEvent:function(L){var A=this;A.fire(ag);L.preventDefault();},_handleSaveEvent:function(L){var A=this;A.fire(A.get(bv)?y:aK,{newSchedulerEvent:A.getEventCopy()});L.preventDefault();},_onClickDelete:function(){var A=this;A.fire(M,{schedulerEvent:A.get(bv)});},_onClickSchedulerEvent:function(X){var A=this;var L=X.currentTarget.getData(aw);if(L){A.set(bv,L);A.showOverlay([X.pageX,X.pageY]);A.get(n).remove();}},_onOverlayVisibleChange:function(Y){var L=this;if(Y.newVal){L.populateForm();if(!L.get(bv)){var X=L[h].get(o);var A=X.one(g+a9);setTimeout(function(){A.selectText();},0);L.deleteNode.hide();}else{L.deleteNode.show();}}else{L.set(bv,null);L.get(n).remove();}},_onSubmitForm:function(L){var A=this;A._handleSaveEvent(L);},_renderOverlay:function(){var L=this;var A=L.get(N);L[h].render();L[ad].render();var X=L[h].get(o);X.addClass(by);L[h].set(B,L[ad].get(o));L[h].on(aS,aL.bind(L._onOverlayVisibleChange,L));L.deleteNode=aL.Node.create(ax.sub(ac,{"delete":A[ak]}));L[h].footerNode.append(L.deleteNode);L.formNode=aL.Node.create(bz);L[h].set(aB,L.formNode);L.deleteNode.on(a3,aL.bind(L._onClickDelete,L));L.formNode.on(bm,aL.bind(L._onSubmitForm,L));},getEventCopy:function(){var A=this;var X=A.get(bv);if(!X){X=new (A.get(aT))({allDay:A.get(J),endDate:A.get(aQ),scheduler:A.get(ah),startDate:A.get(bn)});X.copyPropagateAttrValues(A,{content:true});}var L=A.serializeForm();X.set(aH,L[aH]);X.set(aO,L[aO]);return X;},getFormattedDate:function(){var X=this;var L=X.get(aI);var bB=(X.get(bv)||X);var bD=bB.get(aQ);var bC=bB.get(ah);var A=bB.get(bn);var Y=(bC.get(Q).get(aY)?j.toIsoTimeString:j.toUsTimeString);return[bB._formatDate(A,L),Y(A),bf,Y(bD)].join(q);},getTemplateData:function(){var L=this;var A=L.get(N);var X=(L.get(bv)||L);return{content:X.get(aH)||A["description-hint"],date:L.getFormattedDate(),endDate:X.get(aQ).getTime(),eventRepeat:L.eventRepeatArray,repeat:X.get(aO),startDate:X.get(bn).getTime()};},hideOverlay:function(){var A=this;A[h].hide();},populateForm:function(){var A=this;if(!A.eventRepeatArray){A.eventRepeatArray=[];aL.each(aL.SchedulerEventRepeat,function(L){A.eventRepeatArray.push({description:L[bb],value:L[bo]});});}A.formNode.setContent(A.get(a8).parse(A.getTemplateData()));},serializeForm:function(){var A=this;return aL.QueryString.parse(r(A.formNode.getDOM()));},showOverlay:function(Y,bC){var A=this;var X=A.get(S);if(!A[h].get(bs)){A._renderOverlay();}A[h].show();if(!Y){var L=(A.get(bv)||A).get(n);var bB=L.one(g+D);bC=[X[0]+bB.get(bi),X[1]+bB.get(O)/2];Y=bB.getXY();}bC=bC||X;Y[0]+=bC[0];Y[1]+=bC[1];A[h].set("xy",Y);}}});aL.SchedulerEventRecorder=Z;},"@VERSION@",{skinnable:true,requires:["aui-base","aui-color-util","aui-datatype","aui-template","aui-toolbar","io-form","querystring","overlay"]});AUI.add("aui-scheduler-calendar",function(d){var i=d.Lang,j=i.isArray,c=i.isBoolean,b=i.isString,g=function(n){return(n instanceof d.SchedulerEvent);},a="color",l="events",h="pallete",m="scheduler",e="scheduler-calendar",k="visible";var f=d.Component.create({NAME:e,ATTRS:{color:{valueFn:function(){var o=this;var p=o.get(h);var n=Math.ceil(Math.random()*p.length)-1;return p[n];},validator:b},name:{value:"(no name)",validator:b},pallete:{value:["#d96666","#e67399","#b373b3","#8c66d9","#668cb3","#668cd9","#59bfb3","#65ad89","#4cb052","#8cbf40","#bfbf4d","#e0c240","#f2a640","#e6804d","#be9494","#a992a9","#8997a5","#94a2be","#85aaa5","#a7a77d","#c4a883","#c7561e","#b5515d","#c244ab","#603f99","#536ca6","#3640ad","#3c995b","#5ca632","#7ec225","#a7b828","#cf9911","#d47f1e","#b56414","#914d14","#ab2671","#9643a5","#4585a3","#737373","#41a587","#d1bc36","#ad2d2d"],validator:j},scheduler:{lazyAdd:false,setter:"_setScheduler"},visible:{value:true,validator:c}},EXTENDS:d.Base,AUGMENTS:d.SchedulerEventSupport,prototype:{initializer:function(){var n=this;n.after("colorChange",n._afterColorChange);n.on("eventsChange",n._onEventsChange);n.on("visibleChange",n._onVisibleChange);n._uiSetVisible(n.get(k));n._uiSetEvents(n.get(l));},syncEventsColor:function(o){var n=this;d.Array.each(o||n.get(l),function(p){p.set(a,n.get(a));});},_afterColorChange:function(o){var n=this;n.syncEventsColor(n.get(l));},_onEventsChange:function(o){var n=this;var p=o.newVal;var q=n.get(k);d.Array.each(p,function(r){r.set(k,q);});n._uiSetEvents(p);},_onVisibleChange:function(o){var n=this;n._uiSetVisible(o.newVal);},_setScheduler:function(p){var n=this;var o=n.get(m);if(o){n.removeTarget(o);}n.addTarget(p);return p;},_uiSetEvents:function(p){var n=this;var o=n.get(m);n.syncEventsColor(p);if(o){o.removeEvents(n);o.addEvents(p);o.syncEventsUI();}},_uiSetVisible:function(o){var n=this;n.eachEvent(function(p){p.set(k,o);});}}});d.SchedulerCalendar=f;},"@VERSION@",{requires:["aui-scheduler-event"],skinnable:false});AUI.add("aui-scheduler",function(a){},"@VERSION@",{skinnable:true,use:["aui-scheduler-base","aui-scheduler-view","aui-scheduler-event","aui-scheduler-calendar"]});
