AUI.add("aui-scheduler-base",function(ak){var W=ak.Lang,aI=W.isString,G=W.isObject,b=W.isArray,f=W.isDate,P=W.isNumber,O=function(A){return(A instanceof ak.Scheduler);},x=function(A){return(A instanceof ak.SchedulerView);},ah=function(A){return(A instanceof ak.SchedulerEvent);},z=function(A){return(ak.SchedulerCalendar&&(A instanceof ak.SchedulerCalendar));},k=ak.DataType.DateMath,ad=ak.WidgetStdMod,aG="-",ab=".",s="",t=" ",v="scheduler-base",aq="data-view-name",M="activeView",r="boundingBox",aH="clearfix",L="controls",at="controlsNode",aw="current",aj="currentDate",af="currentDateNode",ar="date",ai="dateFormat",aC="day",ap="endDate",aJ="events",I="firstDayOfWeek",aO="hd",aF="headerNode",p="helper",Z="icon",m="iconNextNode",aB="iconPrevNode",aM="locale",h="month",o="name",X="nav",T="navNode",q="next",e="nextDate",aE="prev",au="prevDate",aN="rendered",S="scheduler",ax="srcNode",aL="startDate",J="strings",az="template",g="today",al="todayNode",B="triggerNode",E="view",aP="views",ae="viewsNode",V="week",w="year",aA="navigationDateFormat",U="eventRecorder",F=ak.getClassName,am=F(p,aH),l=F(Z),ay=F(v,L),aa=F(v,aw,ar),j=F(v,aO),ac=F(v,Z,q),H=F(v,Z,aE),aK=F(v,X),D=F(v,g),ag=F(v,E),u=F(v,aP),i=F(v,E,s),y=F(v,E,aC),a=F(v,E,h),c=F(v,E,V),ao=F(v,E,w),K=F(S,E,s),av='<div class="'+ay+'"></div>',C='<div class="'+aa+'"></div>',d='<div class="'+j+'"></div>',aQ='<a href="#" class="'+[l,ac].join(t)+'">Next</a>',an='<a href="#" class="'+[l,H].join(t)+'">Prev</a>',n='<div class="'+aK+'"></div>',Y='<a href="#" class="'+D+'">{today}</a>',aD='<a href="#" class="'+[ag,i].join(t)+'{name}" data-view-name="{name}">{label}</a>',Q='<div class="'+u+'"></div>';var R=function(){};R.ATTRS={events:{value:[],setter:"_setEvents",validator:b}};ak.mix(R.prototype,{addEvent:function(aR){var A=this;var aS=A.get(aJ);if(ak.Array.indexOf(aS,aR)>-1){ak.Array.removeItem(aS,aR);}aS.push(aR);A.set(aJ,aS);},addEvents:function(aR){var A=this;ak.Array.each(A._normalizeEvents(aR),ak.bind(A.addEvent,A));},eachEvent:function(aS){var A=this;var aR=A.get(aJ);ak.Array.each(aR,aS,A);},removeEvent:function(aR){var A=this;var aS=A.get(aJ);ak.Array.removeItem(aS,aR);A.set(aJ,aS);},removeEvents:function(aR){var A=this;ak.Array.each(A._normalizeEvents(aR),ak.bind(A.removeEvent,A));},_normalizeEvents:function(aS){var A=this;var aR=[];aS=ak.Array(aS);ak.Array.each(aS,function(aT,aU){if(ah(aT)){aR.push(aT);}else{if(z(aT)){aR=aR.concat(A._normalizeEvents(aT.get(aJ)));}else{aT=new ak.SchedulerEvent(aT);aR.push(aT);}}if(O(A)){aT.set(S,A);}});return aR;},_setEvents:function(aR){var A=this;return A._normalizeEvents(aR);}});ak.SchedulerEventSupport=R;var N=ak.Component.create({NAME:v,ATTRS:{activeView:{validator:x},eventRecorder:{setter:"_setEventRecorder"},strings:{value:{day:"Day",month:"Month",today:"Today",week:"Week",year:"Year"}},navigationDateFormat:{getter:function(aS){var A=this;var aR=A.get(M);if(aR){return aR.get(aA);}return aS;},value:"%A - %d %b %Y",validator:aI},views:{setter:"_setViews",value:[]},currentDate:{valueFn:function(){return new Date();},validator:f},firstDayOfWeek:{value:0,validator:P},controlsNode:{valueFn:function(){return ak.Node.create(av);}},currentDateNode:{valueFn:function(){return ak.Node.create(C);}},headerNode:{valueFn:function(){return ak.Node.create(d);}},iconNextNode:{valueFn:function(){return ak.Node.create(aQ);}},iconPrevNode:{valueFn:function(){return ak.Node.create(an);}},navNode:{valueFn:function(){return ak.Node.create(n);}},todayNode:{valueFn:function(){return ak.Node.create(this._processTemplate(Y));}},viewsNode:{valueFn:function(){return ak.Node.create(Q);}}},HTML_PARSER:{controlsNode:ab+ay,currentDateNode:ab+aa,headerNode:ab+j,iconNextNode:ab+ac,iconPrevNode:ab+H,navNode:ab+aK,todayNode:ab+D,viewsNode:ab+u},UI_ATTRS:[aj],AUGMENTS:[ak.SchedulerEventSupport,ak.WidgetStdMod],prototype:{viewStack:null,initializer:function(){var A=this;A.viewStack={};A.controlsNode=A.get(at);A.currentDateNode=A.get(af);A.iconNextNode=A.get(m);A.iconPrevNode=A.get(aB);A.navNode=A.get(T);A.schedulerHeaderNode=A.get(aF);A.todayNode=A.get(al);A.viewsNode=A.get(ae);A.after({render:A._afterRender,activeViewChange:A._afterActiveViewChange});},bindUI:function(){var A=this;A._bindDelegate();},syncUI:function(){var A=this;A.syncStdContent();},flushEvents:function(){var A=this;ak.Array.each(A.get(aJ),function(aR,aS){aR.eachRepeatedEvent(function(aU,aT){delete aU._filtered;});delete aR._filtered;});},getEventsByDay:function(aR){var A=this;aR=k.safeClearTime(aR);return A._getEvents(aR,function(aS){return k.compare(aS.getClearStartDate(),aR);});},getIntersectEvents:function(aR){var A=this;aR=k.safeClearTime(aR);return A._getEvents(aR,function(aT){var aS=aT.getClearStartDate();var aU=aT.getClearEndDate();return(k.compare(aR,aS)||k.compare(aR,aU)||k.between(aR,aS,aU));});},sortEventsByDateAsc:function(aR){var A=this;aR.sort(function(aV,aT){var aU=aV.get(ap);var aS=aT.get(ap);var aX=aV.get(aL);var aW=aT.get(aL);if(k.after(aX,aW)||k.compare(aX,aW)&&k.before(aU,aS)){return 1;}else{return -1;}});},getViewByName:function(aR){var A=this;return A.viewStack[aR];},getStrings:function(){var A=this;return A.get(J);},getString:function(aR){var A=this;return A.getStrings()[aR];},renderView:function(aR){var A=this;if(aR){aR.show();if(!aR.get(aN)){var aS=aR.get(o);if(!A.bodyNode){A.setStdModContent(ad.BODY,s);}aR.render(A.bodyNode);}}},plotViewEvents:function(aR){var A=this;aR.plotEvents(A.get(aJ));},syncEventsUI:function(){var A=this;A.plotViewEvents(A.get(M));},_afterActiveViewChange:function(aT){var aR=this;if(aR.get(aN)){var aS=aT.newVal;var A=aT.prevVal;if(A){A.hide();}aR.renderView(aS);}},_afterRender:function(aR){var A=this;A.renderView(A.get(M));},_bindDelegate:function(){var A=this;A.viewsNode.delegate("click",A._onClickViewTrigger,ab+ag,A);A.controlsNode.delegate("click",A._onClickPrevIcon,ab+H,A);A.controlsNode.delegate("click",A._onClickNextIcon,ab+ac,A);A.controlsNode.delegate("click",A._onClickToday,ab+D,A);},_createViewTriggerNode:function(aR){var A=this;
if(!aR.get(B)){var aS=aR.get(o);aR.set(B,ak.Node.create(W.sub(aD,{name:aS,label:(A.getString(aS)||aS)})));}return aR.get(B);},_getEvents:function(aR,aT){var A=this;var aS=A.get(aJ);var aU=[];ak.Array.each(aS,function(aV,aW){if(aT.apply(A,[aV])){aU.push(aV);}else{if(aV.isRepeatableDate(aR)){var aX=aV.repeatByDate(aR);aU.push(aX);}}});A.sortEventsByDateAsc(aU);return aU;},_onClickToday:function(aR){var A=this;A.set(aj,A.get(M).getToday());aR.preventDefault();},_onClickNextIcon:function(aR){var A=this;A.set(aj,A.get(M).get(e));aR.preventDefault();},_onClickPrevIcon:function(aR){var A=this;A.set(aj,A.get(M).get(au));aR.preventDefault();},_onClickViewTrigger:function(aS){var A=this;var aT=aS.currentTarget;var aU=aT.attr(aq);var aR=A.getViewByName(aU);A.set(M,aR);aS.preventDefault();},_processTemplate:function(aR){var A=this;return W.sub(aR,A.getStrings());},_setEventRecorder:function(aR){var A=this;if(aR){aR.set(S,A);}},_setViews:function(aS){var A=this;var aR=[];ak.Array.each(aS,function(aT){if(x(aT)&&!aT.get(aN)){aT.set(S,A);aR.push(aT);A.viewStack[aT.get(o)]=aT;}});if(!A.get(M)){A.set(M,aS[0]);}return aR;},syncStdContent:function(){var A=this;var aR=A.get(aP);A.navNode.append(A.iconPrevNode);A.navNode.append(A.iconNextNode);A.controlsNode.append(A.todayNode);A.controlsNode.append(A.navNode);A.controlsNode.append(A.currentDateNode);ak.Array.each(aR,function(aS){A.viewsNode.append(A._createViewTriggerNode(aS));});A.schedulerHeaderNode.append(A.controlsNode);A.schedulerHeaderNode.append(A.viewsNode);A.schedulerHeaderNode.addClass(am);A.setStdModContent(ad.HEADER,A.schedulerHeaderNode.getDOM());},_uiSetCurrentDate:function(aV){var aS=this;var aR=aS.get(aA);var A=aS.get(aM);var aU=ak.DataType.Date.format(aV,{format:aR,locale:A});aS.currentDateNode.html(aU);if(aS.get(aN)){var aT=aS.get(M);if(aT){aT._uiSetCurrentDate(aV);}aS.syncEventsUI();}}}});ak.Scheduler=N;},"@VERSION@",{skinnable:true,requires:["aui-scheduler-view","datasource"]});AUI.add("aui-scheduler-view",function(b6){var cn=b6.Lang,cE=cn.isObject,bV=cn.isString,aU=cn.isBoolean,aG=cn.isNumber,be=function(A){return A==0?0:(A<0?-1:1);},aK=function(A,cI){return Math.max(Math.abs(A),cI)*be(A);},bI=function(A){return parseFloat(A)||0;},bK=function(cI,A){return Math.round(cI/A)*A;},aq=b6.DataType.DateMath,b2=b6.WidgetStdMod,aL=aq.WEEK_LENGTH,bM="scheduler-view",aF="scheduler-view-day",ca="scheduler-view-week",cx="scheduler-view-month",bH="activeView",a6="am",u="borderLeftWidth",ce="borderRightWidth",aQ="boundingBox",q="children",bx="childNodes",ag="col",I="colblank",y="coldata",aI="colday",a="colgrid",bs="colmonth",W="colspan",m="coltime",cs="columnNode",ax="colDaysNode",b8="colHeaderDaysNode",aO="container",aM="content",cu="contentBox",av="createDocumentFragment",bb="currentDate",by="data",ba="dateFormat",ck="day",U="days",E="delegateConfig",bF="disabled",X="div",bk="division",ab="down",cc="dragNode",bU="duration",aA="endDate",a2="event",b0="events",cG="eventRecorder",s="eventWidth",aH="first",cb="firstDayOfWeek",a8="grid",cF="hd",b4="header",a9="headerDateFormat",cB="headerTableNode",bP="height",aP="host",aE="hourHeight",v="icon",ak="isoTime",bf="labelAM",aC="labelPM",aR="left",ay="locale",ac="marker",a4="markercell",aX="markercellsNode",bN="markercellNode",L="markers",bD="month",a7="monthContainerNode",bB="navigationDateFormat",aN="next",bL="nextDate",cH="node",aj="nomonth",ar="noscroll",b3="offsetHeight",K="offsetTop",b5="offsetWidth",cj="ownerDocument",b7="pad",cp="parentEvent",R="parentNode",an="pm",aa="prevDate",br="proxy",ah="px",aS="rendered",b1="repeated",aY="right",bp="row",r="scheduler",aD="scheduler-event",Y="scrollable",T="shim",b9="startDate",aT="table",cv="tableColNode",j="tableDataNode",D="tableGridNode",bv="tableNode",bW="tableTimeNode",bt="tbody",e="td",bm="time",ai="timesNode",g="title",al="today",bq="top",cC="tr",z="trigger",cq="week",bz="width",bJ="-",k="a",bO=".",bG="",bA="%",V=" ",F=b6.getClassName,bl=F(bM,ar),ad=F(bM,Y);var aW=b6.Component.create({NAME:bM,AUGMENTS:[b6.WidgetStdMod],ATTRS:{bodyContent:{value:bG},height:{value:600},isoTime:{value:false,validator:aU},name:{value:bG,validator:bV},navigationDateFormat:{value:"%A - %d %b %Y",validator:bV},nextDate:{getter:"getNextDate",readOnly:true},prevDate:{getter:"getPrevDate",readOnly:true},scheduler:{lazyAdd:false,setter:"_setScheduler"},scrollable:{value:true,validator:aU},triggerNode:{setter:b6.one},visible:{value:false}},BIND_UI_ATTRS:[Y],prototype:{initializer:function(){var A=this;A.after("render",A._afterRender);},syncUI:function(){var A=this;A.syncStdContent();},adjustCurrentDate:function(){var A=this;var cJ=A.get(r);var cI=cJ.get(bb);cJ.set(bb,cI);},flushViewCache:function(){},getNextDate:function(){},getPrevDate:function(){},getToday:function(){return aq.clearTime(new Date());},limitDate:function(cI,cJ){var A=this;if(aq.after(cI,cJ)){cI=aq.clone(cJ);}return cI;},plotEvents:function(A){},syncStdContent:function(){},syncEventUI:function(A){},_uiSetCurrentDate:function(A){},_afterRender:function(cJ){var A=this;var cI=A.get(r);A.adjustCurrentDate();A._uiSetScrollable(A.get(Y));},_setScheduler:function(cJ){var A=this;var cI=A.get(r);if(cI){A.removeTarget(cI);}if(cJ){A.addTarget(cJ);cJ.after("eventsChange",b6.bind(A.flushViewCache,A));}return cJ;},_uiSetScrollable:function(cJ){var A=this;var cI=A.bodyNode;if(cI){cI.toggleClass(ad,cJ);cI.toggleClass(bl,!cJ);}},_uiSetVisible:function(cI){var A=this;aW.superclass._uiSetVisible.apply(this,arguments);if(cI&&A.get(aS)){A.adjustCurrentDate();}}}});b6.SchedulerView=aW;var cn=b6.Lang,bE=cn.sub;var O=function(A,cI){return function(cK){var cJ=cK.all(A);return(cJ.size()>=cI)?cJ:null;};},aJ=F(aD),bh=F(aD,bF),bR=F(aD,br),B=F(bM,y),c=F(bM,a),Q=F(r,al),ap=F(r,al,cF),cf=F(bM,a8),cg=F(bM,a8,aO),ci=F(bM,a4),M=F(bM,L),bj=F(bM,ac,bk),bw=F(bM,aT),cm=F(bM,ck,b4,aT),t=F(bM,ck,b4,ck),bi=F(bM,ck,b4,ck,b7,aY),bT=F(bM,ck,b4,ck,aH),a1=F(bM,ck,b4,ag),cz=F(bM,aT,ag),aB=F(bM,aT,ag,T),P=F(bM,aT,I),H=F(bM,aT,aI),n=F(bM,aT,aI,b4),cr=F(bM,aT,m),bo=F(bM,aT,bm),ae='<div class="'+ci+'">'+'<div class="'+bj+'"></div>'+"</div>",au='<table class="'+bw+'">'+"<tbody>"+'<tr class="'+c+'" height="1">'+'<td height="0" class="'+[cz,P].join(V)+'"></td>'+'<td class="'+cg+'" colspan="1">'+'<div class="'+cf+'">'+'<div class="'+M+'"></div>'+"</div>"+"</td>"+"</tr>"+'<tr class="'+B+'">'+'<td class="'+[cz,cr].join(V)+'"></td>'+"</tr>"+"</tbody>"+"</table>",bd='<td class="'+[cz,H].join(V)+'">'+'<div class="'+aB+'"></div>'+"</td>",i='<div class="'+bo+'">{hour}</div>',aw='<table class="'+cm+'">'+"<tbody>"+'<tr class="'+a1+'"></tr>'+"</tbody>"+"</table>",bg='<th class="'+t+'"><a href="#">&nbsp;</a></th>',at='<td class="'+[t,bT].join(V)+'"></td>',w='<th class="'+[t,bi].join(V)+'">&nbsp;</th>';
var cA=b6.Component.create({NAME:aF,ATTRS:{bodyContent:{value:bG},days:{value:1,validator:aG},delegateConfig:{value:{},setter:function(cI){var A=this;return b6.merge({bubbleTargets:A,container:A.get(aQ),nodes:bO+aJ,invalid:"input, select, button, a, textarea, "+bO+bh},cI||{});},validator:cE},headerDateFormat:{value:"%a %d/%m",validator:bV},name:{value:ck},hourHeight:{value:52,validator:aG},eventWidth:{value:95,validator:aG},headerTableNode:{valueFn:function(){return b6.Node.create(aw);}},tableNode:{valueFn:function(){return b6.Node.create(au);}},colDaysNode:{valueFn:"_valueColDaysNode"},colHeaderDaysNode:{valueFn:"_valueColHeaderDaysNode"},markercellsNode:{valueFn:"_valueMarkercellsNode"},timesNode:{valueFn:"_valueTimesNode"}},HTML_PARSER:{colHeaderDaysNode:O(bO+t,2),colDaysNode:O(bO+H,1),markercellsNode:O(bO+ci,24),timesNode:O(bO+bo,24),headerTableNode:bO+cm,tableNode:bO+bw},EXTENDS:b6.SchedulerView,prototype:{initializer:function(){var A=this;A.colDaysNode=A.get(ax);A.colHeaderDaysNode=A.get(b8);A.headerTableNode=A.get(cB);A.markercellsNode=A.get(aX);A.tableNode=A.get(bv);A.timesNode=A.get(ai);A.colShimNodes=A.colDaysNode.all(bO+aB);A.colDataNode=A.tableNode.one(bO+B);A.colTimeNode=A.tableNode.one(bO+cr);A.dayHeaderColNode=A.headerTableNode.one(bO+a1);A.gridContainer=A.tableNode.one(bO+cg);A.markersNode=A.tableNode.one(bO+M);},renderUI:function(){var A=this;A.colTimeNode.setContent(A.timesNode);A.markersNode.setContent(A.markercellsNode);A.colDaysNode.appendTo(A.colDataNode);A.colHeaderDaysNode.appendTo(A.dayHeaderColNode);},bindUI:function(){var A=this;A.headerTableNode.delegate("click",b6.bind(A._onClickDaysHeader,A),bO+t);A.colDataNode.delegate("mousedown",b6.bind(A._onMouseDownTableCol,A),bO+cz);A.colDataNode.delegate("mouseup",b6.bind(A._onMouseUpTableCol,A),bO+cz);A.colDataNode.delegate("mousemove",b6.bind(A._onMouseMoveTableCol,A),bO+cz);A.on("drag:end",A._onEventDragEnd);A.on("drag:start",A._onEventDragStart);A.on("drag:align",A._dragAlign);A.on("drag:tickAlignX",A._dragTickAlignX);A.on("drag:tickAlignY",A._dragTickAlignY);},syncUI:function(){var A=this;cA.superclass.syncUI.apply(this,arguments);A.gridContainer.attr(W,A.get(U));A._setupDragDrop();},syncStdContent:function(){var A=this;A.setStdModContent(b2.BODY,A.tableNode.getDOM());A.setStdModContent(b2.HEADER,A.headerTableNode.getDOM());},calculateTopByDate:function(cK){var cI=this;var A=cI.get(aE);var cJ=cK.getHours();var cL=cK.getMinutes();var cM=cK.getSeconds();return((cJ*60)+cL+(cM/60))*(A/60);},calculateHoursByTop:function(cL){var cI=this;var A=cI.get(aE);var cN=bI((cL/A).toFixed(2));var cM=0;var cK=Math.floor((cN*100)%100*0.6);var cJ=Math.floor(cN);return[cJ,cK,cM];},getNextDate:function(){var A=this;var cJ=A.get(r);var cI=cJ.get(bb);return aq.add(cI,aq.DAY,1);},getPrevDate:function(){var A=this;var cJ=A.get(r);var cI=cJ.get(bb);return aq.subtract(cI,aq.DAY,1);},getColumnByDate:function(cJ){var A=this;var cK=A.get(r);var cI=aq.safeClearTime(cK.get(bb));var cL=aq.getDayOffset(aq.safeClearTime(cJ),cI);return A.colDaysNode.item(cL);},getDateByColumn:function(cJ){var A=this;var cK=A.get(r);var cI=aq.safeClearTime(cK.get(bb));return aq.add(cI,aq.DAY,cJ);},plotEvents:function(cJ){var A=this;var cI=A.get(r);A.colShimNodes.each(function(cN,cM){var cL=A.getDateByColumn(cM);var cK=cI.getEventsByDay(cL);cN.empty();b6.Array.each(cK,function(cO,cP){if(!cO.isDayOverlapEvent()){cN.append(cO.get(cH));cO.set(cs,cN.get(R));A.syncEventTopUI(cO);A.syncEventHeightUI(cO);}});A.syncEventsIntersectionUI(cK);});},syncColumnsUI:function(){var A=this;A.colDaysNode.each(function(cK,cJ){var cI=A.getDateByColumn(cJ);cK.toggleClass(Q,aq.isToday(cI));});},syncDaysHeaderUI:function(){var cJ=this;var cL=cJ.get(r);var cK=cL.get(bb);var cI=cJ.get(a9);var A=cJ.get(ay);cJ.colHeaderDaysNode.all(k).each(function(cO,cN){var cM=aq.add(cK,aq.DAY,cN);var cP=b6.DataType.Date.format(cM,{format:cI,locale:A});cO.toggleClass(ap,aq.isToday(cM));cO.html(cP);});},syncEventsIntersectionUI:function(cI){var A=this;var cJ=A.get(r);var cK=A.get(s);cJ.flushEvents();b6.Array.each(cI,function(cM,cN){var cP=A.findEventIntersections(cM,cI);var cO=cP.length;var cL=(cK/cO);b6.Array.each(cP,function(cR,cS){var cQ=cR.get(cH);var cU=cL*cS;var cT=cL*1.7;if(cS==(cO-1)){cT=cK-cU;}cQ.setStyle(bz,cT+bA);cQ.setStyle(aR,cU+bA);var cV=cQ.get(R);if(cV){cV.insert(cQ,cS);}cR._filtered=true;});});},syncEventHeightUI:function(cJ){var cI=this;var A=cI.get(aE);var cL=cI.calculateTopByDate(cJ.get(b9));var cK=cI.calculateTopByDate(cJ.get(aA));cJ.get(cH).set(b3,Math.max(cK-cL,A/2));},syncEventRecorderUI:function(cK){var A=this;var cJ=A.get(r);var cL=cJ.get(cG);var cI=cL.get(cH);if(cK&&!cI.inDoc()){cK.append(cI);}A.syncEventTopUI(cL);A.syncEventHeightUI(cL);},syncEventTopUI:function(cJ){var cI=this;var A=cJ.get(cH);var cK=cI.calculateTopByDate(cJ.get(b9));A.setStyle(bq,cK+ah);},findEventIntersections:function(cI,cJ){var A=this;var cK=[];b6.Array.each(cJ,function(cM,cL){if(!cI._filtered&&!cM.isDayOverlapEvent()&&cI.intersectHours(cM)){cK.push(cM);}});return cK;},_createEvents:function(){var A=this;var cI=function(cJ,cK){A.publish(cJ,{defaultFn:cK,queuable:false,emitFacade:true,bubbles:true});};},_dragTickAlignX:function(cI){var cR=this;var cS=cI.target.get(aP);var cT=cR._getColumnRefWidth();var cL=cS.get(cH);var cO=cR.proxyEvt;var cP=cL.getData(aD);var cQ=(cS.actXY[0]-cR.bodyNode.getX()-cR.colTimeNode.get(b5));var cJ=Math.floor(cQ/cT);var cN=cR.colDaysNode.item(cJ);var cM=cR.getDateByColumn(cJ);var A=aq.clone(cM);var cK=aq.clone(cM);aq.copyHours(cK,cO.get(aA));aq.copyHours(A,cO.get(b9));cO.set(aA,cK);cO.set(b9,A);},_dragTickAlignY:function(cJ){var cO=this;var cP=cJ.target.get(aP);var cL=cP.get(cH);var cM=cO.proxyEvt;var cN=cL.getData(aD);var cI=aq.clone(cM.get(b9));var A=cO.calculateHoursByTop(bI(cP.get(cc).getComputedStyle(bq)));cO._setTickedHours(cI,A);var cK=aq.clone(cI);cM.set(aA,aq.add(cK,aq.MINUTES,cO._currentEvtDuration));cM.set(b9,cI);cM.syncNodeTitleUI();},_getXYDelta:function(cI){var A=this;var cK=cI.currentTarget;
var cJ=cK.getXY(),cL=[cI.pageX,cI.pageY];return b6.Array.map(cJ,function(cN,cM){return(cL[cM]-cN);});},_getTickY:function(){var A=this;return bK(Math.ceil(A.get(aE)/2),10);},_getColumnRefWidth:function(){var A=this;var cI=A.colDaysNode.item(0);return bI(cI.getStyle(bz))-bI(cI.getStyle(ce))-bI(cI.getStyle(u));},_setupDragDrop:function(){var cJ=this;var cK=cJ.get(aQ);if(!cJ.proxyEvt){var cL=cJ.get(r);cJ.proxyEvt=new b6.SchedulerEvent({scheduler:cL});cJ.proxyEvt.removeTarget(cL);cJ.proxyEvt.get(cH).addClass(bR);}if(!cJ.delegate){cJ.delegate=new b6.DD.Delegate(cJ.get(E));}var cI=cJ.delegate.dd;var cM=cJ.proxyEvt;var cN=cJ.get(aE)/2;var A=cJ._getColumnRefWidth();cI.unplug(b6.Plugin.DDConstrained);cI.unplug(b6.Plugin.DDNodeScroll);cI.plug(b6.Plugin.DDConstrained,{bubbleTargets:cJ,constrain:cJ.bodyNode,tickX:A,tickY:cN});cI.plug(b6.Plugin.DDNodeScroll,{node:cJ.bodyNode,scrollDelay:150});},_uiSetCurrentDate:function(cI){var A=this;A.syncColumnsUI();A.syncDaysHeaderUI();},_onClickDaysHeader:function(cK){var A=this;var cJ=A.get(r);if(cK.target.test(k)){var cL=cJ.getViewByName(ck);var cI=A.colHeaderDaysNode.indexOf(cK.currentTarget)-1;if(cL){cJ.set(bb,A.getDateByColumn(cI));cJ.set(bH,cL);}}cK.preventDefault();},_onEventDragEnd:function(A){var cO=this;var cL=cO.get(r);var cK=cO.get(aQ);var cP=cO.delegate.dd;var cJ=cP.get(cH);var cM=cO.proxyEvt;var cI=cM.get(cH);var cN=cJ.getData(aD);cJ.show();cI.hide();cK.selectable();cN.copyDates(cM);cL.syncEventsUI();},_onEventDragStart:function(A){var cO=this;var cL=cO.get(aQ);var cP=cO.delegate.dd;var cK=cP.get(cH);var cM=cO.proxyEvt;var cN=cK.getData(aD);var cJ=bI(cK.getComputedStyle(aR));if(cJ){cP.deltaXY[0]=(cJ+bI(cP.deltaXY[0]));}if(cN){var cQ=cN.get(cs);var cI=cM.get(cH);cP.set(cc,cI);cQ.append(cI);cM.copyPropagateAttrValues(cN);cO.syncEventTopUI(cM);cO.syncEventHeightUI(cM);cI.show();cO._currentEvtDuration=cN.getMinutesDuration();}cK.hide();cL.unselectable();},_onMouseDownTableCol:function(cK){var A=this;var cJ=A.get(r);var cL=cJ.get(cG);if(cL&&!cJ.get(bF)){cL.hideOverlay();if(cK.target.test(bO+aB)){var cI=A.colDaysNode.indexOf(cK.currentTarget);A.dragXY=A.startXY=A._getXYDelta(cK);A.ddStartDate=A.getDateByColumn(cI);A.ddEndDate=aq.clone(A.ddStartDate);A._setTickedHours(A.ddStartDate,A.calculateHoursByTop(A.startXY[1]));A.ddMaxDate=aq.clone(A.ddStartDate);A.ddMaxDate.setHours(23,59,59);cL.set(b9,A.ddStartDate);cL.set(aA,A.limitDate(cL.get(aA),A.ddMaxDate));cK.halt();}}},_onMouseMoveTableCol:function(cL){var A=this;var cK=A.get(r);var cO=cK.get(cG);var cM=A.ddStartDate;if(cM){A.dragXY=A._getXYDelta(cL);A._setTickedHours(A.ddEndDate,A.calculateHoursByTop(A.dragXY[1]));var cN=aq.getMinutesOffset(A.ddEndDate,cM);if((A.dragXY[1]-A.startXY[1])>0){cN=aK(cN,cO.get(bU));}var cI=A.limitDate(aq.add(cM,aq.MINUTES,cN),A.ddMaxDate);if(cN>0){cO.set(aA,cI);}else{var cJ=cO.get(aA);cO.set(b9,cI);cO.set(aA,cJ);}A.syncEventRecorderUI(cL.currentTarget);}},_onMouseUpTableCol:function(cJ){var A=this;var cI=A.get(r);var cK=cI.get(cG);if(cK&&!cI.get(bF)){if(A.ddStartDate){A.syncEventRecorderUI(cJ.currentTarget);cK.showOverlay();}A.ddEndDate=null;A.ddStartDate=null;}},_setTickedHours:function(cI,cJ){var A=this;cI.setHours(cJ[0],bK(cJ[1],A._getTickY()),cJ[2]);},_valueColDaysNode:function(){var A=this;var cJ=A.get(U);var cI=[];while(cJ--){cI.push(bd);}return b6.NodeList.create(cI.join(bG));},_valueColHeaderDaysNode:function(){var A=this;var cJ=A.get(U);var cI=[];cI.push(at);while(cJ--){cI.push(bg);}cI.push(w);return b6.NodeList.create(cI.join(bG));},_valueMarkercellsNode:function(){var A=this;var cI=[];for(var cJ=0;cJ<=23;cJ++){cI.push(ae);}return b6.NodeList.create(cI.join(bG));},_valueTimesNode:function(){var A=this;var cK=A.get(ak);var cJ=[];for(var cI=0;cI<=23;cI++){cJ.push(bE(i,{hour:cK?aq.toIsoTimeString(cI):aq.toUsTimeString(cI,false,true)}));}return b6.NodeList.create(cJ.join(bG));}}});b6.SchedulerDayView=cA;var am=b6.Component.create({NAME:ca,ATTRS:{bodyContent:{value:bG},days:{value:7},name:{value:cq}},EXTENDS:b6.SchedulerDayView,prototype:{adjustCurrentDate:function(){var A=this;var cK=A.get(r);var cI=cK.get(bb);var cJ=cK.get(cb);cK.set(bb,aq.getFirstDayOfWeek(cI,cJ));},getNextDate:function(){var A=this;var cJ=A.get(r);var cI=cJ.get(bb);var cK=A._firstDayOfWeek(cI);return aq.add(cK,aq.WEEK,1);},getPrevDate:function(){var A=this;var cJ=A.get(r);var cI=cJ.get(bb);var cK=A._firstDayOfWeek(cI);return aq.subtract(cK,aq.WEEK,1);},getToday:function(){var A=this;var cI=am.superclass.getToday.apply(this,arguments);return A._firstDayOfWeek(cI);},_firstDayOfWeek:function(cJ){var A=this;var cK=A.get(r);var cI=cK.get(cb);return aq.getFirstDayOfWeek(cJ,cI);}}});b6.SchedulerWeekView=am;var h=F(bM,bD,aO),a3=F(bM,bD,b4,ag),x=F(bM,bD,b4,ck),cw=F(bM,bD,b4,aT),bY=F(bM,bD,bp),ao=F(bM,bD,bp,aO),f=F(v),l=F(v,"arrowstop-1-l"),ct=F(v,"arrowstop-1-r"),bZ=F(bM,bD,a),b=F(bM,bD,a,al),o=F(bM,bD,a,aH),bC=F(bM,bD,aT,by),aZ=F(bM,bD,aT,by,aH),bX=F(bM,bD,aT,by,ag),cd=F(bM,bD,aT,by,ag,aH),a0=F(bM,bD,aT,by,ag,aj),aV=F(bM,bD,aT,by,ag,g),S=F(bM,bD,aT,by,ag,g,al),af=F(bM,bD,aT,by,ag,g,aH),C=F(bM,bD,aT,by,ag,g,aN),cy=F(bM,bD,aT,by,ag,g,ab),bn=F(bM,bD,aT,by,a2),d=F(bM,bD,aT,by,a2,aR),bQ=F(bM,bD,aT,by,a2,aY),p=F(bM,bD,aT,by,a2,b1),bc=F(bM,bD,aT,a8),co=F(bM,bD,aT,a8,aH),cD=F(bM,aT,bs,b4),G='<table class="'+cw+'">'+"<tbody>"+'<tr class="'+a3+'"></tr>'+"</tbody>"+"</table>",N='<th class="'+x+'"><div>&nbsp;</div></th>',cl='<div class="'+h+'">'+'<div class="'+ao+'">'+'<div class="'+bY+'" style="top: 0; height: 16.6667%;"></div>'+'<div class="'+bY+'" style="top: 16.6667%; height: 16.6667%;"></div>'+'<div class="'+bY+'" style="top: 33.3333%; height: 16.6667%;"></div>'+'<div class="'+bY+'" style="top: 50%; height: 16.6667%;"></div>'+'<div class="'+bY+'" style="top: 66.6667%; height: 16.6667%;"></div>'+'<div class="'+bY+'" style="top: 83.3333%; height: 16.6667%;"></div>'+"</div>"+"</div>",bu='<table cellspacing="0" cellpadding="0" class="'+bc+'">'+"<tbody>"+"<tr>"+'<td class="'+[bZ,o].join(V)+'">&nbsp;</td>'+'<td class="'+bZ+'">&nbsp;</td>'+'<td class="'+bZ+'">&nbsp;</td>'+'<td class="'+bZ+'">&nbsp;</td>'+'<td class="'+bZ+'">&nbsp;</td>'+'<td class="'+bZ+'">&nbsp;</td>'+'<td class="'+bZ+'">&nbsp;</td>'+"</tr>"+"</tbody>"+"</table>",bS='<table cellspacing="0" cellpadding="0" class="'+bC+'">'+"<tbody></tbody>"+"</table>",ch="<tr></tr>",a5='<td class="'+bX+'"><div></div></td>',Z='<span class="'+[f,l].join(V)+'"></span>',J='<span class="'+[f,ct].join(V)+'"></span>';
var az=b6.Component.create({NAME:cx,ATTRS:{bodyContent:{value:bG},name:{value:bD},headerDateFormat:{value:"%a"},navigationDateFormat:{value:"%b %Y"},scrollable:{value:false},monthContainerNode:{valueFn:function(){return b6.Node.create(cl);}},headerTableNode:{valueFn:function(){return b6.Node.create(G);}},colHeaderDaysNode:{valueFn:"_valueColHeaderDaysNode"},tableGridNode:{valueFn:"_valueTableGridNode"}},HTML_PARSER:{tableGridNode:O(bO+bc,7),colHeaderDaysNode:O(bO+x,7),monthContainerNode:bO+h,headerTableNode:bO+cw},EXTENDS:b6.SchedulerView,prototype:{evtDateStack:null,evtDataTableStack:null,initializer:function(){var A=this;var cI=A.get(r);A.evtDateStack={};A.evtDataTableStack={};A.colHeaderDaysNode=A.get(b8);A.headerTableNode=A.get(cB);A.monthContainerNode=A.get(a7);A.tableGridNode=A.get(D);A.dayHeaderColNode=A.headerTableNode.one(bO+a3);A.monthRows=A.monthContainerNode.all(bO+bY);A.tableGridCols=A.tableGridNode.all(e);},renderUI:function(){var A=this;A.colHeaderDaysNode.appendTo(A.dayHeaderColNode);A.monthRows.each(function(cK,cJ){var cI=A.tableGridNode.item(cJ);cK.append(cI.toggleClass(co,(cJ==0)));});},buildEventsTable:function(cI,cN){var cT=this;var cQ=5;var cK=aq.clearTime(cT._findCurrentMonthEnd());var cS=aq.clearTime(cT._findCurrentMonthStart());var cP=String(cS.getTime()).concat(cI.getTime()).concat(cN.getTime());var cO=cT.evtDataTableStack[cP];if(!cO){cO=b6.Node.create(bS);var cR=cO.one(bt);var cL=b6.Node.create(ch);cT.loopDates(cI,cN,function(cV,cU){var cW=b6.Node.create(a5);cW.addClass(aV).toggleClass(af,(cU==0)).toggleClass(S,aq.isToday(cV)).toggleClass(C,aq.isToday(aq.subtract(cV,aq.DAY,1))).toggleClass(cy,aq.isToday(aq.subtract(cV,aq.WEEK,1)));if(aq.before(cV,cS)||aq.after(cV,cK)){cW.addClass(a0);}cL.append(cW.setContent(cV.getDate()));});cR.append(cL);for(var A=0;A<cQ;A++){var cM=0;var cJ=b6.Node.create(ch);cT.loopDates(cI,cN,function(cZ,cX){if(cM<=cX){var cY=cT.getIntersectEvents(cZ),cV=cY[A];var c0=b6.Node.create(a5);if(cV){var cU=c0.one(X);var cW=cT._getEvtSplitInfo(cV,cI,cN);c0.attr(W,cW.colspan);cU.addClass(bn).setContent(cT._getEvtLabel(cV));if(cW.left){cU.addClass(d).prepend(Z);}if(cW.right){cU.addClass(bQ).append(J);}if(cV.get(cp)){cU.addClass(p);}cM+=cW.colspan;}else{cM++;}cJ.append(c0);}});cR.append(cJ);}cT.evtDataTableStack[cP]=cO;}return cO;},flushViewCache:function(){var A=this;A.evtDateStack={};A.evtDataTableStack={};},getIntersectEvents:function(cI){var A=this;var cK=A.get(r);var cJ=String(cI.getTime());if(!A.evtDateStack[cJ]){A.evtDateStack[cJ]=cK.getIntersectEvents(cI);}return A.evtDateStack[cJ];},loopDates:function(A,cK,cN,cO,cM){var cP=this;var cI=aq.clone(A);var cJ=cK.getTime();for(var cL=0;cI.getTime()<=cJ;cL++){cN.apply(cP,[cI,cL]);cI=aq.add(cI,(cO||aq.DAY),(cM||1));}},plotEvents:function(){var cI=this;var cJ=cI._findCurrentMonthStart();var A=aq.safeClearTime(cI._findFirstDayOfWeek(cJ));cI.bodyNode.all(bO+bC).remove();cI.monthRows.each(function(cN,cL){var cK=aq.add(A,aq.WEEK,cL);var cO=aq.add(cK,aq.DAY,aL-1);var cM=cI.buildEventsTable(cK,cO);if(cL==0){cM.addClass(aZ);}cN.append(cM);});},syncStdContent:function(){var A=this;A.setStdModContent(b2.BODY,A.monthContainerNode.getDOM());A.setStdModContent(b2.HEADER,A.headerTableNode.getDOM());},syncGridUI:function(){var cP=this;var cJ=cP.getToday();var cI=cP.get(r);cP.tableGridCols.removeClass(b);if(aq.isSameMonth(cJ,cI.get(bb))){var A=cI.get(cb);var cJ=cP.getToday();var cL=cP._findCurrentMonthStart();var cN=cP._findFirstDayOfWeek(cJ);var cK=aq.getWeekNumber(cJ,A)-aq.getWeekNumber(cL,A);var cO=(cJ.getDate()-cN.getDate());var cM=cP.tableGridNode.item(cK).all(e).item(cO);if(cM){cM.addClass(b);}}},adjustCurrentDate:function(){var A=this;var cI=A.get(r);cI.set(bb,A._findCurrentMonthStart());},getNextDate:function(){var A=this;var cJ=A.get(r);var cI=cJ.get(bb);return aq.add(cI,aq.MONTH,1);},getPrevDate:function(){var A=this;var cJ=A.get(r);var cI=cJ.get(bb);return aq.subtract(cI,aq.MONTH,1);},syncDaysHeaderUI:function(){var cJ=this;var cM=cJ.get(r);var cK=cM.get(bb);var cI=cJ.get(a9);var A=cJ.get(ay);var cL=cJ._findFirstDayOfWeek(cK);cJ.colHeaderDaysNode.all(X).each(function(cP,cO){var cN=aq.add(cL,aq.DAY,cO);var cQ=b6.DataType.Date.format(cN,{format:cI,locale:A});cP.html(cQ);});},_findCurrentMonthEnd:function(){var A=this;var cJ=A.get(r);var cI=cJ.get(bb);return aq.findMonthEnd(cI);},_findCurrentMonthStart:function(){var A=this;var cJ=A.get(r);var cI=cJ.get(bb);return aq.findMonthStart(cI);},_findFirstDayOfWeek:function(cJ){var A=this;var cK=A.get(r);var cI=cK.get(cb);return aq.getFirstDayOfWeek(cJ,cI);},_getEvtLabel:function(cJ){var cI=this;var cK=cJ.get(aA);var A=cJ.get(b9);return[A.getHours(),bJ,cK.getHours(),V,cJ.get(aM)].join(bG);},_getEvtSplitInfo:function(cO,A,cM){var cP=this;var cI=cO.getClearStartDate();var cN=cO.getClearEndDate();var cL=cO.getDaysDuration();var cK={};var cJ=1;if(aq.after(cI,A)){cJ=Math.min(cL,Math.abs(aq.getDayOffset(cM,cI))+1);if(cJ>1){cK.right=true;}}else{cJ=Math.abs(aq.getDayOffset(cN,A)+1);if(cJ>1){cK.left=true;}}cK.colspan=Math.min(cJ,aL);if(cJ>=aL){cK.right=true;cK.left=true;}return cK;},_uiSetCurrentDate:function(cI){var A=this;A.syncDaysHeaderUI();A.syncGridUI();},_valueColHeaderDaysNode:function(){var A=this;return A._valueNodeList(aL,N);},_valueTableGridNode:function(){var A=this;return A._valueNodeList(aL,bu);},_valueNodeList:function(cK,cJ){var A=this;var cI=[];while(cK--){cI.push(cJ);}return b6.NodeList.create(cI.join(bG));}}});b6.SchedulerMonthView=az;},"@VERSION@",{skinnable:true,requires:["aui-scheduler-event","aui-calendar","aui-button-item","dd-drag","dd-delegate","dd-drop","dd-constrain"]});AUI.add("aui-scheduler-event",function(aF){var ak=aF.Lang,bb=ak.isString,e=ak.isDate,a2=ak.isFunction,G=ak.isObject,a5=ak.isBoolean,Z=ak.isNumber,aR=aF.ColorUtil,i=aF.DataType.DateMath,aY=aF.cached(function(A){return A.substring(0,1).toUpperCase()+A.substring(1);}),a7="-",s="&ndash;",at=".",o="",p=" ",k="_",aH="_propagateSet",N="activeView",aD="borderStyle",bi="borderWidth",H="Change",aW="color",aP="colorBrightnessFactor",a6="colorSaturationFactor",aB="content",ad="contentNode",u="disabled",aT="duration",aJ="endDate",bc="events",ap="hidden",ao="icon",U="icons",aU="id",aQ="isoTime",bh="locale",aS="never",m="node",g="overlay",aG="parentEvent",bm="recorder",aI="repeat",ba="repeated",a4="repeater",M="repeatedEvents",ac="scheduler",aq="scheduler-event",ar="scheduler-event-recorder",be="startDate",a0="template",aO="title",d="titleDateFormat",F="titleNode",al="visible",c="%H:%M",aZ="%I:%M",D=aF.getClassName,j=D(ao),r=D(aq),aK=D(aq,aB),z=D(aq,ap),a9=D(aq,u),am=D(aq,bm),ax=D(aq,ba),aj=D(aq,a4),C=D(aq,aO),bg=D(aq,U);
CSS_SCHEDULER_EVENT_ICON_DISABLED=D(aq,ao,u),CSS_SCHEDULER_EVENT_ICON_REPEATED=D(aq,ao,ba),CSS_SCHEDULER_EVENT_ICON_REPEATER=D(aq,ao,a4);var R=aF.Component.create({NAME:aq,ATTRS:{borderStyle:{value:"solid",validator:bb},borderWidth:{value:"1px",validator:bb},colorBrightnessFactor:{value:0.75,validator:Z},colorSaturationFactor:{value:1.5,validator:Z},content:{value:"(no title)",validator:bb},color:{lazyAdd:false,setter:"_setColor",value:"#D96666",validator:bb},titleDateFormat:{getter:"_getTitleDateFormat",validator:bb},endDate:{valueFn:function(){var A=i.clone(this.get(be));A.setHours(A.getHours()+1);return A;},validator:e},columnNode:{setter:aF.one},disabled:{value:false,validator:a5},node:{valueFn:function(){return aF.Node.create(this.EVENT_NODE_TEMPLATE).setData(aq,this);},setter:aF.one},parentEvent:{},repeat:{setter:"_setRepeat"},scheduler:{lazyAdd:false,setter:"_setScheduler"},startDate:{valueFn:function(){return new Date();},validator:e},visible:{value:true,validator:a5}},EXTENDS:aF.Base,PROPAGATE_ATTRS:[be,aJ,aB,aW,aP,a6,aD,bi,d,al,u],prototype:{EVENT_NODE_TEMPLATE:'<div class="'+r+'">'+'<div class="'+C+'"></div>'+'<div class="'+aK+'"></div>'+'<div class="'+bg+'">'+'<span class="'+[j,CSS_SCHEDULER_EVENT_ICON_REPEATED].join(p)+'"></span>'+'<span class="'+[j,CSS_SCHEDULER_EVENT_ICON_REPEATER].join(p)+'"></span>'+'<span class="'+[j,CSS_SCHEDULER_EVENT_ICON_DISABLED].join(p)+'"></span>'+"</div>"+"</div>",eventStack:null,initializer:function(){var A=this;var L=A.get(m);A.eventStack={};A.nodeStack={};aF.Array.each(aF.SchedulerEvent.PROPAGATE_ATTRS,function(X){A.after(X+H,A._propagateAttrChange);});A._bindUIAttrs();A.contentNode=L.one(at+aK);A.titleNode=L.one(at+C);A.syncNodeUI(true);},destroy:function(){var A=this;A.eachRepeatedEvent(function(L,X){L.destroy();});A.eventStack={};A.get(m).remove(true);},copyDates:function(L){var A=this;A.set(aJ,i.clone(L.get(aJ)));A.set(be,i.clone(L.get(be)));},copyPropagateAttrValues:function(L,X){var A=this;A.copyDates(L);aF.Array.each(aF.SchedulerEvent.PROPAGATE_ATTRS,function(Y){if(!(Y in (X||{}))){var br=L.get(Y);if(!G(br)){A.set(Y,br);}}});},getBorderColor:function(){var A=this;return A.borderColorRGB.hex;},getDaysDuration:function(){var A=this;return i.getDayOffset(A.get(aJ),A.get(be));},getHoursDuration:function(){var A=this;return i.getHoursOffset(A.get(aJ),A.get(be));},getMinutesDuration:function(){var A=this;return i.getMinutesOffset(A.get(aJ),A.get(be));},getSecondsDuration:function(){var A=this;return i.getSecondsOffset(A.get(aJ),A.get(be));},sameEndDate:function(L){var A=this;return i.compare(A.get(aJ),L.get(aJ));},sameStartDate:function(L){var A=this;return i.compare(A.get(be),L.get(be));},isAfter:function(Y){var X=this;var L=X.get(be);var A=Y.get(be);return i.after(L,A);},isBefore:function(Y){var X=this;var L=X.get(be);var A=Y.get(be);return i.before(L,A);},repeatByDate:function(X){var A=this;var Y=A.uidByDate(X);if(!A.eventStack[Y]){var L=i.clone(X);var br=i.clone(X);i.copyHours(L,A.get(be));i.copyHours(br,A.get(aJ));var bs=new aF.SchedulerEvent({endDate:br,parentEvent:A,scheduler:A.get(ac),startDate:L});bs.copyPropagateAttrValues(A);A.eventStack[Y]=bs;}return A.eventStack[Y];},intersects:function(Y){var X=this;var br=X.get(aJ);var L=X.get(be);var A=Y.get(be);return(X.sameStartDate(Y)||i.between(A,L,br));},intersectHours:function(X){var L=this;var br=L.get(aJ);var A=L.get(be);var Y=i.clone(A);i.copyHours(Y,X.get(be));return(i.compare(A,Y)||i.between(Y,A,br));},isDayOverlapEvent:function(){var A=this;return i.isDayOverlap(A.get(be),A.get(aJ));},isRepeatableDate:function(L){var A=this;var X=A.get(aI);return(X&&X.validate(A,L));},getClearEndDate:function(){var A=this;return i.safeClearTime(A.get(aJ));},getClearStartDate:function(){var A=this;return i.safeClearTime(A.get(be));},uidByDate:function(L){var A=this;L=e(L)?i.safeClearTime(L):A.getClearStartDate();return[aq,L.getTime()].join(k);},setContent:function(X,L){var A=this;A._setContent(ad,X,L);},setTitle:function(X,L){var A=this;A._setContent(F,X,L);},syncNodeUI:function(L){var A=this;A._syncUIAttrs();A.syncNodeColorUI(L);A.syncNodeTitleUI(L);A.syncNodeContentUI(L);},syncNodeColorUI:function(L){var A=this;var X=A.get(m);var Y=A.getBorderColor();if(X){X.setStyles({borderWidth:A.get(bi),borderColor:Y,backgroundColor:A.get(aW),borderStyle:A.get(aD)});}if(A.titleNode){A.titleNode.setStyles({backgroundColor:Y});}if(L){A.eachRepeatedEvent(function(br,bs){br.syncNodeColorUI();});}},syncNodeContentUI:function(L){var A=this;A.setContent(A.get(aB),L);},syncNodeTitleUI:function(L){var A=this;var X=A._formatDate(A.get(be));var Y=A._formatDate(A.get(aJ));A.setTitle([X,Y].join(p+s+p),L);},eachRepeatedEvent:function(L){var A=this;aF.each(A.eventStack,L,A);},unlink:function(){var A=this;if(A.get(aG)){A.set(aG,null);}else{A.eachRepeatedEvent(function(L,X){L.unlink();});}A.eventStack={};A.syncNodeUI();},_afterDisabledChange:function(L){var A=this;A._uiSetDisabled(L.newVal);},_afterVisibleChange:function(L){var A=this;A._uiSetVisible(L.newVal);},_afterRepeatChange:function(L){var A=this;A._uiSetRepeat(L.newVal);},_afterParentEventChange:function(L){var A=this;A._uiSetParentEvent(L.newVal);},_bindUIAttrs:function(){var A=this;A.after("disabledChange",A._afterDisabledChange);A.after("visibleChange",A._afterVisibleChange);A.after("parentEventChange",A._afterParentEventChange);A.after("repeatChange",A._afterRepeatChange);A._syncUIAttrs();},_propagateAttrChange:function(Y){var A=this;var X=Y.attrName;var L=Y.newVal;A.eachRepeatedEvent(function(br,bs){var bt=br[aH+aY(X)];if(bt){bt.apply(A,[br,X,L]);}else{br.set(X,Y.newVal);}br.syncNodeUI();});A.syncNodeUI();},_propagateSetEndDate:function(A,L,Y){var X=i.clone(A.get(aJ));i.copyHours(X,Y);A.set(aJ,X);},_propagateSetStartDate:function(L,X,Y){var A=i.clone(L.get(be));i.copyHours(A,Y);L.set(be,A);},_setColor:function(L){var A=this;A.hsbColor=aR.rgb2hsb(aR.getRGB(L));A.borderColor=aF.clone(A.hsbColor);A.borderColor.b*=A.get(aP);A.borderColor.s*=A.get(a6);A.borderColorRGB=aR.hsb2rgb(A.borderColor);
return L;},_setContent:function(X,br,L){var A=this;var Y=A[X];if(Y){Y.setContent(br);}if(L){A.eachRepeatedEvent(function(bs,bt){bs[X].setContent(br);});}},_setRepeat:function(L){var A=this;if(bb(L)){L=aF.SchedulerEventRepeat[L];}return G(L)?L:null;},_setScheduler:function(X){var A=this;var L=A.get(ac);if(L){A.removeTarget(L);}A.addTarget(X);return X;},_syncUIAttrs:function(){var A=this;A._uiSetDisabled(A.get(u));A._uiSetVisible(A.get(al));A._uiSetParentEvent(A.get(aG));A._uiSetRepeat(A.get(aI));},_formatDate:function(X,Y){var L=this;var A=L.get(bh);Y=Y||L.get(d);return aF.DataType.Date.format(X,{format:Y,locale:A});},_getTitleDateFormat:function(X){var A=this;if(!bb(X)){var L=A.get(ac);X=(L&&L.get(N).get(aQ))?c:aZ;}return X;},_uiSetDisabled:function(L){var A=this;A.get(m).toggleClass(a9,!!L);},_uiSetParentEvent:function(L){var A=this;A.get(m).toggleClass(ax,!!L);},_uiSetRepeat:function(L){var A=this;A.get(m).toggleClass(aj,!!L&&L!==aF.SchedulerEventRepeat[aS]);},_uiSetVisible:function(L){var A=this;A.get(m).toggleClass(z,!L);}}});aF.SchedulerEvent=R;aF.SchedulerEventRepeat={never:{description:"Never repeat",validate:function(A,L){return false;},value:"never"},daily:{description:"Every day",validate:function(A,L){return true;},value:"daily"},monthly:{description:"Every month",validate:function(L,X){var Y=L.get(aJ);var A=L.get(be);return(A.getDate()===X.getDate());},value:"monthly"},monWedFri:{description:"Every Monday, Wednesday and Friday",validate:function(A,L){return i.isMonWedOrFri(L);},value:"monWedFri"},tuesThurs:{description:"Every Tuesday and Thursday",validate:function(A,L){return i.isTueOrThu(L);},value:"tuesThurs"},weekDays:{description:"Every week days",validate:function(A,L){return i.isWeekDay(L);},value:"weekDays"},weekly:{description:"Every week",validate:function(L,X){var Y=L.get(aJ);var A=L.get(be);return(A.getDay()===X.getDay());},value:"weekly"},yearly:{description:"Every year",validate:function(L,X){var Y=L.get(aJ);var A=L.get(be);return((A.getMonth()===X.getMonth())&&(A.getDay()===X.getDay()));},value:"yearly"}};var au=aF.Lang,a=au.isArray,G=au.isObject,N="activeView",b="arrow",aN="body",aw="bodyContent",n="boundingBox",av="cancel",aV="click",aB="content",aM="date",aC="dateFormat",ag="delete",a3="description",O="edit",bl="event",y="footerContent",aA="form",x="header",t="hide",aQ="isoTime",m="node",g="overlay",P="overlayOffset",bm="recorder",bj="rendered",aI="repeat",aX="save",ac="scheduler",l="schedulerChange",aq="scheduler-event",ar="scheduler-event-recorder",az="shadow",ay="show",E="startDateChange",K="strings",a0="template",aO="title",bk="tl",W="toolbar",bd="submit",bf="value",aL="visibleChange",T="when",ai="x",ah="y",ab="cancel",J="delete",w="edit",aE="save",bn="-",f=".",aa="",h="#",q=aF.IO.prototype._serialize,D=aF.getClassName,r=D(ac,bl),am=D(ac,bl,bm),bo=D(ac,bl,bm,g),v=D(ac,bl,bm,g,b),a8=D(ac,bl,bm,g,b,az),af=D(ac,bl,bm,g,aN),a1=D(ac,bl,bm,g,aB),ae=D(ac,bl,bm,g,aM),B=D(ac,bl,bm,g,ag),Q=D(ac,bl,bm,g,aA),bq=D(ac,bl,bm,g,x),an=D(ac,bl,bm,g,aI),C=D(ac,bl,aO),I=new aF.Template('<div class="',a8," ",v,'"></div>','<div class="',v,'"></div>','<input type="hidden" name="startDate" value="{startDate}" />','<input type="hidden" name="endDate" value="{endDate}" />','<div class="',bq,'">','<input class="',a1,'" name="content" value="{content}" />',"</div>",'<div class="',af,'">','<label class="',ae,'">{date}</label>','<select class="',an,'" name="repeat">','<tpl for="eventRepeat">','<option {[ (parent.repeat && parent.repeat.value) == parent.eventRepeat[$i].value ? \'selected="selected"\' : "" ]} value="{value}">{description}</option>',"</tpl>","</select>","</div>"),V='<a class="'+B+'" href="javascript:;">{delete}</a>',bp='<form class="'+Q+'" id="schedulerEventRecorderForm"></form>';var S=aF.Component.create({NAME:ar,ATTRS:{content:{value:aa},duration:{value:60},dateFormat:{validator:bb,value:"%a, %B %d,"},event:{},strings:{value:{},setter:function(A){return aF.merge({"delete":"Delete","description-hint":"e.g., Dinner at Brian's","no-repeat":"No repeat",cancel:"Cancel",description:"Description",edit:"Edit",repeat:"Repeat",save:"Save",when:"When"},A||{});},validator:G},overlay:{validator:G,value:{align:{points:[bk,bk]},visible:false,width:260,zIndex:500}},overlayOffset:{value:[95,-31],validator:a},template:{value:I},toolbar:{setter:function(X){var L=this;var A=L.get(K);return aF.merge({children:[{handler:aF.bind(L._handleSaveEvent,L),label:A[aX]},{handler:aF.bind(L._handleCancelEvent,L),label:A[av]}]},X||{});},validator:G,value:{}}},EXTENDS:aF.SchedulerEvent,prototype:{initializer:function(){var A=this;A.publish(ab,{defaultFn:A._defCancelEventFn});A.publish(J,{defaultFn:A._defDeleteEventFn});A.publish(w,{defaultFn:A._defEditEventFn});A.publish(aE,{defaultFn:A._defSaveEventFn});A.after(l,A._afterSchedulerChange);A.on(E,A._onStartDateChange);A[g]=new aF.Overlay(A.get(g));A[W]=new aF.Toolbar(A.get(W));A.get(m).addClass(am);},_afterSchedulerChange:function(Y){var A=this;var X=Y.newVal;var L=X.get(n);L.delegate(aV,aF.bind(A._onClickSchedulerEvent,A),f+r);},_defCancelEventFn:function(L){var A=this;A.get(m).remove();A.hideOverlay();},_defDeleteEventFn:function(X){var A=this;var L=A.get(ac);L.removeEvent(A.get(bl));A.hideOverlay();L.syncEventsUI();},_defEditEventFn:function(X){var A=this;var L=A.get(ac);A.hideOverlay();L.syncEventsUI();},_defSaveEventFn:function(X){var A=this;var L=A.get(ac);L.addEvent(X.newSchedulerEvent);A.hideOverlay();L.syncEventsUI();},_handleCancelEvent:function(L){var A=this;A.fire(ab);L.preventDefault();},_handleSaveEvent:function(L){var A=this;A.fire(A.get(bl)?w:aE,{newSchedulerEvent:A.getEventCopy()});L.preventDefault();},_onClickDelete:function(){var A=this;A.fire(J);},_onClickSchedulerEvent:function(X){var A=this;var L=X.currentTarget.getData(aq);if(L){A.set(bl,L);A.showOverlay();A.get(m).remove();}},_onOverlayVisibleChange:function(Y){var L=this;if(Y.newVal){L.populateForm();if(!L.get(bl)){var X=L[g].get(n);var A=X.one(f+a1);setTimeout(function(){A.selectText();
},0);L.deleteNode.hide();}else{L.deleteNode.show();}}else{L.set(bl,null);L.get(m).remove();}},_onStartDateChange:function(L){var A=this;var X=A.get(aT);A.set(aJ,i.add(L.newVal,i.MINUTES,X));},_onSubmitForm:function(L){var A=this;A._handleSaveEvent(L);},_renderOverlay:function(){var L=this;var A=L.get(K);L[g].render();L[W].render();var X=L[g].get(n);X.addClass(bo);L[g].set(y,L[W].get(n));L[g].on(aL,aF.bind(L._onOverlayVisibleChange,L));L.deleteNode=aF.Node.create(au.sub(V,{"delete":A[ag]}));L.deleteNode.on(aV,aF.bind(L._onClickDelete,L));X.append(L.deleteNode);L.formNode=aF.Node.create(bp);L.formNode.on(bd,aF.bind(L._onSubmitForm,L));L[g].set(aw,L.formNode);},getEventCopy:function(){var A=this;var X=A.get(bl);if(!X){X=new aF.SchedulerEvent({endDate:A.get(aJ),scheduler:A.get(ac),startDate:A.get(be)});X.copyPropagateAttrValues(A,{content:true});}var L=A.serializeForm();X.set(aB,L[aB]);X.set(aI,L[aI]);return X;},getFormattedDate:function(){var X=this;var L=X.get(aC);var br=(X.get(bl)||X);var bt=br.get(aJ);var bs=br.get(ac);var A=br.get(be);var Y=(bs.get(N).get(aQ)?i.toIsoTimeString:i.toUsTimeString);return[br._formatDate(A,L),Y(A),a7,Y(bt)].join(p);},hideOverlay:function(){var A=this;A[g].hide();},populateForm:function(){var L=this;var A=L.get(K);if(!L.eventRepeatArray){L.eventRepeatArray=[];aF.each(aF.SchedulerEventRepeat,function(Y){L.eventRepeatArray.push({description:Y[a3],value:Y[bf]});});}var X=(L.get(bl)||L);L.formNode.setContent(L.get(a0).parse({content:X.get(aB)||A["description-hint"],date:L.getFormattedDate(),endDate:X.get(aJ),eventRepeat:L.eventRepeatArray,repeat:X.get(aI),startDate:X.get(be)}));},serializeForm:function(){var A=this;return aF.QueryString.parse(q(A.formNode.getDOM()));},showOverlay:function(X,Y){var A=this;if(!A[g].get(bj)){A._renderOverlay();}A[g].show();if(!X){var L=(A.get(bl)||A).get(m);X=L.one(f+C);}A[g].set("align.node",X);Y=Y||A.get(P);A[g].move(A[g].get(ai)+Y[0],A[g].get(ah)+Y[1]);}}});aF.SchedulerEventRecorder=S;},"@VERSION@",{skinnable:true,requires:["aui-base","aui-color-util","aui-datatype","aui-template","aui-toolbar","io-form","querystring","overlay"]});AUI.add("aui-scheduler-calendar",function(d){var i=d.Lang,j=i.isArray,c=i.isBoolean,b=i.isString,g=function(m){return(m instanceof d.SchedulerEvent);},e="scheduler-calendar",a="color",l="events",h="pallete",k="visible";var f=d.Component.create({NAME:e,ATTRS:{color:{valueFn:function(){var n=this;var o=n.get(h);var m=Math.ceil(Math.random()*o.length)-1;return o[m];},validator:b},name:{value:"(no name)",validator:b},pallete:{value:["#d96666","#e67399","#b373b3","#8c66d9","#668cb3","#668cd9","#59bfb3","#65ad89","#4cb052","#8cbf40","#bfbf4d","#e0c240","#f2a640","#e6804d","#be9494","#a992a9","#8997a5","#94a2be","#85aaa5","#a7a77d","#c4a883","#c7561e","#b5515d","#c244ab","#603f99","#536ca6","#3640ad","#3c995b","#5ca632","#7ec225","#a7b828","#cf9911","#d47f1e","#b56414","#914d14","#ab2671","#9643a5","#4585a3","#737373","#41a587","#d1bc36","#ad2d2d"],validator:j},visible:{value:true,validator:c}},EXTENDS:d.Base,AUGMENTS:d.SchedulerEventSupport,prototype:{initializer:function(){var m=this;m.after("colorChange",m._afterColorChange);m.after("eventsChange",m._afterEventsChange);m.on("visibleChange",m._onVisibleChange);m._uiSetVisible(m.get(k));m._uiSetEvents(m.get(l));},syncEventsColor:function(n){var m=this;d.Array.each(n||m.get(l),function(o,p){o.set(a,m.get(a));});},_afterColorChange:function(n){var m=this;m.syncEventsColor(m.get(l));},_afterEventsChange:function(n){var m=this;m._uiSetEvents(n.newVal);},_onVisibleChange:function(n){var m=this;m._uiSetVisible(n.newVal);},_uiSetEvents:function(n){var m=this;m.syncEventsColor(n);},_uiSetVisible:function(n){var m=this;m.eachEvent(function(o,p){o.set(k,n);});}}});d.SchedulerCalendar=f;},"@VERSION@",{requires:["aui-scheduler-event"],skinnable:true});AUI.add("aui-scheduler",function(a){},"@VERSION@",{skinnable:true,use:["aui-scheduler-base","aui-scheduler-view","aui-scheduler-event","aui-scheduler-calendar"]});