AUI.add("aui-scheduler-base",function(ab){var O=ab.Lang,av=O.isString,a=O.isArray,d=O.isDate,I=O.isNumber,B=O.isObject,H=function(A){return(A instanceof ab.Scheduler);},s=function(A){return(A instanceof ab.SchedulerView);},Z=function(A){return(A instanceof ab.SchedulerEvent);},t=function(A){return(ab.SchedulerCalendar&&(A instanceof ab.SchedulerCalendar));},h=ab.DataType.DateMath,V=ab.WidgetStdMod,T=".",o="",p=" ",r="scheduler-base",ah="data-view-name",F="activeView",au="clearfix",E="controls",aj="controlsNode",am="current",aa="currentDate",X="currentDateNode",ai="date",af="endDate",ag="eventClass",aw="events",aB="hd",v="header",at="headerNode",m="helper",R="icon",j="iconNextNode",ap="iconPrevNode",az="locale",l="name",P="nav",M="navNode",ao="navigationDateFormat",n="next",c="nextDate",ar="prev",ak="prevDate",aA="rendered",L="scheduler",ax="startDate",D="strings",e="today",ac="todayNode",u="triggerNode",y="view",N="viewStack",aC="views",W="viewsNode",z=ab.getClassName,ad=z(m,au),i=z(R),an=z(r,E),S=z(r,am,ai),f=z(r,aB),U=z(r,R,n),C=z(r,R,ar),ay=z(r,P),x=z(r,e),Y=z(r,y),g=z(r,y,o),q=z(r,aC),al='<div class="'+an+'"></div>',w='<div class="'+S+'"></div>',b='<div class="'+f+'"></div>',aD='<a href="#" class="'+[i,U].join(p)+'">Next</a>',ae='<a href="#" class="'+[i,C].join(p)+'">Prev</a>',k='<div class="'+ay+'"></div>',Q='<a href="#" class="'+x+'">{today}</a>',aq='<a href="#" class="'+[Y,g].join(p)+'{name}" data-view-name="{name}">{label}</a>',J='<div class="'+q+'"></div>';var K=function(){};K.ATTRS={eventClass:{valueFn:function(){return ab.SchedulerEvent;}},events:{value:[],setter:"_setEvents",validator:a}};ab.mix(K.prototype,{addEvent:function(aE){var A=this;var aF=A.get(aw);if(ab.Array.indexOf(aF,aE)>-1){ab.Array.removeItem(aF,aE);}aF.push(aE);A.set(aw,aF);},addEvents:function(aE){var A=this;ab.Array.each(A._normalizeEvents(aE),ab.bind(A.addEvent,A));},eachEvent:function(aF){var A=this;var aE=A.get(aw);ab.Array.each(aE,aF,A);},removeEvent:function(aE){var A=this;var aF=A.get(aw);if(aF.length){ab.Array.removeItem(aF,aE);A.set(aw,aF);}},removeEvents:function(aE){var A=this;ab.Array.each(A._normalizeEvents(aE),ab.bind(A.removeEvent,A));},_normalizeEvents:function(aF){var A=this;var aE=[];aF=ab.Array(aF);ab.Array.each(aF,function(aG){if(Z(aG)){aE.push(aG);}else{if(t(aG)){if(H(A)){aG.set(L,A);}aE=aE.concat(A._normalizeEvents(aG.get(aw)));}else{aG=new (A.get(ag))(aG);aE.push(aG);}}if(H(A)){aG.set(L,A);aG.set(ag,A.get(ag));}});return aE;},_setEvents:function(aE){var A=this;return A._normalizeEvents(aE);}});ab.SchedulerEventSupport=K;var G=ab.Component.create({NAME:r,ATTRS:{activeView:{validator:s},eventRecorder:{setter:"_setEventRecorder"},strings:{value:{day:"Day",month:"Month",today:"Today",week:"Week",year:"Year"}},navigationDateFormat:{getter:function(aF){var A=this;var aE=A.get(F);if(aE){return aE.get(ao);}return aF;},value:"%A - %d %b %Y",validator:av},views:{setter:"_setViews",value:[]},currentDate:{valueFn:function(){return new Date();},validator:d},firstDayOfWeek:{value:0,validator:I},controlsNode:{valueFn:function(){return ab.Node.create(al);}},currentDateNode:{valueFn:function(){return ab.Node.create(w);}},headerNode:{valueFn:function(){return ab.Node.create(b);}},iconNextNode:{valueFn:function(){return ab.Node.create(aD);}},iconPrevNode:{valueFn:function(){return ab.Node.create(ae);}},navNode:{valueFn:function(){return ab.Node.create(k);}},todayNode:{valueFn:function(){return ab.Node.create(this._processTemplate(Q));}},viewsNode:{valueFn:function(){return ab.Node.create(J);}}},HTML_PARSER:{controlsNode:T+an,currentDateNode:T+S,headerNode:T+f,iconNextNode:T+U,iconPrevNode:T+C,navNode:T+ay,todayNode:T+x,viewsNode:T+q},UI_ATTRS:[aa],AUGMENTS:[ab.SchedulerEventSupport,ab.WidgetStdMod],prototype:{viewStack:null,initializer:function(){var A=this;A[N]={};A[aj]=A.get(aj);A[X]=A.get(X);A[v]=A.get(at);A[j]=A.get(j);A[ap]=A.get(ap);A[M]=A.get(M);A[ac]=A.get(ac);A[W]=A.get(W);A.after({activeViewChange:A._afterActiveViewChange,render:A._afterRender});},bindUI:function(){var A=this;A._bindDelegate();},syncUI:function(){var A=this;A.syncStdContent();},flushEvents:function(){var A=this;ab.Array.each(A.get(aw),function(aE){aE.eachRepeatedEvent(function(aF){delete aF._filtered;});delete aE._filtered;});},getEventsByDay:function(aE,aF){var A=this;aE=h.safeClearTime(aE);return A._getEvents(aE,function(aG){return h.compare(aG.getClearStartDate(),aE)||(aF&&h.compare(aG.getClearEndDate(),aE));});},getIntersectEvents:function(aE){var A=this;aE=h.safeClearTime(aE);return A._getEvents(aE,function(aG){var aF=aG.getClearStartDate();var aH=aG.getClearEndDate();return(h.compare(aE,aF)||h.compare(aE,aH)||h.between(aE,aF,aH));});},sortEventsByDateAsc:function(aE){var A=this;aE.sort(function(aI,aG){var aH=aI.get(af);var aF=aG.get(af);var aK=aI.get(ax);var aJ=aG.get(ax);if(h.after(aK,aJ)||(h.compare(aK,aJ)&&h.before(aH,aF))){return 1;}else{return -1;}});},getViewByName:function(aE){var A=this;return A[N][aE];},getStrings:function(){var A=this;return A.get(D);},getString:function(aE){var A=this;return A.getStrings()[aE];},renderView:function(aE){var A=this;if(aE){aE.show();if(!aE.get(aA)){if(!A.bodyNode){A.setStdModContent(V.BODY,o);}aE.render(A.bodyNode);}}},plotViewEvents:function(aE){var A=this;aE.plotEvents(A.get(aw));},syncEventsUI:function(){var A=this;A.plotViewEvents(A.get(F));},_afterActiveViewChange:function(aG){var aE=this;if(aE.get(aA)){var aF=aG.newVal;var A=aG.prevVal;if(A){A.hide();}aE.renderView(aF);}},_afterRender:function(aE){var A=this;A.renderView(A.get(F));},_bindDelegate:function(){var A=this;A[W].delegate("click",A._onClickViewTrigger,T+Y,A);A[aj].delegate("click",A._onClickPrevIcon,T+C,A);A[aj].delegate("click",A._onClickNextIcon,T+U,A);A[aj].delegate("click",A._onClickToday,T+x,A);},_createViewTriggerNode:function(aE){var A=this;if(!aE.get(u)){var aF=aE.get(l);aE.set(u,ab.Node.create(O.sub(aq,{name:aF,label:(A.getString(aF)||aF)})));}return aE.get(u);},_getEvents:function(aE,aH){var A=this;var aG=A.get(aw);
var aF=[];ab.Array.each(aG,function(aI){if(aH.apply(A,[aI])){aF.push(aI);}else{if(aI.isRepeatableDate(aE)){var aJ=aI.repeatByDate(aE);aF.push(aJ);}}});A.sortEventsByDateAsc(aF);return aF;},_onClickToday:function(aE){var A=this;A.set(aa,A.get(F).getToday());aE.preventDefault();},_onClickNextIcon:function(aE){var A=this;A.set(aa,A.get(F).get(c));aE.preventDefault();},_onClickPrevIcon:function(aE){var A=this;A.set(aa,A.get(F).get(ak));aE.preventDefault();},_onClickViewTrigger:function(aE){var A=this;var aF=aE.currentTarget.attr(ah);A.set(F,A.getViewByName(aF));aE.preventDefault();},_processTemplate:function(aE){var A=this;return O.sub(aE,A.getStrings());},_setEventRecorder:function(aE){var A=this;if(aE){aE.set(L,A);aE.set(ag,A.get(ag));}},_setViews:function(aF){var A=this;var aE=[];ab.Array.each(aF,function(aG){if(s(aG)&&!aG.get(aA)){aG.set(L,A);aG.set(ag,A.get(ag));aE.push(aG);A[N][aG.get(l)]=aG;}});if(!A.get(F)){A.set(F,aF[0]);}return aE;},syncStdContent:function(){var A=this;var aE=A.get(aC);A[M].append(A[ap]);A[M].append(A[j]);A[aj].append(A[ac]);A[aj].append(A[M]);A[aj].append(A[X]);ab.Array.each(aE,function(aF){A[W].append(A._createViewTriggerNode(aF));});A[v].append(A[aj]);A[v].append(A[W]);A[v].addClass(ad);A.setStdModContent(V.HEADER,A[v].getDOM());},_uiSetCurrentDate:function(aG){var A=this;var aF=ab.DataType.Date.format(aG,{format:A.get(ao),locale:A.get(az)});A[X].html(aF);if(A.get(aA)){var aE=A.get(F);if(aE){aE._uiSetCurrentDate(aG);}A.syncEventsUI();}}}});ab.Scheduler=G;},"@VERSION@",{skinnable:true,requires:["aui-scheduler-view","datasource"]});AUI.add("aui-scheduler-view",function(cw){var cK=cw.Lang,a7=cK.isBoolean,w=cK.isFunction,aI=cK.isNumber,cY=cK.isObject,cl=cK.isString,b8=function(A){return parseFloat(A)||0;},cb=function(c3,A){return Math.round(c3/A)*A;},aq=cw.DataType.DateMath,cr=cw.WidgetStdMod,aP=aq.WEEK_LENGTH,cd="scheduler-view",aH="scheduler-view-day",cR="scheduler-view-month",b3="scheduler-view-table",cB="scheduler-view-week",bl="activeColumn",b7="activeView",M="allDay",aX="boundingBox",c1="cancel",ah="col",ay="colDaysNode",cz="colHeaderDaysNode",H="colblank",v="coldata",aK="colday",a="colgrid",W="colspan",m="coltime",bF="columnData",a5="columnDayHeader",aM="columnShims",aU="columnTableGrid",bs="columnTime",aT="container",aQ="content",bk="creationEndDate",Z="creationStartDate",br="currentDate",bS="data",cH="day",S="days",z="delegateConfig",b5="disabled",a2="displayDaysInterval",X="div",bD="division",cU="dotted",ab="down",E="draggingEvent",ck="duration",aC="endDate",bf="event",cT="eventClass",b4="eventPlaceholder",c0="eventRecorder",q="eventWidth",cq="filterFn",aJ="first",cC="firstDayOfWeek",bW="fixedHeight",bn="grid",bP="gridContainer",bg="grip",cZ="hd",ct="header",bp="headerDateFormat",cX="headerTableNode",bb="headerView",bB="headerViewConfig",bi="horizontal",aW="host",aF="hourHeight",s="icon",s="icon",al="isoTime",a3="lasso",aY="left",az="locale",ad="marker",bh="markercell",a9="markercellsNode",I="markers",bY="markersNode",b0="month",bm="monthContainerNode",cD="monthRowContainer",e="monthRows",B="mousedown",K="mousemove",a1="mouseup",aR="next",c2="node",ak="nomonth",ar="noscroll",cs="offsetHeight",cu="offsetWidth",cx="pad",aL="paddingNode",cM="parentEvent",Q="parentNode",bM="proxy",ai="px",ae="region",aZ="rendered",co="repeated",cg="resizer",cm="resizerNode",ca="resizing",ba="right",bJ="row",bI="rowsContainerNode",cc="save",p="scheduler",aE="scheduler-event",Y="scrollable",R="shim",cA="startDate",V="startXY",a0="table",y="tableGridNode",bQ="tableNode",b1="tableRowContainer",cQ="tableRows",bO="tbody",g="td",bG="time",aj="timesNode",i="title",am="today",bK="top",ax="visible",cN="week",bU="width",t="data-colnumber",k="a",bC=",",b9="-",cf=".",b6="",bV="%",U=" ",C=cw.getClassName,bE=C(cd,ar),ac=C(cd,Y);var a8=cw.Component.create({NAME:cd,AUGMENTS:[cw.WidgetStdMod],ATTRS:{bodyContent:{value:b6},eventClass:{valueFn:function(){return cw.SchedulerEvent;}},filterFn:{validator:w,value:function(A){return true;}},height:{value:600},isoTime:{value:false,validator:a7},name:{value:b6,validator:cl},navigationDateFormat:{value:"%A - %d %B, %Y",validator:cl},nextDate:{getter:"getNextDate",readOnly:true},prevDate:{getter:"getPrevDate",readOnly:true},scheduler:{lazyAdd:false,setter:"_setScheduler"},scrollable:{value:true,validator:a7},triggerNode:{setter:cw.one},visible:{value:false}},BIND_UI_ATTRS:[Y],prototype:{initializer:function(){var A=this;A.after("render",A._afterRender);},syncUI:function(){var A=this;A.syncStdContent();},adjustCurrentDate:function(){var A=this;var c4=A.get(p);var c3=c4.get(br);c4.set(br,c3);},flushViewCache:function(){},getNextDate:function(){},getPrevDate:function(){},getToday:function(){return aq.clearTime(new Date());},limitDate:function(c3,c4){var A=this;if(aq.after(c3,c4)){c3=aq.clone(c4);}return c3;},plotEvents:function(){},syncStdContent:function(){},syncEventUI:function(A){},_uiSetCurrentDate:function(A){},_afterRender:function(c3){var A=this;A.adjustCurrentDate();A._uiSetScrollable(A.get(Y));},_setScheduler:function(c4){var A=this;var c3=A.get(p);if(c3){A.removeTarget(c3);}if(c4){A.addTarget(c4);c4.after("eventsChange",cw.bind(A.flushViewCache,A));}return c4;},_uiSetScrollable:function(c4){var A=this;var c3=A.bodyNode;if(c3){c3.toggleClass(ac,c4);c3.toggleClass(bE,!c4);}},_uiSetVisible:function(c3){var A=this;a8.superclass._uiSetVisible.apply(this,arguments);if(c3&&A.get(aZ)){A.adjustCurrentDate();}}}});cw.SchedulerView=a8;var b2=cK.sub;var L=function(A,c3){return function(c5){var c4=c5.all(A);return(c4.size()>=c3)?c4:null;};},h=C(s),F=C(s,bg,cU,bi),aN=C(aE),bx=C(aE,b5),ci=C(aE,bM),P=C(p,am),ao=C(p,am,cZ),x=C(cd,v),d=C(cd,a),cE=C(cd,bn),cF=C(cd,bn,aT),aO=C(cd,cH,cg,s),ch=C(cd,cH,cg),bA=C(cd,ad,bD),cG=C(cd,bh),J=C(cd,I),bR=C(cd,cH,a0),cJ=C(cd,cH,ct,a0),r=C(cd,cH,ct,cH),bz=C(cd,cH,ct,cH,cx,ba),cj=C(cd,cH,ct,cH,aJ),be=C(cd,cH,ct,ah),cV=C(cd,cH,a0,ah),aD=C(cd,cH,a0,ah,R),O=C(cd,cH,a0,H),G=C(cd,cH,a0,aK),cO=C(cd,cH,a0,m),bH=C(cd,cH,a0,bG),n='<div class="'+ch+'">'+'<div class="'+[h,F,aO].join(U)+'"></div>'+"</div>",af='<div class="'+cG+'">'+'<div class="'+bA+'"></div>'+"</div>",av='<table cellspacing="0" cellpadding="0" class="'+bR+'">'+"<tbody>"+'<tr class="'+d+'" height="1">'+'<td height="0" class="'+[cV,O].join(U)+'"></td>'+'<td class="'+cF+'" colspan="1">'+'<div class="'+cE+'">'+'<div class="'+J+'"></div>'+"</div>"+"</td>"+"</tr>"+'<tr class="'+x+'">'+'<td class="'+[cV,cO].join(U)+'"></td>'+"</tr>"+"</tbody>"+"</table>",bt='<td class="'+[cV,G].join(U)+'" data-colnumber="{colNumber}">'+'<div class="'+aD+'"></div>'+"</td>",j='<div class="'+bH+'">{hour}</div>',aw='<table cellspacing="0" cellpadding="0" class="'+cJ+'">'+"<tbody>"+'<tr class="'+be+'"></tr>'+"</tbody>"+"</table>",bw='<th class="'+r+'" data-colnumber="{colNumber}"><a href="#">&nbsp;</a></th>',au='<td class="'+[r,cj].join(U)+'"></td>',u='<th class="'+[r,bz].join(U)+'">&nbsp;</th>';
var cW=cw.Component.create({NAME:aH,ATTRS:{bodyContent:{value:b6},days:{value:1,validator:aI},delegateConfig:{value:{},setter:function(c3){var A=this;return cw.merge({dragConfig:{useShim:false},bubbleTargets:A,container:A.get(aX),nodes:cf+aN,invalid:"input, select, button, a, textarea, "+cf+bx},c3||{});},validator:cY},filterFn:{value:function(A){return(A.getHoursDuration()<=24&&!A.get(M));}},headerDateFormat:{value:"%d %A",validator:cl},headerView:{value:true,validator:a7},headerViewConfig:{setter:function(c3){var A=this;return cw.merge({displayDaysInterval:1,displayRows:6,filterFn:function(c4){return((c4.getHoursDuration()>24)||c4.get(M));},height:"auto",visible:true},c3||{});},value:{}},name:{value:cH},hourHeight:{value:52,validator:aI},eventWidth:{value:95,validator:aI},headerTableNode:{valueFn:function(){return cw.Node.create(aw);}},resizerNode:{valueFn:function(){return cw.Node.create(n);}},tableNode:{valueFn:function(){return cw.Node.create(av);}},colDaysNode:{valueFn:"_valueColDaysNode"},colHeaderDaysNode:{valueFn:"_valueColHeaderDaysNode"},markercellsNode:{valueFn:"_valueMarkercellsNode"},timesNode:{valueFn:"_valueTimesNode"}},HTML_PARSER:{colDaysNode:L(cf+G,1),colHeaderDaysNode:L(cf+r,2),headerTableNode:cf+cJ,markercellsNode:L(cf+cG,24),resizerNode:cf+ch,tableNode:cf+bR,timesNode:L(cf+bH,24)},EXTENDS:cw.SchedulerView,prototype:{initializer:function(){var A=this;A[ay]=A.get(ay);A[cz]=A.get(cz);A[cX]=A.get(cX);A[a9]=A.get(a9);A[cm]=A.get(cm);A[bQ]=A.get(bQ);A[aj]=A.get(aj);A[bl]=null;A[bF]=A[bQ].one(cf+x);A[a5]=A.headerTableNode.one(cf+be);A[aM]=A[ay].all(cf+aD);A[bs]=A[bQ].one(cf+cO);A[bP]=A[bQ].one(cf+cF);A[bY]=A[bQ].one(cf+J);if(A.get(bb)){A[bb]=new cw.SchedulerTableView(A.get(bB));}},renderUI:function(){var A=this;A[bs].setContent(A[aj]);A[bY].setContent(A[a9]);A[ay].appendTo(A[bF]);A[cz].appendTo(A[a5]);if(A[bb]){A[bb].set(p,A.get(p));A[bb].render();}},bindUI:function(){var A=this;A[cX].delegate("click",cw.bind(A._onClickDaysHeader,A),cf+r);A[bF].delegate("mousedown",cw.bind(A._onMouseDownTableCol,A),cf+cV);A[bF].delegate("mouseenter",cw.bind(A._onMouseEnterEvent,A),cf+aN);A[bF].delegate("mouseleave",cw.bind(A._onMouseLeaveEvent,A),cf+aN);A[bF].delegate("mousemove",cw.bind(A._onMouseMoveTableCol,A),cf+G);A[bF].delegate("mouseup",cw.bind(A._onMouseUpTableCol,A),cf+cV);A.on("drag:end",A._onEventDragEnd);A.on("drag:start",A._onEventDragStart);A.on("drag:tickAlignY",A._dragTickAlignY);A.on("schedulerChange",A._onSchedulerChange);A.after("drag:align",A._afterDragAlign);},syncUI:function(){var A=this;cW.superclass.syncUI.apply(this,arguments);A[bP].attr(W,A.get(S));A._setupDragDrop();},syncStdContent:function(){var c3=this;c3.setStdModContent(cr.BODY,c3[bQ].getDOM());var A=cw.NodeList.create(c3[cX]);if(c3[bb]){A.push(c3[bb].get(aX));}c3.setStdModContent(cr.HEADER,A);},calculateEventHeight:function(c4){var c3=this;var A=c3.get(aF);return Math.max(c4*(A/60),A/2);},calculateTop:function(c3){var A=this;return((c3.getHours()*60)+c3.getMinutes()+(c3.getSeconds()/60))*(A.get(aF)/60);},getNextDate:function(){var A=this;var c3=A.get(p).get(br);return aq.add(c3,aq.DAY,1);},getPrevDate:function(){var A=this;var c3=A.get(p).get(br);return aq.subtract(c3,aq.DAY,1);},getColumnByDate:function(c3){var A=this;return A[ay].item(A.getDateDaysOffset(c3));},getColumnShimByDate:function(c3){var A=this;return A[aM].item(A.getDateDaysOffset(c3));},getDateByColumn:function(c4){var A=this;var c3=aq.safeClearTime(A.get(p).get(br));return aq.add(c3,aq.DAY,c4);},getDateDaysOffset:function(c4){var A=this;var c3=aq.safeClearTime(A.get(p).get(br));return aq.getDayOffset(aq.safeClearTime(c4),c3);},getYCoordTime:function(c6){var c3=this;var A=c3.get(aF);var c7=b8((c6/A).toFixed(2));var c5=Math.floor((c7*100)%100*0.6);var c4=Math.floor(c7);return[c4,c5,0];},plotEvent:function(c4){var A=this;var c5=c4.get(c2);if(c5.size()<2){c4.addPaddingNode();}var c7=c4.get(c2).item(0);var c3=c4.get(c2).item(1);var c6=A.getColumnShimByDate(c4.get(aC));var c8=A.getColumnShimByDate(c4.get(cA));if(c8){c8.append(c7);if(c4.get(ax)){c7.show();}}else{c7.hide();}if(c6){if(c6.compareTo(c8)||c4.isDayBoundaryEvent()){c3.hide();}else{c6.append(c3);if(c4.get(ax)){c3.show();}}}else{c3.hide();}A.syncEventTopUI(c4);A.syncEventHeightUI(c4);},plotEvents:function(){var A=this;var c3=A.get(p);var c5=A.get(cq);A[aM].each(function(da,c9){var c7=c3.getEventsByDay(A.getDateByColumn(c9),true);var c8=[];da.empty();cw.Array.each(c7,function(db){if(c5.apply(A,[db])){A.plotEvent(db);c8.push(db);}});A.syncEventsIntersectionUI(c8);});if(A[bb]){A[bb].plotEvents();var c6=A[bb].get(aX);var c4=c6.one(cf+bd);A[bb].set("height",c4.get(cs));A._fillHeight();}},syncColumnsUI:function(){var A=this;A[ay].each(function(c5,c4){var c3=A.getDateByColumn(c4);c5.toggleClass(P,aq.isToday(c3));});},syncDaysHeaderUI:function(){var c4=this;var c5=c4.get(p).get(br);var c3=c4.get(bp);var A=c4.get(az);c4[cz].all(k).each(function(c8,c7){var c6=aq.add(c5,aq.DAY,c7);var c9=cw.DataType.Date.format(c6,{format:c3,locale:A});c8.toggleClass(ao,aq.isToday(c6));c8.html(c9);});},syncEventsIntersectionUI:function(c3){var A=this;var c4=A.get(q);A.get(p).flushEvents();cw.Array.each(c3,function(c6){var c8=A.findEventIntersections(c6,c3);var c7=c8.length;var c5=(c4/c7);cw.Array.each(c8,function(da,db){var c9=da.get(c2).item(0);var dd=c5*db;var dc=c5*1.7;if(db===(c7-1)){dc=c4-dd;}c9.setStyle(bU,dc+bV);c9.setStyle(aY,dd+bV);var de=c9.get(Q);if(de){de.insert(c9,db);}da._filtered=true;});});},syncEventHeightUI:function(c5){var c3=this;var c9=c5.get(aC);var A=c5.get(cA);var c6=aq.clone(A);c6.setHours(24,0,0);var c7=aq.getMinutesOffset(c3.limitDate(c9,c6),A);c5.get(c2).item(0).set(cs,c3.calculateEventHeight(c7));var c4=c5.get(c2).item(1);if(c4.inDoc()){var c8=aq.getMinutesOffset(c9,aq.toMidnight(c5.getClearEndDate()));c4.set(cs,c3.calculateEventHeight(c8));}},syncEventTopUI:function(c3){var A=this;c3.get(c2).item(0).setStyle(bK,A.calculateTop(c3.get(cA))+ai);c3.get(c2).item(1).setStyle(bK,0);},calculateYDelta:function(c4,c3){var A=this;
return(c3[1]-c4[1])/(A.get(aF)/2)*30;},findEventIntersections:function(c3,c4){var A=this;var c5=[];cw.Array.each(c4,function(c6){if(!c3._filtered&&c3.intersectHours(c6)){c5.push(c6);}});return c5;},getXYDelta:function(c3){var A=this;var c4=c3.currentTarget.getXY(),c5=[c3.pageX,c3.pageY];return cw.Array.map(c4,function(c7,c6){return(c5[c6]-c7);});},getTickY:function(){var A=this;return cb(Math.ceil(A.get(aF)/2),10);},roundToNearestHour:function(c3,c4){var A=this;c3.setHours(c4[0],cb(c4[1],A.getTickY()),c4[2]);},_afterDragAlign:function(c4){var c3=this;var A=c4.target;if(!c3[V]){c3[V]=A.actXY;}A.actXY[0]=null;},_dragTickAlignX:function(c4){var c3=this;var c7=c3[E];if(c7&&!c3[ca]){var c5=c3[b4];var c6=b8(c4.attr(t))-c3.startColNumber;c3.draggingEventStartDate=aq.add(c7.get(cA),aq.DAY,c6);var A=aq.clone(c3.draggingEventStartDate);aq.copyHours(A,c5.get(cA));c5.move(A);c3.plotEvent(c5);}},_dragTickAlignY:function(A){var c8=this;var c3=c8.get(p);var da=c3.get(c0);var c5=c8[E];if(c5){var c9=A.target.get(aW);var c6=c8[b4];var c7=c8.calculateYDelta(c8[V],c9.actXY);if(c8[ca]){var c4=aq.add(c8.draggingEventEndDate,aq.MINUTES,c7);if(aq.getMinutesOffset(c4,c8.draggingEventStartDate)<=da.get(ck)){return;}c6.set(aC,c4);}else{c6.move(aq.add(c8.draggingEventStartDate,aq.MINUTES,c7));}c8.plotEvent(c6);}},_setupDragDrop:function(){var c3=this;if(!c3[b4]){var c4=c3.get(p);c3[b4]=new (c3.get(cT))({scheduler:c4});c3[b4].removeTarget(c4);c3[b4].get(c2).addClass(ci).hide();}if(!c3.delegate){c3.delegate=new cw.DD.Delegate(c3.get(z));}var A=c3.delegate.dd;A.unplug(cw.Plugin.DDConstrained);A.unplug(cw.Plugin.DDNodeScroll);var c5=c3.bodyNode.get(ae);c5.bottom=Infinity;c5.top=-Infinity;A.plug(cw.Plugin.DDConstrained,{bubbleTargets:c3,constrain:c5,stickY:true,tickY:c3.get(aF)/2});A.plug(cw.Plugin.DDNodeScroll,{node:c3.bodyNode,scrollDelay:150});},_uiSetCurrentDate:function(c3){var A=this;A.syncColumnsUI();A.syncDaysHeaderUI();},_onClickDaysHeader:function(c5){var A=this;var c4=A.get(p);if(c5.target.test(k)){var c6=c4.getViewByName(cH);if(c6){var c3=b8(c5.currentTarget.attr(t));c4.set(br,A.getDateByColumn(c3));c4.set(b7,c6);}}c5.preventDefault();},_onEventDragEnd:function(c3){var A=this;var c5=A[E];if(c5){var c4=A[b4];c4.set(ax,false);c5.set(ax,true);c5.copyDates(c4);A.get(p).syncEventsUI();}A[V]=null;A[E]=null;},_onEventDragStart:function(c4){var A=this;var c6=A[E]=A.delegate.dd.get(c2).getData(aE);if(c6){var c5=A[b4];c5.copyPropagateAttrValues(c6);A.plotEvent(c5);c6.set(ax,false);A.draggingEventStartDate=aq.clone(c6.get(cA));A.draggingEventEndDate=aq.clone(c6.get(aC));var c3=A.getColumnByDate(c6.get(cA));A.startColNumber=c3?b8(c3.attr(t)):0;}},_onMouseDownTableCol:function(c3){var c8=this;var c7=c3.target;var c5=c8.get(p);var c9=c5.get(c0);if(c9&&!c5.get(b5)){c9.hideOverlay();if(c7.test(cf+aD)){c8[V]=[c3.pageX,c3.pageY];var da=b8(c3.currentTarget.attr(t));var c4=c8.getDateByColumn(da);var A=c8.getXYDelta(c3);c8.roundToNearestHour(c4,c8.getYCoordTime(A[1]));var c6=aq.add(c4,aq.MINUTES,c9.get(ck));c9.move(c4);c9.set(M,false);c9.set(aC,c6);c8[Z]=c4;c8[bk]=c6;c3.halt();}else{if(c7.test([cf+ch,cf+aO].join(bC))){c8[ca]=true;}}}c8.get(aX).unselectable();},_onMouseEnterEvent:function(c3){var A=this;var c4=c3.currentTarget;A[cm].appendTo(c4);},_onMouseLeaveEvent:function(c3){var A=this;if(!A[ca]){A._removeResizer();}},_onMouseMoveTableCol:function(c6){var A=this;var c5=c6.currentTarget;var c3=A.get(p).get(c0);if(A[bl]!==c5){A[bl]=c5;A._dragTickAlignX(A[bl]);}var c4=A[bk];var c7=A[Z];if(c7){var c8=cb(A.calculateYDelta(A[V],[c6.pageX,c6.pageY]),A.getTickY());if(A._delta!==c8){if(c8>0){c3.set(aC,aq.add(c4,aq.MINUTES,c8));}else{c3.set(cA,aq.add(c7,aq.MINUTES,c8));}A.plotEvent(c3);A._delta=c8;}}},_onMouseUpTableCol:function(c5){var A=this;var c4=A.get(p);var c3=c4.get(c0);if(c3&&!c4.get(b5)){if(A[Z]){A.plotEvent(c3);c3.showOverlay();}}A[Z]=null;A[bk]=null;A[ca]=false;A[V]=null;A._removeResizer();A.get(aX).selectable();},_onSchedulerChange:function(c3){var A=this;if(A[bb]){A[bb].set(p,c3.newVal);}},_removeResizer:function(){var A=this;A[cm].remove();},_valueColDaysNode:function(){var A=this;var c5=A.get(S);var c3=[],c4=0;while(c5--){c3.push(cw.Lang.sub(bt,{colNumber:c4++}));}return cw.NodeList.create(c3.join(b6));},_valueColHeaderDaysNode:function(){var A=this;var c5=A.get(S);var c3=[],c4=0;c3.push(au);while(c5--){c3.push(cw.Lang.sub(bw,{colNumber:c4++}));}c3.push(u);return cw.NodeList.create(c3.join(b6));},_valueMarkercellsNode:function(){var A=this;var c3=[],c4;for(c4=0;c4<=23;c4++){c3.push(af);}return cw.NodeList.create(c3.join(b6));},_valueTimesNode:function(){var A=this;var c5=A.get(al);var c4=[],c3;for(c3=0;c3<=23;c3++){c4.push(b2(j,{hour:c5?aq.toIsoTimeString(c3):aq.toUsTimeString(c3,false,true)}));}return cw.NodeList.create(c4.join(b6));}}});cw.SchedulerDayView=cW;var an=cw.Component.create({NAME:cB,ATTRS:{bodyContent:{value:b6},days:{value:7},headerViewConfig:{value:{displayDaysInterval:aP}},name:{value:cN}},EXTENDS:cw.SchedulerDayView,prototype:{adjustCurrentDate:function(){var A=this;var c5=A.get(p);var c3=c5.get(br);var c4=c5.get(cC);c5.set(br,aq.getFirstDayOfWeek(c3,c4));},getNextDate:function(){var A=this;var c4=A.get(p);var c3=c4.get(br);var c5=A._firstDayOfWeek(c3);return aq.add(c5,aq.WEEK,1);},getPrevDate:function(){var A=this;var c4=A.get(p);var c3=c4.get(br);var c5=A._firstDayOfWeek(c3);return aq.subtract(c5,aq.WEEK,1);},getToday:function(){var A=this;var c3=an.superclass.getToday.apply(this,arguments);return A._firstDayOfWeek(c3);},_firstDayOfWeek:function(c4){var A=this;var c5=A.get(p);var c3=c5.get(cC);return aq.getFirstDayOfWeek(c4,c3);}}});cw.SchedulerWeekView=an;var h=C(s),l=C(s,"arrowstop-1-l"),cP=C(s,"arrowstop-1-r"),o=C(cd,a0,a),aS=C(cd,a0,a,aJ),at=C(cd,a0,a,am),bu=C(cd,a0,aT),ap=C(cd,a0,ct,ah),cL=C(cd,a0,ct,cH),c=C(cd,a0,ct,a0),D=C(cd,a0,a3),cv=C(cd,a0,bJ),bT=C(cd,a0,bJ,aT),bd=C(cd,a0,bS),cp=C(cd,a0,bS,ah),bN=C(cd,a0,bS,ah,i),cn=C(cd,a0,bS,ah,i,ab),bX=C(cd,a0,bS,ah,i,aJ),cS=C(cd,a0,bS,ah,i,aR),by=C(cd,a0,bS,ah,i,am),aA=C(cd,a0,bS,bf),b=C(cd,a0,bS,bf,aY),cy=C(cd,a0,bS,bf,co),ag=C(cd,a0,bS,bf,ba),aa=C(cd,a0,bS,aJ),aG=C(cd,a0,bn),bZ=C(cd,a0,bn,aJ),aV='<div class="'+bu+'">'+'<div class="'+bT+'"></div>'+"</div>",ce='<td class="'+o+'">&nbsp;</td>',f='<th class="'+cL+'"><div>&nbsp;</div></th>',T='<table cellspacing="0" cellpadding="0" class="'+c+'">'+"<tbody>"+'<tr class="'+ap+'"></tr>'+"</tbody>"+"</table>",bL='<div class="'+D+'"></div>',bq='<div class="'+cv+'" style="top: {top}%; height: {height}%;"></div>',bv='<table cellspacing="0" cellpadding="0" class="'+bd+'">'+"<tbody></tbody>"+"</table>",a4='<table cellspacing="0" cellpadding="0" class="'+aG+'">'+"<tbody>"+"<tr></tr>"+"</tbody>"+"</table>",N='<span class="'+[h,l].join(U)+'"></span>',bj='<span class="'+[h,cP].join(U)+'"></span>',bo='<td class="'+cp+'"><div></div></td>',cI="<tr></tr>";
var a6=cw.Component.create({NAME:b3,ATTRS:{bodyContent:{value:b6},displayDaysInterval:{value:42},displayRows:{value:4},fixedHeight:{value:true},name:{value:a0},headerDateFormat:{value:"%a"},navigationDateFormat:{value:"%b %Y"},scrollable:{value:false},headerTableNode:{valueFn:function(){return cw.Node.create(T);}},colHeaderDaysNode:{valueFn:"_valueColHeaderDaysNode"},rowsContainerNode:{valueFn:function(){return cw.Node.create(aV);}},tableGridNode:{valueFn:"_valueTableGridNode"}},HTML_PARSER:{colHeaderDaysNode:L(cf+cL,7),headerTableNode:cf+c,rowsContainerNode:cf+bu,tableGridNode:L(cf+aG,7)},EXTENDS:cw.SchedulerView,prototype:{evtDateStack:null,evtDataTableStack:null,initializer:function(){var A=this;A.evtDateStack={};A.evtDataTableStack={};A[cz]=A.get(cz);A[cX]=A.get(cX);A[bI]=A.get(bI);A[y]=A.get(y);A[a5]=A.headerTableNode.one(cf+ap);A[aU]=cw.NodeList.create();A[b1]=A[bI].one(cf+bT);A[cQ]=cw.NodeList.create();},bindUI:function(){var A=this;var c3=A.get(p).get(c0);c3.on({cancel:cw.bind(A.removeLasso,A),save:cw.bind(A.removeLasso,A)});A[bI].on({mousedown:cw.bind(A._onMouseDownGrid,A),mousemove:cw.bind(A._onMouseMoveGrid,A),mouseup:cw.bind(A._onMouseUpGrid,A)});},renderUI:function(){var c3=this;var c6=c3.get(a2);var c4=Math.ceil(c6/aP);var c8=100/c4;for(var c5=0;c5<c4;c5++){var A=c3._getTableGridNode(c5);var c7=cw.Node.create(cK.sub(bq,{height:c8,top:c8*c5}));c7.append(A.toggleClass(bZ,(c5===0)));c3[cQ].push(c7);}c3[cz].appendTo(c3[a5]);c3[cQ].appendTo(c3[b1]);},buildEventsTable:function(c3,c7){var df=this;var c8=df.get(a2);var dc=df.get("displayRows");var dg=df.get(cq);var de=aq.clearTime(df._findCurrentIntervalEnd());var db=aq.clearTime(df._findCurrentIntervalStart());var da=String(db.getTime()).concat(c3.getTime()).concat(c7.getTime());var c9=df.evtDataTableStack[da];if(!c9){c9=cw.Node.create(bv);var dd=c9.one(bO);var c5=cw.Node.create(cI);df.loopDates(c3,c7,function(di,dh){var dj=cw.Node.create(bo);dj.addClass(bN).toggleClass(bX,(dh===0)).toggleClass(by,aq.isToday(di)).toggleClass(cS,aq.isToday(aq.subtract(di,aq.DAY,1))).toggleClass(cn,aq.isToday(aq.subtract(di,aq.WEEK,1)));c5.append(dj.setContent(di.getDate()));});dd.append(c5);var A;for(A=0;A<dc;A++){var c6=0;var c4=cw.Node.create(cI);df.loopDates(c3,c7,function(dt,dn){if(c6<=dn){var du=df.getIntersectEvents(dt),dr=du[A];var dk=cw.Node.create(bo);if(dr&&dg.apply(df,[dr])){var di=dr.get(cA);var dp=!aq.isDayOverlap(di,dt);var dq=aq.after(dt,di)&&!aq.isDayOverlap(dt,c3);if(dp||dq){var dj=dr.get(c2);var dl=aq.getFirstDayOfWeek(new Date(Math.max(di,db)));var ds=Math.floor(aq.getDayOffset(dt,dl)/aP);if(dj.size()<=ds){dr.addPaddingNode();}var dm=dj.item(ds);dm.setStyles({height:"auto",left:0,top:0,width:"auto"});dr.syncNodeUI();var dh=dk.one(X);dm.appendTo(dh);var dv=df._getEvtSplitInfo(dr,dt,c3,c7);dk.attr(W,dv.colspan);dh.addClass(aA);if(dv.left){dh.addClass(b).prepend(N);}if(dv.right){dh.addClass(ag).append(bj);}if(dr.get(cM)){dh.addClass(cy);}c6+=dv.colspan;}else{c6++;}}else{c6++;}c4.append(dk);}});dd.append(c4);}df.evtDataTableStack[da]=c9;}return c9;},flushViewCache:function(){var A=this;A.evtDateStack={};A.evtDataTableStack={};},getIntersectEvents:function(c3){var A=this;var c5=A.get(p);var c4=String(c3.getTime());if(!A.evtDateStack[c4]){A.evtDateStack[c4]=c5.getIntersectEvents(c3);}return A.evtDateStack[c4];},getNextDate:function(){var A=this;var c5=A.get(p);var c3=c5.get(br);var c4=A.get(a2);return aq.add(c3,aq.DAY,c4);},getPrevDate:function(){var A=this;var c5=A.get(p);var c3=c5.get(br);var c4=A.get(a2);return aq.subtract(c3,aq.DAY,c4);},loopDates:function(A,c5,c8,c9,c7){var da=this;var c3=aq.clone(A);var c4=c5.getTime(),c6;for(c6=0;c3.getTime()<=c4;c6++){c8.apply(da,[c3,c6]);c3=aq.add(c3,(c9||aq.DAY),(c7||1));}},plotEvents:function(){var c3=this;var c6=c3._findCurrentIntervalStart();var A=aq.safeClearTime(c6);c3.flushViewCache();c3.bodyNode.all(cf+bd).remove();var c4=c3.get(a2);var c5=Math.min(c4,aP);c3[cQ].each(function(da,c8){var c7=aq.add(A,aq.DAY,c5*c8);var db=aq.add(c7,aq.DAY,c5-1);var c9=c3.buildEventsTable(c7,db);if(c8===0){c9.addClass(aa);}da.append(c9);});},removeLasso:function(){var A=this;if(A.lasso){A.lasso.remove();}},renderLasso:function(c9,c3){var df=this;var c6=c9;var c8=c3;if(c9[1]>c3[1]){c6=c3;c8=c9;}var dg=c6[0],db=c6[1],c4=c8[0],A=c8[1];df.removeLasso();df.lasso=cw.NodeList.create();for(var c5=db;c5<=A;c5++){var c7=df.gridCellHeight,de=df.gridCellWidth,dc=0,da=(c7*c5);if(c5===db){if(db===A){dc+=Math.min(dg,c4)*de;de*=Math.abs(c4-dg)+1;}else{dc+=dg*de;de*=aP-dg;}}else{if(c5===A){de*=c4+1;}else{de*=aP;}}var dd=cw.Node.create(bL);df.lasso.push(dd);df[bI].append(dd);dd.sizeTo(de,c7);dd.setXY(df._offsetXY([dc,da],1));}},syncDaysHeaderUI:function(){var c4=this;var c7=c4.get(p);var c5=c7.get(br);var c3=c4.get(bp);var A=c4.get(az);var c6=c4._findFirstDayOfWeek(c5);c4.colHeaderDaysNode.all(X).each(function(da,c9){var c8=aq.add(c6,aq.DAY,c9);var db=cw.DataType.Date.format(c8,{format:c3,locale:A});da.html(db);});},syncGridUI:function(){var dc=this;var c6=dc.getToday();var c3=dc.get(p);dc[aU].removeClass(at);var c5=dc._findCurrentIntervalStart();var c8=dc._findCurrentIntervalEnd();if(aq.between(c6,c5,c8)){var A=c3.get(cC);var da=dc._findFirstDayOfWeek(c6);var c7=aq.getWeekNumber(c6,A)-aq.getWeekNumber(c5,A);var db=(c6.getDate()-da.getDate());var c4=dc._getCellIndex([db,c7]);var c9=dc[aU].item(c4);if(c9){c9.addClass(at);}}},syncStdContent:function(){var A=this;A.setStdModContent(cr.BODY,A[bI].getDOM());A.setStdModContent(cr.HEADER,A[cX].getDOM());},_findCurrentIntervalEnd:function(){var A=this;var c5=A.get(p);var c3=c5.get(br);var c4=A.get(a2);return aq.add(c3,aq.DAY,c4);},_findCurrentIntervalStart:function(){var A=this;var c3=A.get(p);return c3.get(br);},_findFirstDayOfWeek:function(c4){var A=this;var c5=A.get(p);var c3=c5.get(cC);return aq.getFirstDayOfWeek(c4,c3);},_getCellIndex:function(c3){var A=this;return c3[1]*aP+c3[0];},_getEvtLabel:function(c4){var c3=this;var c5=c4.get(aC);var A=c4.get(cA);return[A.getHours(),b9,c5.getHours(),U,c4.get(aQ)].join(b6);
},_getEvtSplitInfo:function(c7,da,A,c5){var c8=this;var c3=c7.getClearStartDate();var c6=c7.getClearEndDate();var c9=aq.getDayOffset(c5,da);var c4={colspan:Math.min(aq.getDayOffset(c6,da),c9)+1,left:aq.before(c3,A),right:aq.after(c6,c5)};return c4;},_getPositionDate:function(c4){var c3=this;var c5=c3._findCurrentIntervalStart();var A=aq.safeClearTime(c3._findFirstDayOfWeek(c5));return aq.add(A,aq.DAY,c3._getCellIndex(c4));},_getTableGridNode:function(c7){var A=this;var c4=A.get(a2);var c6=A[y].item(c7);for(var c3=0;c3<Math.min(c4,aP);c3++){var c5=cw.Node.create(ce);c6.append(c5);A[aU].push(c5);}return c6;},_offsetXY:function(c5,c4){var A=this;var c3=A[bI].getXY();return[c5[0]+c3[0]*c4,c5[1]+c3[1]*c4];},_onMouseDownGrid:function(c7){var A=this;var c8=c7.target;if(c8.test([cf+o,cf+cp].join(bC))){A._recording=true;var c5=A.get(a2);var c3=Math.ceil(c5/aP);var c6=Math.min(c5,aP);A.gridCellHeight=A[bI].get(cs)/c3;A.gridCellWidth=A[bI].get(cu)/c6;var c4=A._offsetXY([c7.pageX,c7.pageY],-1);A.lassoStartPosition=A.lassoLastPosition=A._findPosition(c4);A.renderLasso(A.lassoStartPosition,A.lassoLastPosition);A[bI].unselectable();}},_onMouseMoveGrid:function(c6){var c3=this;var c7=c6.currentTarget;var c4=c3._offsetXY([c6.pageX,c6.pageY],-1);var c5=c3.lassoLastPosition||c3.lassoStartPosition;var A=c3._findPosition(c4);var c8=c5&&((A[0]!==c5[0])||(A[1]!==c5[1]));if(c8&&c3._recording){c3.lassoLastPosition=A;c3.renderLasso(c3.lassoStartPosition,A);}},_onMouseUpGrid:function(c8){var c3=this;var c7=c3.get(p);var c5=c7.get(c0);if(c5&&c3._recording&&!c7.get(b5)){var c6=c3._getPositionDate(c3.lassoStartPosition);var c4=c3._getPositionDate(c3.lassoLastPosition);var A=new Date(Math.min(c6,c4));A.setHours(0,0,0);var c9=new Date(Math.max(c6,c4));c9.setHours(23,59,59);c5.set(M,true);c5.set(aC,c9);c5.set(cA,A);c5.showOverlay([c8.pageX,c8.pageY]);c3._recording=false;}},_findPosition:function(c5){var A=this;var c4=Math.floor(c5[0]/A.gridCellWidth);var c3=Math.floor(c5[1]/A.gridCellHeight);return[c4,c3];},_uiSetCurrentDate:function(c3){var A=this;A.syncDaysHeaderUI();A.syncGridUI();},_valueColHeaderDaysNode:function(){var A=this;var c3=A.get(a2);var c4=Math.min(c3,aP);return A._valueNodeList(c4,f);},_valueTableGridNode:function(){var A=this;var c3=A.get(a2);var c4=Math.min(c3,aP);return A._valueNodeList(c4,a4);},_valueNodeList:function(c5,c4){var A=this;var c3=[];while(c5--){c3.push(c4);}return cw.NodeList.create(c3.join(b6));}}});cw.SchedulerTableView=a6;var bc=C(cR,a0,bS,ah,ak);var aB=cw.Component.create({NAME:cR,ATTRS:{displayDaysInterval:{readOnly:true,value:42},name:{value:b0}},EXTENDS:cw.SchedulerTableView,prototype:{getNextDate:function(){var A=this;var c4=A.get(p);var c3=c4.get(br);return aq.add(c3,aq.MONTH,1);},getPrevDate:function(){var A=this;var c4=A.get(p);var c3=c4.get(br);return aq.subtract(c3,aq.MONTH,1);},plotEvents:function(){var A=this;cw.SchedulerMonthView.superclass.plotEvents.apply(A,arguments);var c4=A.get(p);var c3=c4.get(br);var c7=aq.findMonthEnd(c3);var c6=aq.findMonthStart(c3);var c5=A._findCurrentIntervalStart();var c8=A[b1].all(cf+bN);c8.each(function(db,c9){var da=aq.add(c5,aq.DAY,c9);if(aq.before(da,c6)||aq.after(da,c7)){db.addClass(bc);}});},_findCurrentIntervalStart:function(){var A=this;var c5=A.get(p);var c3=c5.get(br);var c4=aq.findMonthStart(c3);return A._findFirstDayOfWeek(c4);},_findFirstDayOfWeek:function(c4){var A=this;var c5=A.get(p);var c3=c5.get(cC);return aq.getFirstDayOfWeek(c4,c3);}}});cw.SchedulerMonthView=aB;},"@VERSION@",{skinnable:true,requires:["aui-scheduler-event","aui-calendar","aui-button-item","dd-drag","dd-delegate","dd-drop","dd-constrain"]});AUI.add("aui-scheduler-event",function(aL){var ao=aL.Lang,bk=ao.isString,f=ao.isDate,ba=ao.isFunction,G=ao.isObject,bd=ao.isBoolean,ae=ao.isNumber,aZ=aL.ColorUtil,j=aL.DataType.DateMath,a6=aL.cached(function(A){return A.substring(0,1).toUpperCase()+A.substring(1);}),bf="-",t="&ndash;",az=".",p="",q=" ",l="_",aN="_propagateSet",Q="activeView",T="borderColor",aP="borderColorRGB",aJ="borderStyle",br="borderWidth",I="Change",a4="color",aX="colorBrightnessFactor",be="colorSaturationFactor",aH="content",w="disabled",a1="duration",aQ="endDate",aT="eventClass",ar="eventStack",bl="events",av="hidden",H="hsbColor",au="icon",ab="icons",a2="id",aY="isoTime",bq="locale",a0="never",n="node",h="overlay",aM="parentEvent",bw="recorder",aO="repeat",bj="repeated",P="repeatedEvents",bc="repeater",ah="scheduler",aw="scheduler-event",ay="scheduler-event-recorder",bn="startDate",a8="template",aW="title",e="titleDateFormat",ap="visible",d="%H:%M",a7="%I:%M",E=aL.getClassName,k=E(au),s=E(aw),aR=E(aw,aH),C=E(aw,av),bh=E(aw,w),aq=E(aw,bw),aC=E(aw,bj),an=E(aw,bc),D=E(aw,aW),bp=E(aw,ab),v=E(aw,au,w),b=E(aw,au,bj),bt=E(aw,au,bc);var V=aL.Component.create({NAME:aw,ATTRS:{allDay:{value:false,validator:bd},borderStyle:{value:"solid",validator:bk},borderWidth:{value:"1px",validator:bk},colorBrightnessFactor:{value:0.75,validator:ae},colorSaturationFactor:{value:1.5,validator:ae},content:{value:"(no title)",validator:bk},color:{lazyAdd:false,setter:"_setColor",value:"#D96666",validator:bk},titleDateFormat:{getter:"_getTitleDateFormat",validator:bk},endDate:{setter:"_setDate",valueFn:function(){var A=j.clone(this.get(bn));A.setHours(A.getHours()+1);return A;}},eventClass:{valueFn:function(){return aL.SchedulerEvent;}},disabled:{value:false,validator:bd},node:{valueFn:function(){return aL.NodeList.create(aL.Node.create(this.EVENT_NODE_TEMPLATE).setData(aw,this));}},parentEvent:{},repeat:{value:p,setter:"_setRepeat"},scheduler:{lazyAdd:false,setter:"_setScheduler"},startDate:{setter:"_setDate",valueFn:function(){return new Date();}},visible:{value:true,validator:bd}},EXTENDS:aL.Base,PROPAGATE_ATTRS:[bn,aQ,aH,a4,aX,be,aJ,br,e,ap,w],prototype:{EVENT_NODE_TEMPLATE:'<div class="'+s+'">'+'<div class="'+D+'"></div>'+'<div class="'+aR+'"></div>'+'<div class="'+bp+'">'+'<span class="'+[k,b].join(q)+'"></span>'+'<span class="'+[k,bt].join(q)+'"></span>'+'<span class="'+[k,v].join(q)+'"></span>'+"</div>"+"</div>",eventStack:null,initializer:function(){var A=this;
var L=A.get(n);A[ar]={};aL.Array.each(A.get(aT).PROPAGATE_ATTRS,function(X){A.after(X+I,A._propagateAttrChange);});A._bindUIAttrs();A.syncNodeUI(true);},destroy:function(){var A=this;A.eachRepeatedEvent(function(L,X){L.destroy();});A[ar]={};A.get(n).remove(true);},addPaddingNode:function(){var A=this;A.get(n).push(aL.Node.create(A.EVENT_NODE_TEMPLATE).setData(aw,A));A.syncNodeUI();},copyDates:function(L){var A=this;A.set(aQ,j.clone(L.get(aQ)));A.set(bn,j.clone(L.get(bn)));},copyPropagateAttrValues:function(L,X){var A=this;A.copyDates(L);aL.Array.each(A.get(aT).PROPAGATE_ATTRS,function(Y){if(!((X||{}).hasOwnProperty(Y))){var bB=L.get(Y);if(!G(bB)){A.set(Y,bB);}}});},getBorderColor:function(){var A=this;return A[aP].hex;},getDaysDuration:function(){var A=this;return j.getDayOffset(A.get(aQ),A.get(bn));},getHoursDuration:function(){var A=this;return j.getHoursOffset(A.get(aQ),A.get(bn));},getMinutesDuration:function(){var A=this;return j.getMinutesOffset(A.get(aQ),A.get(bn));},getSecondsDuration:function(){var A=this;return j.getSecondsOffset(A.get(aQ),A.get(bn));},sameEndDate:function(L){var A=this;return j.compare(A.get(aQ),L.get(aQ));},sameStartDate:function(L){var A=this;return j.compare(A.get(bn),L.get(bn));},isAfter:function(Y){var X=this;var L=X.get(bn);var A=Y.get(bn);return j.after(L,A);},isBefore:function(Y){var X=this;var L=X.get(bn);var A=Y.get(bn);return j.before(L,A);},repeatByDate:function(X){var L=this;var Y=L.uidByDate(X);if(!L[ar][Y]){var A=j.clone(X);var bC=j.clone(X);j.copyHours(A,L.get(bn));j.copyHours(bC,L.get(aQ));var bB=new L.get(aT)({endDate:bC,parentEvent:L,scheduler:L.get(ah),startDate:A});bB.copyPropagateAttrValues(L);L[ar][Y]=bB;}return L[ar][Y];},intersects:function(Y){var X=this;var bB=X.get(aQ);var L=X.get(bn);var A=Y.get(bn);return(X.sameStartDate(Y)||j.between(A,L,bB));},intersectHours:function(X){var L=this;var bB=L.get(aQ);var A=L.get(bn);var Y=j.clone(A);j.copyHours(Y,X.get(bn));return(j.compare(A,Y)||j.between(Y,A,bB));},isDayBoundaryEvent:function(){var A=this;return j.isDayBoundary(A.get(bn),A.get(aQ));},isDayOverlapEvent:function(){var A=this;return j.isDayOverlap(A.get(bn),A.get(aQ));},isRepeatableDate:function(L){var A=this;var X=A.get(aO);return(X&&X.validate(A,L));},getClearEndDate:function(){var A=this;return j.safeClearTime(A.get(aQ));},getClearStartDate:function(){var A=this;return j.safeClearTime(A.get(bn));},move:function(L){var A=this;var X=A.getMinutesDuration();A.set(bn,L);A.set(aQ,j.add(j.clone(L),j.MINUTES,X));},uidByDate:function(L){var A=this;L=f(L)?j.safeClearTime(L):A.getClearStartDate();return[aw,L.getTime()].join(l);},setContent:function(X,L){var A=this;A.get(n).each(function(bB){var Y=bB.one(g+aR);Y.setContent(X);});if(L){A.eachRepeatedEvent(function(Y,bB){Y.setContent(X);});}},setTitle:function(X,L){var A=this;A.get(n).each(function(Y){var bB=Y.one(g+D);bB.setContent(X);});if(L){A.eachRepeatedEvent(function(Y,bB){Y.setTitle(X);});}},syncNodeUI:function(L){var A=this;A._syncUIAttrs();A.syncNodeColorUI(L);A.syncNodeTitleUI(L);A.syncNodeContentUI(L);},syncNodeColorUI:function(L){var A=this;var Y=A.get(n);var bB=A.getBorderColor();if(Y){var X={borderWidth:A.get(br),borderColor:bB,backgroundColor:A.get(a4),borderStyle:A.get(aJ)};Y.setStyles(X);}if(L){A.eachRepeatedEvent(function(bC,bD){bC.syncNodeColorUI();});}},syncNodeContentUI:function(L){var A=this;A.setContent(A.get(aH),L);},syncNodeTitleUI:function(L){var A=this;var Y=A._formatDate(A.get(bn));var X=A._formatDate(A.get(aQ));A.setTitle([Y,X].join(q+t+q),L);},split:function(){var A=this,X=j.clone(A.get(bn)),Y=j.clone(A.get(aQ));if(A.isDayOverlapEvent()&&!A.isDayBoundaryEvent()){var L=j.clone(X);L.setHours(24,0,0,0);return[[X,j.toMidnight(j.clone(X))],[L,j.clone(Y)]];}return[[X,Y]];},eachRepeatedEvent:function(L){var A=this;aL.each(A[ar],L,A);},unlink:function(){var A=this;if(A.get(aM)){A.set(aM,null);}else{A.eachRepeatedEvent(function(L,X){L.unlink();});}A[ar]={};A.syncNodeUI();},_afterDisabledChange:function(L){var A=this;A._uiSetDisabled(L.newVal);},_afterVisibleChange:function(L){var A=this;A._uiSetVisible(L.newVal);},_afterRepeatChange:function(L){var A=this;A._uiSetRepeat(L.newVal);},_afterParentEventChange:function(L){var A=this;A._uiSetParentEvent(L.newVal);},_bindUIAttrs:function(){var A=this;A.after({disabledChange:A._afterDisabledChange,visibleChange:A._afterVisibleChange,parentEventChange:A._afterParentEventChange,repeatChange:A._afterRepeatChange});A._syncUIAttrs();},_propagateAttrChange:function(Y){var A=this;var X=Y.attrName;var L=Y.newVal;A.eachRepeatedEvent(function(bB,bC){var bD=bB[aN+a6(X)];if(bD){bD.apply(A,[bB,X,L]);}else{bB.set(X,Y.newVal);}bB.syncNodeUI();});A.syncNodeUI();},_propagateSetEndDate:function(A,L,Y){var X=j.clone(A.get(aQ));j.copyHours(X,Y);A.set(aQ,X);},_propagateSetStartDate:function(L,X,Y){var A=j.clone(L.get(bn));j.copyHours(A,Y);L.set(bn,A);},_setColor:function(L){var A=this;A[H]=aZ.rgb2hsb(aZ.getRGB(L));A[T]=aL.clone(A[H]);A[T].b*=A.get(aX);A[T].s*=A.get(be);A[aP]=aZ.hsb2rgb(A[T]);return L;},_setDate:function(L){var A=this;if(ae(L)){L=new Date(L);}return L;},_setRepeat:function(L){var A=this;if(bk(L)){L=aL.SchedulerEventRepeat[L];}return G(L)?L:null;},_setScheduler:function(X){var A=this;var L=A.get(ah);if(L){A.removeTarget(L);}A.addTarget(X);return X;},_syncUIAttrs:function(){var A=this;A._uiSetDisabled(A.get(w));A._uiSetVisible(A.get(ap));A._uiSetParentEvent(A.get(aM));A._uiSetRepeat(A.get(aO));},_formatDate:function(X,Y){var L=this;var A=L.get(bq);Y=Y||L.get(e);return aL.DataType.Date.format(X,{format:Y,locale:A});},_getTitleDateFormat:function(X){var A=this;if(!bk(X)){var L=A.get(ah);X=(L&&L.get(Q).get(aY))?d:a7;}return X;},_uiSetDisabled:function(L){var A=this;A.get(n).toggleClass(bh,!!L);},_uiSetParentEvent:function(L){var A=this;A.get(n).toggleClass(aC,!!L);},_uiSetRepeat:function(X){var A=this;var L=!!X&&X!==aL.SchedulerEventRepeat[a0];A.get(n).toggleClass(an,L);},_uiSetVisible:function(L){var A=this;A.get(n).toggleClass(C,!L);}}});aL.SchedulerEvent=V;
aL.SchedulerEventRepeat={never:{description:"Never repeat",validate:function(A,L){return false;},value:"never"},daily:{description:"Every day",validate:function(A,L){return true;},value:"daily"},monthly:{description:"Every month",validate:function(L,X){var Y=L.get(aQ);var A=L.get(bn);return(A.getDate()===X.getDate());},value:"monthly"},monWedFri:{description:"Every Monday, Wednesday and Friday",validate:function(A,L){return j.isMonWedOrFri(L);},value:"monWedFri"},tuesThurs:{description:"Every Tuesday and Thursday",validate:function(A,L){return j.isTueOrThu(L);},value:"tuesThurs"},weekDays:{description:"Every week days",validate:function(A,L){return j.isWeekDay(L);},value:"weekDays"},weekly:{description:"Every week",validate:function(L,X){var Y=L.get(aQ);var A=L.get(bn);return(A.getDay()===X.getDay());},value:"weekly"},yearly:{description:"Every year",validate:function(L,X){var Y=L.get(aQ);var A=L.get(bn);return((A.getMonth()===X.getMonth())&&(A.getDay()===X.getDay()));},value:"yearly"}};var ax=aL.Lang,a=ax.isArray,G=ax.isObject,Q="activeView",J="allDay",c="arrow",aV="body",aB="bodyContent",o="boundingBox",aA="cancel",a3="click",aH="content",aU="date",aI="dateFormat",ak="delete",bb="description",R="edit",bv="event",aT="eventClass",B="footerContent",aF="form",z="header",u="hide",aY="isoTime",aG="link",n="node",O="offsetHeight",bi="offsetWidth",h="overlay",S="overlayOffset",bw="recorder",bs="rendered",aO="repeat",a5="save",ah="scheduler",m="schedulerChange",aw="scheduler-event",ay="scheduler-event-recorder",aE="shadow",aD="show",F="startDateChange",N="strings",a8="template",aW="title",bu="tl",ad="toolbar",bm="submit",bo="value",aS="visibleChange",aa="when",am="x",al="y",ag="cancel",M="delete",y="edit",aK="save",bx="-",g=".",af="",i="#",r=aL.IO.prototype._serialize,E=aL.getClassName,s=E(ah,bv),aq=E(ah,bv,bw),by=E(ah,bv,bw,h),x=E(ah,bv,bw,h,c),bg=E(ah,bv,bw,h,c,aE),aj=E(ah,bv,bw,h,aV),a9=E(ah,bv,bw,h,aH),ai=E(ah,bv,bw,h,aU),U=E(ah,bv,bw,h,aF),bA=E(ah,bv,bw,h,z),W=E(ah,bv,bw,h,aG),at=E(ah,bv,bw,h,aO),D=E(ah,bv,aW),K=new aL.Template('<div class="',bg," ",x,'"></div>','<div class="',x,'"></div>','<input type="hidden" name="startDate" value="{startDate}" />','<input type="hidden" name="endDate" value="{endDate}" />','<div class="',bA,'">','<input class="',a9,'" name="content" value="{content}" />',"</div>",'<div class="',aj,'">','<label class="',ai,'">{date}</label>','<select class="',at,'" name="repeat">','<tpl for="eventRepeat">','<option {[ (parent.repeat && parent.repeat.value) == parent.eventRepeat[$i].value ? \'selected="selected"\' : "" ]} value="{value}">{description}</option>',"</tpl>","</select>","</div>"),ac='<a class="'+W+'" href="javascript:;">{delete}</a>',bz='<form class="'+U+'" id="schedulerEventRecorderForm"></form>';var Z=aL.Component.create({NAME:ay,ATTRS:{allDay:{value:false},content:{value:af},duration:{value:60},dateFormat:{validator:bk,value:"%a, %B %d,"},event:{},eventClass:{valueFn:function(){return aL.SchedulerEvent;}},strings:{value:{},setter:function(A){return aL.merge({"delete":"Delete","description-hint":"e.g., Dinner at Brian's","no-repeat":"No repeat",cancel:"Cancel",description:"Description",edit:"Edit",repeat:"Repeat",save:"Save",when:"When"},A||{});},validator:G},overlay:{validator:G,value:{align:{points:[bu,bu]},visible:false,width:300,zIndex:500}},overlayOffset:{value:[15,-38],validator:a},template:{value:K},toolbar:{setter:function(X){var L=this;var A=L.get(N);return aL.merge({children:[{handler:aL.bind(L._handleSaveEvent,L),label:A[a5]},{handler:aL.bind(L._handleCancelEvent,L),label:A[aA]}]},X||{});},validator:G,value:{}}},EXTENDS:aL.SchedulerEvent,prototype:{initializer:function(){var A=this;A.get(n).addClass(aq);A.publish(ag,{defaultFn:A._defCancelEventFn});A.publish(M,{defaultFn:A._defDeleteEventFn});A.publish(y,{defaultFn:A._defEditEventFn});A.publish(aK,{defaultFn:A._defSaveEventFn});A.after(m,A._afterSchedulerChange);A[h]=new aL.Overlay(A.get(h));A[ad]=new aL.Toolbar(A.get(ad));},_afterSchedulerChange:function(Y){var A=this;var X=Y.newVal;var L=X.get(o);L.delegate(a3,aL.bind(A._onClickSchedulerEvent,A),g+s);},_defCancelEventFn:function(L){var A=this;A.get(n).remove();A.hideOverlay();},_defDeleteEventFn:function(X){var A=this;var L=A.get(ah);L.removeEvent(A.get(bv));A.hideOverlay();L.syncEventsUI();},_defEditEventFn:function(X){var A=this;var L=A.get(ah);A.hideOverlay();L.syncEventsUI();},_defSaveEventFn:function(X){var A=this;var L=A.get(ah);L.addEvent(X.newSchedulerEvent);A.hideOverlay();L.syncEventsUI();},_handleCancelEvent:function(L){var A=this;A.fire(ag);L.preventDefault();},_handleSaveEvent:function(L){var A=this;A.fire(A.get(bv)?y:aK,{newSchedulerEvent:A.getEventCopy()});L.preventDefault();},_onClickDelete:function(){var A=this;A.fire(M,{schedulerEvent:A.get(bv)});},_onClickSchedulerEvent:function(X){var A=this;var L=X.currentTarget.getData(aw);if(L){A.set(bv,L);A.showOverlay([X.pageX,X.pageY]);A.get(n).remove();}},_onOverlayVisibleChange:function(Y){var L=this;if(Y.newVal){L.populateForm();if(!L.get(bv)){var X=L[h].get(o);var A=X.one(g+a9);setTimeout(function(){A.selectText();},0);L.deleteNode.hide();}else{L.deleteNode.show();}}else{L.set(bv,null);L.get(n).remove();}},_onSubmitForm:function(L){var A=this;A._handleSaveEvent(L);},_renderOverlay:function(){var L=this;var A=L.get(N);L[h].render();L[ad].render();var X=L[h].get(o);X.addClass(by);L[h].set(B,L[ad].get(o));L[h].on(aS,aL.bind(L._onOverlayVisibleChange,L));L.deleteNode=aL.Node.create(ax.sub(ac,{"delete":A[ak]}));L[h].footerNode.append(L.deleteNode);L.formNode=aL.Node.create(bz);L[h].set(aB,L.formNode);L.deleteNode.on(a3,aL.bind(L._onClickDelete,L));L.formNode.on(bm,aL.bind(L._onSubmitForm,L));},getEventCopy:function(){var A=this;var X=A.get(bv);if(!X){X=new (A.get(aT))({allDay:A.get(J),endDate:A.get(aQ),scheduler:A.get(ah),startDate:A.get(bn)});X.copyPropagateAttrValues(A,{content:true});}var L=A.serializeForm();X.set(aH,L[aH]);X.set(aO,L[aO]);return X;},getFormattedDate:function(){var X=this;
var L=X.get(aI);var bB=(X.get(bv)||X);var bD=bB.get(aQ);var bC=bB.get(ah);var A=bB.get(bn);var Y=(bC.get(Q).get(aY)?j.toIsoTimeString:j.toUsTimeString);return[bB._formatDate(A,L),Y(A),bf,Y(bD)].join(q);},getTemplateData:function(){var L=this;var A=L.get(N);var X=(L.get(bv)||L);return{content:X.get(aH)||A["description-hint"],date:L.getFormattedDate(),endDate:X.get(aQ).getTime(),eventRepeat:L.eventRepeatArray,repeat:X.get(aO),startDate:X.get(bn).getTime()};},hideOverlay:function(){var A=this;A[h].hide();},populateForm:function(){var A=this;if(!A.eventRepeatArray){A.eventRepeatArray=[];aL.each(aL.SchedulerEventRepeat,function(L){A.eventRepeatArray.push({description:L[bb],value:L[bo]});});}A.formNode.setContent(A.get(a8).parse(A.getTemplateData()));},serializeForm:function(){var A=this;return aL.QueryString.parse(r(A.formNode.getDOM()));},showOverlay:function(Y,bC){var A=this;var X=A.get(S);if(!A[h].get(bs)){A._renderOverlay();}A[h].show();if(!Y){var L=(A.get(bv)||A).get(n);var bB=L.one(g+D);bC=[X[0]+bB.get(bi),X[1]+bB.get(O)/2];Y=bB.getXY();}bC=bC||X;Y[0]+=bC[0];Y[1]+=bC[1];A[h].set("xy",Y);}}});aL.SchedulerEventRecorder=Z;},"@VERSION@",{skinnable:true,requires:["aui-base","aui-color-util","aui-datatype","aui-template","aui-toolbar","io-form","querystring","overlay"]});AUI.add("aui-scheduler-calendar",function(d){var i=d.Lang,j=i.isArray,c=i.isBoolean,b=i.isString,g=function(n){return(n instanceof d.SchedulerEvent);},a="color",l="events",h="pallete",m="scheduler",e="scheduler-calendar",k="visible";var f=d.Component.create({NAME:e,ATTRS:{color:{valueFn:function(){var o=this;var p=o.get(h);var n=Math.ceil(Math.random()*p.length)-1;return p[n];},validator:b},name:{value:"(no name)",validator:b},pallete:{value:["#d96666","#e67399","#b373b3","#8c66d9","#668cb3","#668cd9","#59bfb3","#65ad89","#4cb052","#8cbf40","#bfbf4d","#e0c240","#f2a640","#e6804d","#be9494","#a992a9","#8997a5","#94a2be","#85aaa5","#a7a77d","#c4a883","#c7561e","#b5515d","#c244ab","#603f99","#536ca6","#3640ad","#3c995b","#5ca632","#7ec225","#a7b828","#cf9911","#d47f1e","#b56414","#914d14","#ab2671","#9643a5","#4585a3","#737373","#41a587","#d1bc36","#ad2d2d"],validator:j},scheduler:{lazyAdd:false,setter:"_setScheduler"},visible:{value:true,validator:c}},EXTENDS:d.Base,AUGMENTS:d.SchedulerEventSupport,prototype:{initializer:function(){var n=this;n.after("colorChange",n._afterColorChange);n.on("eventsChange",n._onEventsChange);n.on("visibleChange",n._onVisibleChange);n._uiSetVisible(n.get(k));n._uiSetEvents(n.get(l));},syncEventsColor:function(o){var n=this;d.Array.each(o||n.get(l),function(p){p.set(a,n.get(a));});},_afterColorChange:function(o){var n=this;n.syncEventsColor(n.get(l));},_onEventsChange:function(o){var n=this;var p=o.newVal;var q=n.get(k);d.Array.each(p,function(r){r.set(k,q);});n._uiSetEvents(p);},_onVisibleChange:function(o){var n=this;n._uiSetVisible(o.newVal);},_setScheduler:function(p){var n=this;var o=n.get(m);if(o){n.removeTarget(o);}n.addTarget(p);return p;},_uiSetEvents:function(p){var n=this;var o=n.get(m);n.syncEventsColor(p);if(o){o.removeEvents(n);o.addEvents(p);o.syncEventsUI();}},_uiSetVisible:function(o){var n=this;n.eachEvent(function(p){p.set(k,o);});}}});d.SchedulerCalendar=f;},"@VERSION@",{requires:["aui-scheduler-event"],skinnable:false});AUI.add("aui-scheduler",function(a){},"@VERSION@",{skinnable:true,use:["aui-scheduler-base","aui-scheduler-view","aui-scheduler-event","aui-scheduler-calendar"]});