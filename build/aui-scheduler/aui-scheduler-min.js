AUI.add("aui-scheduler-base",function(ac){var P=ac.Lang,aw=P.isString,a=P.isArray,d=P.isDate,I=P.isNumber,B=P.isObject,H=function(A){return(A instanceof ac.Scheduler);},s=function(A){return(A instanceof ac.SchedulerView);},aa=function(A){return(A instanceof ac.SchedulerEvent);},t=function(A){return(ac.SchedulerCalendar&&(A instanceof ac.SchedulerCalendar));},h=ac.DataType.DateMath,W=ac.WidgetStdMod,U=".",o="",p=" ",r="scheduler-base",ai="data-view-name",F="activeView",av="clearfix",E="controls",ak="controlsNode",an="current",ab="currentDate",Y="currentDateNode",aj="date",ag="endDate",ah="eventClass",N="eventRecorder",ax="events",aC="hd",v="header",au="headerNode",m="helper",S="icon",j="iconNextNode",aq="iconPrevNode",aA="locale",l="name",Q="nav",M="navNode",ap="navigationDateFormat",n="next",c="nextDate",at="prev",al="prevDate",aB="rendered",L="scheduler",ay="startDate",D="strings",e="today",ad="todayNode",u="triggerNode",y="view",O="viewStack",aD="views",X="viewsNode",z=ac.getClassName,ae=z(m,av),i=z(S),ao=z(r,E),T=z(r,an,aj),f=z(r,aC),V=z(r,S,n),C=z(r,S,at),az=z(r,Q),x=z(r,e),Z=z(r,y),g=z(r,y,o),q=z(r,aD),am='<div class="'+ao+'"></div>',w='<div class="'+T+'"></div>',b='<div class="'+f+'"></div>',aE='<a href="#" class="'+[i,V].join(p)+'">Next</a>',af='<a href="#" class="'+[i,C].join(p)+'">Prev</a>',k='<div class="'+az+'"></div>',R='<a href="#" class="'+x+'">{today}</a>',ar='<a href="#" class="'+[Z,g].join(p)+'{name}" data-view-name="{name}">{label}</a>',J='<div class="'+q+'"></div>';var K=function(){};K.ATTRS={eventClass:{valueFn:function(){return ac.SchedulerEvent;}},events:{value:[],setter:"_setEvents",validator:a}};ac.mix(K.prototype,{addEvent:function(aF){var A=this;var aG=A.get(ax);if(ac.Array.indexOf(aG,aF)>-1){ac.Array.removeItem(aG,aF);}aG.push(aF);A.set(ax,aG);},addEvents:function(aF){var A=this;ac.Array.each(A._normalizeEvents(aF),ac.bind(A.addEvent,A));},eachEvent:function(aG){var A=this;var aF=A.get(ax);ac.Array.each(aF,aG,A);},removeEvent:function(aF){var A=this;var aG=A.get(ax);if(aG.length){ac.Array.removeItem(aG,aF);A.set(ax,aG);}},removeEvents:function(aF){var A=this;ac.Array.each(A._normalizeEvents(aF),ac.bind(A.removeEvent,A));},_normalizeEvents:function(aG){var A=this;var aF=[];aG=ac.Array(aG);ac.Array.each(aG,function(aH){if(aa(aH)){aF.push(aH);}else{if(t(aH)){if(H(A)){aH.set(L,A);}aF=aF.concat(A._normalizeEvents(aH.get(ax)));}else{aH=new (A.get(ah))(aH);aF.push(aH);}}if(H(A)){aH.set(L,A);aH.set(ah,A.get(ah));}});return aF;},_setEvents:function(aF){var A=this;return A._normalizeEvents(aF);}});ac.SchedulerEventSupport=K;var G=ac.Component.create({NAME:r,ATTRS:{activeView:{validator:s},eventRecorder:{setter:"_setEventRecorder"},strings:{value:{day:"Day",month:"Month",today:"Today",week:"Week",year:"Year"}},navigationDateFormat:{getter:function(aG){var A=this;var aF=A.get(F);if(aF){return aF.get(ap);}return aG;},value:"%A - %d %b %Y",validator:aw},views:{setter:"_setViews",value:[]},currentDate:{valueFn:function(){return new Date();},validator:d},firstDayOfWeek:{value:0,validator:I},controlsNode:{valueFn:function(){return ac.Node.create(am);}},currentDateNode:{valueFn:function(){return ac.Node.create(w);}},headerNode:{valueFn:function(){return ac.Node.create(b);}},iconNextNode:{valueFn:function(){return ac.Node.create(aE);}},iconPrevNode:{valueFn:function(){return ac.Node.create(af);}},navNode:{valueFn:function(){return ac.Node.create(k);}},todayNode:{valueFn:function(){return ac.Node.create(this._processTemplate(R));}},viewsNode:{valueFn:function(){return ac.Node.create(J);}}},HTML_PARSER:{controlsNode:U+ao,currentDateNode:U+T,headerNode:U+f,iconNextNode:U+V,iconPrevNode:U+C,navNode:U+az,todayNode:U+x,viewsNode:U+q},UI_ATTRS:[ab],AUGMENTS:[ac.SchedulerEventSupport,ac.WidgetStdMod],prototype:{viewStack:null,initializer:function(){var A=this;A[O]={};A[ak]=A.get(ak);A[Y]=A.get(Y);A[v]=A.get(au);A[j]=A.get(j);A[aq]=A.get(aq);A[M]=A.get(M);A[ad]=A.get(ad);A[X]=A.get(X);A.after({activeViewChange:A._afterActiveViewChange,render:A._afterRender});},bindUI:function(){var A=this;A._bindDelegate();},syncUI:function(){var A=this;A.syncStdContent();},flushEvents:function(){var A=this;ac.Array.each(A.get(ax),function(aF){aF.eachRepeatedEvent(function(aG){delete aG._filtered;});delete aF._filtered;});},getEventsByDay:function(aF,aG){var A=this;aF=h.safeClearTime(aF);return A._getEvents(aF,function(aH){return h.compare(aH.getClearStartDate(),aF)||(aG&&h.compare(aH.getClearEndDate(),aF));});},getIntersectEvents:function(aF){var A=this;aF=h.safeClearTime(aF);return A._getEvents(aF,function(aH){var aG=aH.getClearStartDate();var aI=aH.getClearEndDate();return(h.compare(aF,aG)||h.compare(aF,aI)||h.between(aF,aG,aI));});},sortEventsByDateAsc:function(aF){var A=this;aF.sort(function(aJ,aH){var aI=aJ.get(ag);var aG=aH.get(ag);var aL=aJ.get(ay);var aK=aH.get(ay);if(h.after(aL,aK)||(h.compare(aL,aK)&&h.before(aI,aG))){return 1;}else{return -1;}});},getViewByName:function(aF){var A=this;return A[O][aF];},getStrings:function(){var A=this;return A.get(D);},getString:function(aF){var A=this;return A.getStrings()[aF];},renderView:function(aF){var A=this;if(aF){aF.show();if(!aF.get(aB)){if(!A.bodyNode){A.setStdModContent(W.BODY,o);}aF.render(A.bodyNode);}}},plotViewEvents:function(aF){var A=this;aF.plotEvents(A.get(ax));},syncEventsUI:function(){var A=this;A.plotViewEvents(A.get(F));},_afterActiveViewChange:function(aH){var aF=this;if(aF.get(aB)){var aG=aH.newVal;var A=aH.prevVal;if(A){A.hide();}aF.renderView(aG);var aI=aF.get(N);if(aI){aI.hideOverlay();}}},_afterRender:function(aF){var A=this;A.renderView(A.get(F));},_bindDelegate:function(){var A=this;A[X].delegate("click",A._onClickViewTrigger,U+Z,A);A[ak].delegate("click",A._onClickPrevIcon,U+C,A);A[ak].delegate("click",A._onClickNextIcon,U+V,A);A[ak].delegate("click",A._onClickToday,U+x,A);},_createViewTriggerNode:function(aF){var A=this;if(!aF.get(u)){var aG=aF.get(l);aF.set(u,ac.Node.create(P.sub(ar,{name:aG,label:(A.getString(aG)||aG)})));}return aF.get(u);
},_getEvents:function(aF,aI){var A=this;var aH=A.get(ax);var aG=[];ac.Array.each(aH,function(aJ){if(aI.apply(A,[aJ])){aG.push(aJ);}else{if(aJ.isRepeatableDate(aF)){var aK=aJ.repeatByDate(aF);aG.push(aK);}}});A.sortEventsByDateAsc(aG);return aG;},_onClickToday:function(aF){var A=this;A.set(ab,A.get(F).getToday());aF.preventDefault();},_onClickNextIcon:function(aF){var A=this;A.set(ab,A.get(F).get(c));aF.preventDefault();},_onClickPrevIcon:function(aF){var A=this;A.set(ab,A.get(F).get(al));aF.preventDefault();},_onClickViewTrigger:function(aF){var A=this;var aG=aF.currentTarget.attr(ai);A.set(F,A.getViewByName(aG));aF.preventDefault();},_processTemplate:function(aF){var A=this;return P.sub(aF,A.getStrings());},_setEventRecorder:function(aF){var A=this;if(aF){aF.set(L,A);aF.set(ah,A.get(ah));}},_setViews:function(aG){var A=this;var aF=[];ac.Array.each(aG,function(aH){if(s(aH)&&!aH.get(aB)){aH.set(L,A);aH.set(ah,A.get(ah));aF.push(aH);A[O][aH.get(l)]=aH;}});if(!A.get(F)){A.set(F,aG[0]);}return aF;},syncStdContent:function(){var A=this;var aF=A.get(aD);A[M].append(A[aq]);A[M].append(A[j]);A[ak].append(A[ad]);A[ak].append(A[M]);A[ak].append(A[Y]);ac.Array.each(aF,function(aG){A[X].append(A._createViewTriggerNode(aG));});A[v].append(A[ak]);A[v].append(A[X]);A[v].addClass(ae);A.setStdModContent(W.HEADER,A[v].getDOM());},_uiSetCurrentDate:function(aH){var A=this;var aG=ac.DataType.Date.format(aH,{format:A.get(ap),locale:A.get(aA)});A[Y].html(aG);if(A.get(aB)){var aF=A.get(F);if(aF){aF._uiSetCurrentDate(aH);}A.syncEventsUI();}}}});ac.Scheduler=G;},"@VERSION@",{skinnable:true,requires:["aui-scheduler-view","datasource"]});AUI.add("aui-scheduler-view",function(cL){var c1=cL.Lang,bg=c1.isBoolean,C=c1.isFunction,aQ=c1.isNumber,dg=c1.isObject,cz=c1.isString,ck=function(A){return parseFloat(A)||0;},cn=function(dl,A){return Math.round(dl/A)*A;},ay=cL.DataType.DateMath,cG=cL.WidgetStdMod,aY=ay.WEEK_LENGTH,cq="scheduler-view",aP="scheduler-view-day",c8="scheduler-view-month",cf="scheduler-view-table",cR="scheduler-view-week",bu="activeColumn",cj="activeView",R="allDay",a6="boundingBox",dj="cancel",an="col",aF="colDaysNode",a6="boundingBox",cP="colHeaderDaysNode",M="colblank",B="coldata",aS="colday",a="colgrid",ab="colspan",o="coltime",bQ="columnData",be="columnDayHeader",aU="columnShims",a3="columnTableGrid",bC="columnTime",a2="container",aZ="content",bt="creationEndDate",ae="creationStartDate",bB="currentDate",b4="data",cY="day",X="days",at="dd",aH="delegate",F="delegateConfig",ci="disabled",bb="displayDaysInterval",ac="div",bO="division",db="dotted",ag="down",cT="dragNode",y="dragging",J="draggingEvent",cy="duration",aK="endDate",bo="event",da="eventClass",ch="eventPlaceholder",di="eventRecorder",t="eventWidth",cF="filterFn",aR="first",cS="firstDayOfWeek",b8="fixedHeight",bx="grid",b1="gridContainer",bp="grip",dh="hd",cI="header",bz="headerDateFormat",de="headerTableNode",bk="headerView",bM="headerViewConfig",aW="headerViewLabelNode",cv="height",br="horizontal",a5="host",aN="hourHeight",v="icon",v="icon",ar="isoTime",ah="label",bc="lasso",a7="left",aG="locale",m="marginRight",aj="marker",bq="markercell",bi="markercellsNode",N="markers",ca="markersNode",cc="month",bv="monthContainerNode",cU="monthRowContainer",e="monthRows",G="mousedown",P="mousemove",ba="mouseup",a0="next",dk="node",aq="nomonth",az="noscroll",cH="offsetHeight",cJ="offsetWidth",cM="pad",aT="paddingNode",c4="parentEvent",V="parentNode",bX="proxy",bD="proxyNode",ao="px",ak="region",a8="rendered",cD="repeated",ct="resizer",cA="resizerNode",cm="resizing",bj="right",bU="row",bT="rowsContainerNode",cp="save",s="scheduler",aM="scheduler-event",ad="scrollable",W="shim",cQ="startDate",aa="startXY",cB="strings",a9="table",E="tableGridNode",b2="tableNode",cd="tableRowContainer",c7="tableRows",b0="tbody",g="td",bR="time",ap="timesNode",i="title",au="today",bV="top",df="tr",bZ="view",aE="visible",c3="week",b6="width",w="data-colnumber",k="a",bN=",",cl="-",cs=".",cg="",b7="%",Z=" ",H=cL.getClassName,bP=H(cq,az),ai=H(cq,ad);var bh=cL.Component.create({NAME:cq,AUGMENTS:[cL.WidgetStdMod],ATTRS:{bodyContent:{value:cg},eventClass:{valueFn:function(){return cL.SchedulerEvent;}},filterFn:{validator:C,value:function(A){return true;}},height:{value:600},isoTime:{value:false,validator:bg},name:{value:cg,validator:cz},navigationDateFormat:{value:"%A - %d %B, %Y",validator:cz},nextDate:{getter:"getNextDate",readOnly:true},prevDate:{getter:"getPrevDate",readOnly:true},scheduler:{lazyAdd:false,setter:"_setScheduler"},scrollable:{value:true,validator:bg},triggerNode:{setter:cL.one},visible:{value:false}},BIND_UI_ATTRS:[ad],prototype:{initializer:function(){var A=this;A.after("render",A._afterRender);},syncUI:function(){var A=this;A.syncStdContent();},adjustCurrentDate:function(){var A=this;var dm=A.get(s);var dl=dm.get(bB);dm.set(bB,dl);},flushViewCache:function(){},getNextDate:function(){},getPrevDate:function(){},getToday:function(){return ay.clearTime(new Date());},limitDate:function(dl,dm){var A=this;if(ay.after(dl,dm)){dl=ay.clone(dm);}return dl;},plotEvents:function(){},syncStdContent:function(){},syncEventUI:function(A){},_uiSetCurrentDate:function(A){},_afterRender:function(dl){var A=this;A.adjustCurrentDate();A._uiSetScrollable(A.get(ad));},_setScheduler:function(dm){var A=this;var dl=A.get(s);if(dl){A.removeTarget(dl);}if(dm){A.addTarget(dm);dm.after("eventsChange",cL.bind(A.flushViewCache,A));}return dm;},_uiSetScrollable:function(dm){var A=this;var dl=A.bodyNode;if(dl){dl.toggleClass(ai,dm);dl.toggleClass(bP,!dm);}},_uiSetVisible:function(dl){var A=this;bh.superclass._uiSetVisible.apply(this,arguments);if(dl&&A.get(a8)){A.adjustCurrentDate();}}}});cL.SchedulerView=bh;var ce=c1.sub;var l=cL.cached(function(){var dn=cL.config.doc,dl=dn.createElement("div"),A=dn.getElementsByTagName("body")[0],dm=0.1;if(A){dl.style.cssText="position:absolute;visibility:hidden;overflow:scroll;width:20px;";dl.appendChild(dn.createElement("p")).style.height="1px";A.insertBefore(dl,A.firstChild);
dm=dl.offsetWidth-dl.clientWidth;A.removeChild(dl);}return dm;},null,0.1);var Q=function(A,dl){return function(dn){var dm=dn.all(A);return(dm.size()>=dl)?dm:null;};},h=H(v),K=H(v,bp,db,br),aV=H(aM),bI=H(aM,ci),cw=H(aM,bX),U=H(s,au),aw=H(s,au,dh),D=H(cq,B),d=H(cq,a),cV=H(cq,bx),cW=H(cq,bx,a2),aX=H(cq,cY,ct,v),cu=H(cq,cY,ct),bL=H(cq,aj,bO),cX=H(cq,bq),O=H(cq,N),b3=H(cq,cY,a9),c0=H(cq,cY,cI,a9),u=H(cq,cY,cI,cY),bK=H(cq,cY,cI,cY,cM,bj),cx=H(cq,cY,cI,cY,aR),bn=H(cq,cY,cI,an),bw=H(cq,cY,cI,bZ,ah),dc=H(cq,cY,a9,an),aL=H(cq,cY,a9,an,W),T=H(cq,cY,a9,M),L=H(cq,cY,a9,aS),c5=H(cq,cY,a9,o),bS=H(cq,cY,a9,bR),q='<div class="'+cu+'">'+'<div class="'+[h,K,aX].join(Z)+'"></div>'+"</div>",al='<div class="'+cX+'">'+'<div class="'+bL+'"></div>'+"</div>",p='<span class="'+bw+'">{label}</span>',aC='<table cellspacing="0" cellpadding="0" class="'+b3+'">'+"<tbody>"+'<tr class="'+d+'" height="1">'+'<td height="0" class="'+[dc,T].join(Z)+'"></td>'+'<td class="'+cW+'" colspan="1">'+'<div class="'+cV+'">'+'<div class="'+O+'"></div>'+"</div>"+"</td>"+"</tr>"+'<tr class="'+D+'">'+'<td class="'+[dc,c5].join(Z)+'"></td>'+"</tr>"+"</tbody>"+"</table>",bE='<td class="'+[dc,L].join(Z)+'" data-colnumber="{colNumber}">'+'<div class="'+aL+'"></div>'+"</td>",j='<div class="'+bS+'">{hour}</div>',aD='<table cellspacing="0" cellpadding="0" class="'+c0+'">'+"<tbody>"+'<tr class="'+bn+'"></tr>'+"</tbody>"+"</table>",bH='<th class="'+u+'" data-colnumber="{colNumber}"><a href="#">&nbsp;</a></th>',aB='<td class="'+[u,cx].join(Z)+'"></td>',z='<th class="'+[u,bK].join(Z)+'">&nbsp;</th>';var dd=cL.Component.create({NAME:aP,ATTRS:{bodyContent:{value:cg},days:{value:1,validator:aQ},delegateConfig:{value:{},setter:function(dl){var A=this;return cL.merge({dragConfig:{useShim:false},bubbleTargets:A,container:A.get(a6),nodes:cs+aV,invalid:"input, select, button, a, textarea, "+cs+bI},dl||{});},validator:dg},eventWidth:{value:95,validator:aQ},filterFn:{value:function(A){return(A.getHoursDuration()<=24&&!A.get(R));}},headerDateFormat:{value:"%d %A",validator:cz},headerView:{value:true,validator:bg},headerViewConfig:{setter:function(dl){var A=this;return cL.merge({displayDaysInterval:1,displayRows:6,filterFn:function(dm){return((dm.getHoursDuration()>24)||dm.get(R));},height:"auto",visible:true},dl||{});},value:{}},hourHeight:{value:52,validator:aQ},name:{value:cY},strings:{value:{allDay:"All day"}},headerTableNode:{valueFn:function(){return cL.Node.create(aD);}},headerViewLabelNode:{valueFn:function(){var dl=this;var A=dl.get(cB);return cL.Node.create(ce(p,{label:A[R]}));}},resizerNode:{valueFn:function(){return cL.Node.create(q);}},tableNode:{valueFn:function(){return cL.Node.create(aC);}},colDaysNode:{valueFn:"_valueColDaysNode"},colHeaderDaysNode:{valueFn:"_valueColHeaderDaysNode"},markercellsNode:{valueFn:"_valueMarkercellsNode"},timesNode:{valueFn:"_valueTimesNode"}},HTML_PARSER:{colDaysNode:Q(cs+L,1),colHeaderDaysNode:Q(cs+u,2),headerTableNode:cs+c0,headerViewLabelNode:cs+bw,markercellsNode:Q(cs+cX,24),resizerNode:cs+cu,tableNode:cs+b3,timesNode:Q(cs+bS,24)},EXTENDS:cL.SchedulerView,prototype:{initializer:function(){var A=this;A[aF]=A.get(aF);A[cP]=A.get(cP);A[de]=A.get(de);A[bi]=A.get(bi);A[cA]=A.get(cA);A[b2]=A.get(b2);A[ap]=A.get(ap);A[bu]=null;A[bQ]=A[b2].one(cs+D);A[be]=A.headerTableNode.one(cs+bn);A[aU]=A[aF].all(cs+aL);A[bC]=A[b2].one(cs+c5);A[b1]=A[b2].one(cs+cW);A[ca]=A[b2].one(cs+O);if(A.get(bk)){A[bk]=new cL.SchedulerTableView(A.get(bM));}},renderUI:function(){var A=this;A[bC].setContent(A[ap]);A[ca].setContent(A[bi]);A[aF].appendTo(A[bQ]);A[cP].appendTo(A[be]);if(A[bk]){A[bk].set(s,A.get(s));A[bk].render();}},bindUI:function(){var A=this;A[de].delegate("click",cL.bind(A._onClickDaysHeader,A),cs+u);A[bQ].delegate("mousedown",cL.bind(A._onMouseDownTableCol,A),cs+dc);A[bQ].delegate("mouseenter",cL.bind(A._onMouseEnterEvent,A),cs+aV);A[bQ].delegate("mouseleave",cL.bind(A._onMouseLeaveEvent,A),cs+aV);A[bQ].delegate("mousemove",cL.bind(A._onMouseMoveTableCol,A),cs+L);A[bQ].delegate("mouseup",cL.bind(A._onMouseUpTableCol,A),cs+dc);A.on("drag:end",A._onEventDragEnd);A.on("drag:start",A._onEventDragStart);A.on("drag:tickAlignY",A._dragTickAlignY);A.on("schedulerChange",A._onSchedulerChange);A.after("drag:align",A._afterDragAlign);},syncUI:function(){var A=this;dd.superclass.syncUI.apply(this,arguments);A[b1].attr(ab,A.get(X));A._setupDragDrop();},syncStdContent:function(){var dl=this;dl.setStdModContent(cG.BODY,dl[b2].getDOM());var A=cL.NodeList.create(dl[de]);if(dl[bk]){A.push(dl[bk].get(a6));A.push(dl.get(aW));}dl.setStdModContent(cG.HEADER,A);},calculateEventHeight:function(dm){var dl=this;var A=dl.get(aN);return Math.max(dm*(A/60),A/2);},calculateTop:function(dl){var A=this;return((dl.getHours()*60)+dl.getMinutes()+(dl.getSeconds()/60))*(A.get(aN)/60);},getNextDate:function(){var A=this;var dl=A.get(s).get(bB);return ay.add(dl,ay.DAY,1);},getPrevDate:function(){var A=this;var dl=A.get(s).get(bB);return ay.subtract(dl,ay.DAY,1);},getColumnByDate:function(dl){var A=this;return A[aF].item(A.getDateDaysOffset(dl));},getColumnShimByDate:function(dl){var A=this;return A[aU].item(A.getDateDaysOffset(dl));},getDateByColumn:function(dm){var A=this;var dl=ay.safeClearTime(A.get(s).get(bB));return ay.add(dl,ay.DAY,dm);},getDateDaysOffset:function(dm){var A=this;var dl=ay.safeClearTime(A.get(s).get(bB));return ay.getDayOffset(ay.safeClearTime(dm),dl);},getYCoordTime:function(dp){var dl=this;var A=dl.get(aN);var dq=ck((dp/A).toFixed(2));var dn=Math.floor((dq*100)%100*0.6);var dm=Math.floor(dq);return[dm,dn,0];},plotEvent:function(dm){var A=this;var dn=dm.get(dk);if(dn.size()<2){dm.addPaddingNode();}var dq=dm.get(dk).item(0);var dl=dm.get(dk).item(1);var dp=A.getColumnShimByDate(dm.get(aK));var dr=A.getColumnShimByDate(dm.get(cQ));if(dr){dr.append(dq);if(dm.get(aE)){dq.show();}}else{dq.hide();}if(dp){if(dp.compareTo(dr)||dm.isDayBoundaryEvent()){dl.hide();}else{dp.append(dl);if(dm.get(aE)){dl.show();}}}else{dl.hide();}dm.syncNodeUI();A.syncEventTopUI(dm);
A.syncEventHeightUI(dm);},plotEvents:function(){var A=this;var dl=A.get(s);var dm=A.get(cF);A[aU].each(function(dr,dq){var dn=dl.getEventsByDay(A.getDateByColumn(dq),true);var dp=[];dr.empty();cL.Array.each(dn,function(ds){if(dm.apply(A,[ds])){A.plotEvent(ds);dp.push(ds);}});A.syncEventsIntersectionUI(dp);});if(A.get(bk)){A.syncHeaderViewUI();}},syncColumnsUI:function(){var A=this;A[aF].each(function(dn,dm){var dl=A.getDateByColumn(dm);dn.toggleClass(U,ay.isToday(dl));});},syncDaysHeaderUI:function(){var dm=this;var dn=dm.get(s).get(bB);var dl=dm.get(bz);var A=dm.get(aG);dm[cP].all(k).each(function(dr,dq){var dp=ay.add(dn,ay.DAY,dq);var ds=cL.DataType.Date.format(dp,{format:dl,locale:A});dr.toggleClass(aw,ay.isToday(dp));dr.html(ds);});},syncEventsIntersectionUI:function(dl){var A=this;var dm=A.get(t);A.get(s).flushEvents();cL.Array.each(dl,function(dp){var dr=A.findEventIntersections(dp,dl);var dq=dr.length;var dn=(dm/dq);cL.Array.each(dr,function(dt,du){var ds=dt.get(dk).item(0);var dw=dn*du;var dv=dn*1.7;if(du===(dq-1)){dv=dm-dw;}ds.setStyle(b6,dv+b7);ds.setStyle(a7,dw+b7);var dx=ds.get(V);if(dx){dx.insert(ds,du);}dt._filtered=true;});});},syncEventHeightUI:function(dn){var dl=this;var ds=dn.get(aK);var A=dn.get(cQ);var dp=ay.clone(A);dp.setHours(24,0,0);var dq=ay.getMinutesOffset(dl.limitDate(ds,dp),A);dn.get(dk).item(0).set(cH,dl.calculateEventHeight(dq));var dm=dn.get(dk).item(1);if(dm.inDoc()){var dr=ay.getMinutesOffset(ds,ay.toMidnight(dn.getClearEndDate()));dm.set(cH,dl.calculateEventHeight(dr));}},syncEventTopUI:function(dl){var A=this;dl.get(dk).item(0).setStyle(bV,A.calculateTop(dl.get(cQ))+ao);dl.get(dk).item(1).setStyle(bV,0);},syncHeaderViewUI:function(){var dl=this;if(dl.get(bk)){var dn=dl[bk];dn.plotEvents();var dp=dn.get(a6);dp.setStyle(m,l());var dm=dp.one(cs+bm);var A=Math.max(dm.get(cH),40);dn.set(cv,A);dl._fillHeight();}},calculateYDelta:function(dm,dl){var A=this;return(dl[1]-dm[1])/(A.get(aN)/2)*30;},findEventIntersections:function(dl,dm){var A=this;var dn=[];cL.Array.each(dm,function(dp){if(!dl._filtered&&dl.intersectHours(dp)){dn.push(dp);}});return dn;},getXYDelta:function(dl){var A=this;var dm=dl.currentTarget.getXY(),dn=[dl.pageX,dl.pageY];return cL.Array.map(dm,function(dq,dp){return(dn[dp]-dq);});},getTickY:function(){var A=this;return cn(Math.ceil(A.get(aN)/2),10);},roundToNearestHour:function(dl,dm){var A=this;dl.setHours(dm[0],cn(dm[1],A.getTickY()),dm[2]);},_afterDragAlign:function(dm){var dl=this;var A=dm.target;if(!dl[aa]){dl[aa]=A.actXY;}A.actXY[0]=null;},_dragTickAlignX:function(dm){var dl=this;var dq=dl[J];if(dq&&!dl[cm]){var dn=dl[ch];var dp=ck(dm.attr(w))-dl.startColNumber;dl.draggingEventStartDate=ay.add(dq.get(cQ),ay.DAY,dp);var A=ay.clone(dl.draggingEventStartDate);ay.copyHours(A,dn.get(cQ));dn.move(A);dl.plotEvent(dn);}},_dragTickAlignY:function(A){var dr=this;var dl=dr.get(s);var dt=dl.get(di);var dn=dr[J];if(dn){var ds=A.target.get(a5);var dp=dr[ch];var dq=dr.calculateYDelta(dr[aa],ds.actXY);if(dr[cm]){var dm=ay.add(dr.draggingEventEndDate,ay.MINUTES,dq);if(ay.getMinutesOffset(dm,dr.draggingEventStartDate)<=dt.get(cy)){return;}dp.set(aK,dm);}else{dp.move(ay.add(dr.draggingEventStartDate,ay.MINUTES,dq));}dr.plotEvent(dp);}},_setupDragDrop:function(){var dl=this;if(!dl[ch]){var dm=dl.get(s);dl[ch]=new (dl.get(da))({scheduler:dm});dl[ch].removeTarget(dm);dl[ch].get(dk).addClass(cw).hide();}if(!dl.delegate){dl.delegate=new cL.DD.Delegate(dl.get(F));}var A=dl.delegate.dd;A.unplug(cL.Plugin.DDConstrained);A.unplug(cL.Plugin.DDNodeScroll);var dn=dl.bodyNode.get(ak);dn.bottom=Infinity;dn.top=-Infinity;A.plug(cL.Plugin.DDConstrained,{bubbleTargets:dl,constrain:dn,stickY:true,tickY:dl.get(aN)/2});A.plug(cL.Plugin.DDNodeScroll,{node:dl.bodyNode,scrollDelay:150});},_uiSetCurrentDate:function(dl){var A=this;A.syncColumnsUI();A.syncDaysHeaderUI();},_onClickDaysHeader:function(dn){var A=this;var dm=A.get(s);if(dn.target.test(k)){var dp=dm.getViewByName(cY);if(dp){var dl=ck(dn.currentTarget.attr(w));dm.set(bB,A.getDateByColumn(dl));dm.set(cj,dp);}}dn.preventDefault();},_onEventDragEnd:function(dl){var A=this;var dn=A[J];if(dn){var dm=A[ch];dm.set(aE,false);dn.set(aE,true);dn.copyDates(dm);A.get(s).syncEventsUI();}A[aa]=null;A[J]=null;},_onEventDragStart:function(dm){var A=this;var dp=A[J]=A.delegate.dd.get(dk).getData(aM);if(dp){var dn=A[ch];dn.copyPropagateAttrValues(dp);A.plotEvent(dn);dp.set(aE,false);A.draggingEventStartDate=ay.clone(dp.get(cQ));A.draggingEventEndDate=ay.clone(dp.get(aK));var dl=A.getColumnByDate(dp.get(cQ));A.startColNumber=dl?ck(dl.attr(w)):0;}},_onMouseDownTableCol:function(dl){var dr=this;var dq=dl.target;var dn=dr.get(s);var ds=dn.get(di);if(ds&&!dn.get(ci)){ds.hideOverlay();if(dq.test(cs+aL)){dr[aa]=[dl.pageX,dl.pageY];var dt=ck(dl.currentTarget.attr(w));var dm=dr.getDateByColumn(dt);var A=dr.getXYDelta(dl);dr.roundToNearestHour(dm,dr.getYCoordTime(A[1]));var dp=ay.add(dm,ay.MINUTES,ds.get(cy));ds.move(dm);ds.set(R,false);ds.set(aK,dp);dr[ae]=dm;dr[bt]=dp;dl.halt();}else{if(dq.test([cs+cu,cs+aX].join(bN))){dr[cm]=true;}}}dr.get(a6).unselectable();},_onMouseEnterEvent:function(dm){var A=this;var dn=dm.currentTarget;var dl=dn.getData(aM);if(dl&&!dl.get(ci)){A[cA].appendTo(dn);}},_onMouseLeaveEvent:function(dl){var A=this;if(!A[cm]){A._removeResizer();}},_onMouseMoveTableCol:function(dp){var A=this;var dn=dp.currentTarget;var dl=A.get(s).get(di);if(A[bu]!==dn){A[bu]=dn;A._dragTickAlignX(A[bu]);}var dm=A[bt];var dq=A[ae];if(dq){var dr=cn(A.calculateYDelta(A[aa],[dp.pageX,dp.pageY]),A.getTickY());if(A._delta!==dr){if(dr>0){dl.set(aK,ay.add(dm,ay.MINUTES,dr));}else{dl.set(cQ,ay.add(dq,ay.MINUTES,dr));}A.plotEvent(dl);A._delta=dr;}}},_onMouseUpTableCol:function(dn){var A=this;var dm=A.get(s);var dl=dm.get(di);if(dl&&!dm.get(ci)){if(A[ae]){A.plotEvent(dl);dl.showOverlay([dn.pageX,dn.pageY]);}}A[ae]=null;A[bt]=null;A[cm]=false;A[aa]=null;A._removeResizer();A.get(a6).selectable();},_onSchedulerChange:function(dl){var A=this;if(A[bk]){A[bk].set(s,dl.newVal);
}},_removeResizer:function(){var A=this;A[cA].remove();},_valueColDaysNode:function(){var A=this;var dn=A.get(X);var dl=[],dm=0;while(dn--){dl.push(cL.Lang.sub(bE,{colNumber:dm++}));}return cL.NodeList.create(dl.join(cg));},_valueColHeaderDaysNode:function(){var A=this;var dn=A.get(X);var dl=[],dm=0;dl.push(aB);while(dn--){dl.push(cL.Lang.sub(bH,{colNumber:dm++}));}dl.push(z);return cL.NodeList.create(dl.join(cg));},_valueMarkercellsNode:function(){var A=this;var dl=[],dm;for(dm=0;dm<=23;dm++){dl.push(al);}return cL.NodeList.create(dl.join(cg));},_valueTimesNode:function(){var A=this;var dn=A.get(ar);var dm=[],dl;for(dl=0;dl<=23;dl++){dm.push(ce(j,{hour:dn?ay.toIsoTimeString(dl):ay.toUsTimeString(dl,false,true)}));}return cL.NodeList.create(dm.join(cg));}}});cL.SchedulerDayView=dd;var av=cL.Component.create({NAME:cR,ATTRS:{bodyContent:{value:cg},days:{value:7},headerViewConfig:{value:{displayDaysInterval:aY}},name:{value:c3}},EXTENDS:cL.SchedulerDayView,prototype:{adjustCurrentDate:function(){var A=this;var dn=A.get(s);var dl=dn.get(bB);var dm=dn.get(cS);dn.set(bB,ay.getFirstDayOfWeek(dl,dm));},getNextDate:function(){var A=this;var dm=A.get(s);var dl=dm.get(bB);var dn=A._firstDayOfWeek(dl);return ay.add(dn,ay.WEEK,1);},getPrevDate:function(){var A=this;var dm=A.get(s);var dl=dm.get(bB);var dn=A._firstDayOfWeek(dl);return ay.subtract(dn,ay.WEEK,1);},getToday:function(){var A=this;var dl=av.superclass.getToday.apply(this,arguments);return A._firstDayOfWeek(dl);},_firstDayOfWeek:function(dm){var A=this;var dn=A.get(s);var dl=dn.get(cS);return ay.getFirstDayOfWeek(dm,dl);}}});cL.SchedulerWeekView=av;var h=H(v),n=H(v,"arrowstop-1-l"),c6=H(v,"arrowstop-1-r"),r=H(cq,a9,a),a1=H(cq,a9,a,aR),aA=H(cq,a9,a,au),bF=H(cq,a9,a2),x=H(cq,a9,y),ax=H(cq,a9,cI,an),c2=H(cq,a9,cI,cY),c=H(cq,a9,cI,a9),I=H(cq,a9,bc),co=H(cq,a9,bX,dk),cK=H(cq,a9,bU),b5=H(cq,a9,bU,a2),bm=H(cq,a9,b4),cE=H(cq,a9,b4,an),bY=H(cq,a9,b4,an,i),cC=H(cq,a9,b4,an,i,ag),b9=H(cq,a9,b4,an,i,aR),c9=H(cq,a9,b4,an,i,a0),bJ=H(cq,a9,b4,an,i,au),aI=H(cq,a9,b4,bo),b=H(cq,a9,b4,bo,a7),cN=H(cq,a9,b4,bo,cD),am=H(cq,a9,b4,bo,bj),af=H(cq,a9,b4,aR),aO=H(cq,a9,bx),cb=H(cq,a9,bx,aR),a4='<div class="'+bF+'">'+'<div class="'+b5+'"></div>'+"</div>",cr='<td class="'+r+'">&nbsp;</td>',f='<th class="'+c2+'"><div>&nbsp;</div></th>',Y='<table cellspacing="0" cellpadding="0" class="'+c+'">'+"<tbody>"+'<tr class="'+ax+'"></tr>'+"</tbody>"+"</table>",bW='<div class="'+I+'"></div>',cO='<div class="'+co+'"></div>',bA='<div class="'+cK+'" style="top: {top}%; height: {height}%;"></div>',bG='<table cellspacing="0" cellpadding="0" class="'+bm+'">'+"<tbody></tbody>"+"</table>",bd='<table cellspacing="0" cellpadding="0" class="'+aO+'">'+"<tbody>"+"<tr></tr>"+"</tbody>"+"</table>",S='<span class="'+[h,n].join(Z)+'"></span>',bs='<span class="'+[h,c6].join(Z)+'"></span>',by='<td class="'+cE+'"><div></div></td>',cZ="<tr></tr>";var bf=cL.Component.create({NAME:cf,ATTRS:{bodyContent:{value:cg},delegateConfig:{value:{},setter:function(dl){var A=this;return cL.merge({dragConfig:{offsetNode:false,useShim:false},bubbleTargets:A,container:A.get(a6),nodes:cs+aV,invalid:"input, select, button, a, textarea, "+cs+bI},dl||{});},validator:dg},displayDaysInterval:{value:42},displayRows:{value:4},fixedHeight:{value:true},name:{value:a9},headerDateFormat:{value:"%a"},navigationDateFormat:{value:"%b %Y"},scrollable:{value:false},headerTableNode:{valueFn:function(){return cL.Node.create(Y);}},colHeaderDaysNode:{valueFn:"_valueColHeaderDaysNode"},rowsContainerNode:{valueFn:function(){return cL.Node.create(a4);}},tableGridNode:{valueFn:"_valueTableGridNode"}},HTML_PARSER:{colHeaderDaysNode:Q(cs+c2,7),headerTableNode:cs+c,rowsContainerNode:cs+bF,tableGridNode:Q(cs+aO,7)},EXTENDS:cL.SchedulerView,prototype:{evtDateStack:null,evtDataTableStack:null,initializer:function(){var A=this;A.evtDateStack={};A.evtDataTableStack={};A[cP]=A.get(cP);A[de]=A.get(de);A[bT]=A.get(bT);A[E]=A.get(E);A[be]=A.headerTableNode.one(cs+ax);A[a3]=cL.NodeList.create();A[bD]=cL.Node.create(cO);A[cd]=A[bT].one(cs+b5);A[c7]=cL.NodeList.create();},bindUI:function(){var A=this;var dl=A.get(s).get(di);A.after("drag:align",A._afterDragAlign);A.on("drag:end",A._onEventDragEnd);A.on("drag:start",A._onEventDragStart);dl.on({cancel:cL.bind(A.removeLasso,A),save:cL.bind(A.removeLasso,A)});A[bT].on({mousedown:cL.bind(A._onMouseDownGrid,A),mousemove:cL.bind(A._onMouseMoveGrid,A),mouseup:cL.bind(A._onMouseUpGrid,A)});},renderUI:function(){var dl=this;var dp=dl.get(bb);var dm=Math.ceil(dp/aY);var dr=100/dm;for(var dn=0;dn<dm;dn++){var A=dl._getTableGridNode(dn);var dq=cL.Node.create(c1.sub(bA,{height:dr,top:dr*dn}));dq.append(A.toggleClass(cb,(dn===0)));dl[c7].push(dq);}dl[bD].appendTo(dl[bT]);dl[cP].appendTo(dl[be]);dl[c7].appendTo(dl[cd]);},syncUI:function(){var A=this;bf.superclass.syncUI.apply(this,arguments);A._setupDragDrop();},buildEventsTable:function(dl,dq){var dy=this;var dr=dy.get(bb);var dv=dy.get("displayRows");var dz=dy.get(cF);var dx=ay.clearTime(dy._findCurrentIntervalEnd());var du=ay.clearTime(dy._findCurrentIntervalStart());var dt=String(du.getTime()).concat(dl.getTime()).concat(dq.getTime());var ds=dy.evtDataTableStack[dt];if(!ds){ds=cL.Node.create(bG);var dw=ds.one(b0);var dn=cL.Node.create(cZ);dy.loopDates(dl,dq,function(dB,dA){var dC=cL.Node.create(by);dC.addClass(bY).toggleClass(b9,(dA===0)).toggleClass(bJ,ay.isToday(dB)).toggleClass(c9,ay.isToday(ay.subtract(dB,ay.DAY,1))).toggleClass(cC,ay.isToday(ay.subtract(dB,ay.WEEK,1)));dn.append(dC.setContent(dB.getDate()));});dw.append(dn);var A;for(A=0;A<dv;A++){var dp=0;var dm=cL.Node.create(cZ);dy.loopDates(dl,dq,function(dL,dG){if(dp<=dG){var dM=dy.getIntersectEvents(dL),dJ=dM[A];var dD=cL.Node.create(by);if(dJ&&dz.apply(dy,[dJ])){var dB=dJ.get(cQ);var dH=!ay.isDayOverlap(dB,dL);var dI=ay.after(dL,dB)&&!ay.isDayOverlap(dL,dl);if(dH||dI){var dC=dJ.get(dk);var dE=ay.getFirstDayOfWeek(new Date(Math.max(dB,du)));var dK=Math.floor(ay.getDayOffset(dL,dE)/aY);if(dC.size()<=dK){dJ.addPaddingNode();
}var dF=dC.item(dK);dF.setStyles({height:"auto",left:0,top:0,width:"auto"});dJ.syncNodeUI();var dA=dD.one(ac);dF.appendTo(dA);var dN=dy._getEvtSplitInfo(dJ,dL,dl,dq);dD.attr(ab,dN.colspan);dA.addClass(aI);if(dN.left){dA.addClass(b).prepend(S);}if(dN.right){dA.addClass(am).append(bs);}if(dJ.get(c4)){dA.addClass(cN);}dp+=dN.colspan;}else{dp++;}}else{dp++;}dm.append(dD);}});dw.append(dm);}dy.evtDataTableStack[dt]=ds;}return ds;},flushViewCache:function(){var A=this;A.evtDateStack={};A.evtDataTableStack={};},getIntersectEvents:function(dl){var A=this;var dp=A.get(s);var dn=String(dl.getTime());if(!A.evtDateStack[dn]){var dm=dp.getIntersectEvents(dl);A.evtDateStack[dn]=dm.filter(A.get(cF));}return A.evtDateStack[dn];},getNextDate:function(){var A=this;var dn=A.get(s);var dl=dn.get(bB);var dm=A.get(bb);return ay.add(dl,ay.DAY,dm);},getPrevDate:function(){var A=this;var dn=A.get(s);var dl=dn.get(bB);var dm=A.get(bb);return ay.subtract(dl,ay.DAY,dm);},loopDates:function(A,dn,dr,ds,dq){var dt=this;var dl=ay.clone(A);var dm=dn.getTime(),dp;for(dp=0;dl.getTime()<=dm;dp++){dr.apply(dt,[dl,dp]);dl=ay.add(dl,(ds||ay.DAY),(dq||1));}},plotEvents:function(){var dl=this;var dp=dl._findCurrentIntervalStart();var A=ay.safeClearTime(dp);dl.flushViewCache();dl.bodyNode.all(cs+bm).remove();var dm=dl.get(bb);var dn=Math.min(dm,aY);dl[c7].each(function(dt,dr){var dq=ay.add(A,ay.DAY,dn*dr);var du=ay.add(dq,ay.DAY,dn-1);var ds=dl.buildEventsTable(dq,du);if(dr===0){ds.addClass(af);}dt.append(ds);});},removeLasso:function(){var A=this;if(A.lasso){A.lasso.remove();}},renderLasso:function(ds,dl){var dy=this;var dp=ds;var dr=dl;if(ds[1]>dl[1]){dp=dl;dr=ds;}var dz=dp[0],du=dp[1],dm=dr[0],A=dr[1];dy.removeLasso();dy.lasso=cL.NodeList.create();for(var dn=du;dn<=A;dn++){var dq=dy.gridCellHeight,dx=dy.gridCellWidth,dv=0,dt=(dq*dn);if(dn===du){if(du===A){dv+=Math.min(dz,dm)*dx;dx*=Math.abs(dm-dz)+1;}else{dv+=dz*dx;dx*=aY-dz;}}else{if(dn===A){dx*=dm+1;}else{dx*=aY;}}var dw=cL.Node.create(bW);dy.lasso.push(dw);dy[bT].append(dw);dw.sizeTo(dx,dq);dw.setXY(dy._offsetXY([dv,dt],1));}},syncDaysHeaderUI:function(){var dm=this;var dq=dm.get(s);var dn=dq.get(bB);var dl=dm.get(bz);var A=dm.get(aG);var dp=dm._findFirstDayOfWeek(dn);dm.colHeaderDaysNode.all(ac).each(function(dt,ds){var dr=ay.add(dp,ay.DAY,ds);var du=cL.DataType.Date.format(dr,{format:dl,locale:A});dt.html(du);});},syncGridUI:function(){var dv=this;var dp=dv.getToday();var dl=dv.get(s);dv[a3].removeClass(aA);var dn=dv._findCurrentIntervalStart();var dr=dv._findCurrentIntervalEnd();if(ay.between(dp,dn,dr)){var A=dl.get(cS);var dt=dv._findFirstDayOfWeek(dp);var dq=ay.getWeekNumber(dp,A)-ay.getWeekNumber(dn,A);var du=(dp.getDate()-dt.getDate());var dm=dv._getCellIndex([du,dq]);var ds=dv[a3].item(dm);if(ds){ds.addClass(aA);}}},syncStdContent:function(){var A=this;A.setStdModContent(cG.BODY,A[bT].getDOM());A.setStdModContent(cG.HEADER,A[de].getDOM());},_afterDragAlign:function(dq){var dm=this;var dl=dq.target;var dr=dm[J];var dn=[dq.pageX,dq.pageY];var A=dm._findPosition(dm._offsetXY(dn,-1));if(dr&&dm._hasLassoChanged(A)){dm.lassoLastPosition=A;var dp=ay.add(dm._getPositionDate(A),ay.MINUTES,dr.getMinutesDuration());dm.renderLasso(A,dm._getDatePosition(dp));}},_findCurrentIntervalEnd:function(){var A=this;var dn=A.get(s);var dl=dn.get(bB);var dm=A.get(bb);return ay.add(dl,ay.DAY,dm);},_findCurrentIntervalStart:function(){var A=this;var dl=A.get(s);return dl.get(bB);},_findPosition:function(dn){var A=this;var dm=Math.floor(dn[0]/A.gridCellWidth);var dl=Math.floor(dn[1]/A.gridCellHeight);return[dm,dl];},_findFirstDayOfWeek:function(dm){var A=this;var dn=A.get(s);var dl=dn.get(cS);return ay.getFirstDayOfWeek(dm,dl);},_getCellIndex:function(dl){var A=this;return dl[1]*aY+dl[0];},_getDatePosition:function(dm){var dl=this;var dn=dl._findCurrentIntervalStart();var dp=ay.getDayOffset(dm,dn);var A=[];A[1]=Math.floor(dp/aY);A[0]=dp%aY;return A;},_getEvtLabel:function(dm){var dl=this;var dn=dm.get(aK);var A=dm.get(cQ);return[A.getHours(),cl,dn.getHours(),Z,dm.get(aZ)].join(cg);},_getEvtSplitInfo:function(dq,dt,A,dn){var dr=this;var dl=dq.getClearStartDate();var dp=dq.getClearEndDate();var ds=ay.getDayOffset(dn,dt);var dm={colspan:Math.min(ay.getDayOffset(dp,dt),ds)+1,left:ay.before(dl,A),right:ay.after(dp,dn)};return dm;},_getPositionDate:function(dm){var dl=this;var dn=dl._findCurrentIntervalStart();var A=ay.safeClearTime(dl._findFirstDayOfWeek(dn));return ay.add(A,ay.DAY,dl._getCellIndex(dm));},_getTableGridNode:function(dr){var dl=this;var dn=dl.get(bb);var A=dl[E].item(dr);var dq=A.one(df);for(var dm=0;dm<Math.min(dn,aY);dm++){var dp=cL.Node.create(cr);dq.append(dp);dl[a3].push(dp);}return A;},_hasLassoChanged:function(dl){var A=this;var dm=A.lassoLastPosition||A.lassoStartPosition;return dm&&((dl[0]!==dm[0])||(dl[1]!==dm[1]));},_offsetXY:function(dn,dm){var A=this;var dl=A[bT].getXY();return[dn[0]+dl[0]*dm,dn[1]+dl[1]*dm];},_onEventDragEnd:function(dl){var A=this;var dm=A[J];if(dm){dm.move(A._getPositionDate(A.lassoLastPosition));dm.set(aE,true);A[bT].removeClass(x).unselectable();A.removeLasso();dl.target.set(cT,A.originalDragNode);A.get(s).syncEventsUI();}A[J]=null;},_onEventDragStart:function(dp){var A=this;var dq=A[J]=A[aH][at].get(dk).getData(aM);if(dq){A._syncCellDimensions();var dl=[dp.pageX,dp.pageY];var dm=A._findPosition(A._offsetXY(dl,-1));var dn=ay.add(A._getPositionDate(dm),ay.MINUTES,dq.getMinutesDuration());A.renderLasso(dm,A._getDatePosition(dn));dq.set(aE,false);A._syncProxyNodeUI(dq);A.lassoStartPosition=A.lassoLastPosition=dm;A[bT].addClass(x).unselectable();A.originalDragNode=dp.target.get(cT);dp.target.set(cT,A[bD]);}},_onMouseDownGrid:function(dm){var A=this;var dn=dm.target;if(dn.test([cs+r,cs+cE].join(bN))){A._recording=true;A._syncCellDimensions();var dl=A._offsetXY([dm.pageX,dm.pageY],-1);A.lassoStartPosition=A.lassoLastPosition=A._findPosition(dl);A.renderLasso(A.lassoStartPosition,A.lassoLastPosition);A[bT].unselectable();}},_onMouseMoveGrid:function(dn){var dl=this;
var dp=dn.currentTarget;var dm=[dn.pageX,dn.pageY];var A=dl._findPosition(dl._offsetXY(dm,-1));if(dl._recording&&dl._hasLassoChanged(A)){dl.lassoLastPosition=A;dl.renderLasso(dl.lassoStartPosition,A);}},_onMouseUpGrid:function(dr){var dl=this;var dq=dl.get(s);var dn=dq.get(di);if(dn&&dl._recording&&!dq.get(ci)){var dp=dl._getPositionDate(dl.lassoStartPosition);var dm=dl._getPositionDate(dl.lassoLastPosition);var A=new Date(Math.min(dp,dm));A.setHours(0,0,0);var ds=new Date(Math.max(dp,dm));ds.setHours(23,59,59);dn.set(R,true);dn.set(aK,ds);dn.set(cQ,A);dn.showOverlay([dr.pageX,dr.pageY]);dl._recording=false;}},_setupDragDrop:function(){var dl=this;if(!dl[aH]){dl[aH]=new cL.DD.Delegate(dl.get(F));}var A=dl[aH][at];A.unplug(cL.Plugin.DDConstrained);A.unplug(cL.Plugin.DDNodeScroll);A.unplug(cL.Plugin.DDProxy);A.plug(cL.Plugin.DDConstrained,{bubbleTargets:dl,constrain:dl.bodyNode});A.plug(cL.Plugin.DDNodeScroll,{node:dl.bodyNode,scrollDelay:150});A.plug(cL.Plugin.DDProxy,{moveOnEnd:false,positionProxy:false});},_syncCellDimensions:function(){var A=this;var dm=A.get(bb);var dl=Math.ceil(dm/aY);var dn=Math.min(dm,aY);A.gridCellHeight=A[bT].get(cH)/dl;A.gridCellWidth=A[bT].get(cJ)/dn;},_syncProxyNodeUI:function(dl){var A=this;var dm=dl.get(dk).item(0);A[bD].setStyles({backgroundColor:dm.getStyle("backgroundColor"),display:"block",width:"200px"});A[bD].setContent(dl.get(aZ));},_uiSetCurrentDate:function(dl){var A=this;A.syncDaysHeaderUI();A.syncGridUI();},_valueColHeaderDaysNode:function(){var A=this;var dl=A.get(bb);var dm=Math.min(dl,aY);return A._valueNodeList(dm,f);},_valueTableGridNode:function(){var A=this;var dl=A.get(bb);var dm=Math.min(dl,aY);return A._valueNodeList(dm,bd);},_valueNodeList:function(dn,dm){var A=this;var dl=[];while(dn--){dl.push(dm);}return cL.NodeList.create(dl.join(cg));}}});cL.SchedulerTableView=bf;var bl=H(c8,a9,b4,an,aq);var aJ=cL.Component.create({NAME:c8,ATTRS:{displayDaysInterval:{readOnly:true,value:42},name:{value:cc}},EXTENDS:cL.SchedulerTableView,prototype:{getNextDate:function(){var A=this;var dm=A.get(s);var dl=dm.get(bB);return ay.add(dl,ay.MONTH,1);},getPrevDate:function(){var A=this;var dm=A.get(s);var dl=dm.get(bB);return ay.subtract(dl,ay.MONTH,1);},plotEvents:function(){var A=this;cL.SchedulerMonthView.superclass.plotEvents.apply(A,arguments);var dm=A.get(s);var dl=dm.get(bB);var dq=ay.findMonthEnd(dl);var dp=ay.findMonthStart(dl);var dn=A._findCurrentIntervalStart();var dr=A[cd].all(cs+bY);dr.each(function(du,ds){var dt=ay.add(dn,ay.DAY,ds);if(ay.before(dt,dp)||ay.after(dt,dq)){du.addClass(bl);}});},_findCurrentIntervalStart:function(){var A=this;var dn=A.get(s);var dl=dn.get(bB);var dm=ay.findMonthStart(dl);return A._findFirstDayOfWeek(dm);},_findFirstDayOfWeek:function(dm){var A=this;var dn=A.get(s);var dl=dn.get(cS);return ay.getFirstDayOfWeek(dm,dl);}}});cL.SchedulerMonthView=aJ;},"@VERSION@",{skinnable:true,requires:["aui-scheduler-event","aui-calendar","aui-button-item","dd-drag","dd-delegate","dd-drop","dd-constrain","dd-proxy"]});AUI.add("aui-scheduler-event",function(aK){var an=aK.Lang,bj=an.isString,f=an.isDate,a9=an.isFunction,G=an.isObject,bc=an.isBoolean,ac=an.isNumber,aY=aK.ColorUtil,j=aK.DataType.DateMath,a5=aK.cached(function(A){return A.substring(0,1).toUpperCase()+A.substring(1);}),be="-",t="&ndash;",ay=".",p="",q=" ",l="_",aM="_propagateSet",Q="activeView",T="borderColor",aO="borderColorRGB",aI="borderStyle",bq="borderWidth",I="Change",a3="color",aW="colorBrightnessFactor",bd="colorSaturationFactor",aG="content",w="disabled",a0="duration",aP="endDate",aS="eventClass",aq="eventStack",bk="events",au="hidden",H="hsbColor",at="icon",aa="icons",a1="id",ai="inherit",aX="isoTime",bp="locale",aZ="never",n="node",h="overlay",aL="parentEvent",bv="recorder",aN="repeat",bi="repeated",P="repeatedEvents",bb="repeater",af="scheduler",av="scheduler-event",ax="scheduler-event-recorder",bm="startDate",a7="template",aV="title",e="titleDateFormat",ao="visible",d="%H:%M",a6="%I:%M",E=aK.getClassName,k=E(at),s=E(av),aQ=E(av,aG),C=E(av,au),bg=E(av,w),ap=E(av,bv),aB=E(av,bi),am=E(av,bb),D=E(av,aV),bo=E(av,aa),v=E(av,at,w),b=E(av,at,bi),bs=E(av,at,bb);var V=aK.Component.create({NAME:av,ATTRS:{allDay:{setter:aK.DataType.Boolean.parse,value:false},borderStyle:{value:"solid",validator:bj},borderWidth:{value:"1px",validator:bj},colorBrightnessFactor:{value:0.75,validator:ac},colorSaturationFactor:{value:1.5,validator:ac},content:{value:"(no title)",validator:bj},color:{lazyAdd:false,setter:"_setColor",value:"#D96666",validator:bj},titleDateFormat:{getter:"_getTitleDateFormat",validator:bj},endDate:{setter:"_setDate",valueFn:function(){var A=j.clone(this.get(bm));A.setHours(A.getHours()+1);return A;}},eventClass:{valueFn:function(){return aK.SchedulerEvent;}},disabled:{value:false,validator:bc},node:{valueFn:function(){return aK.NodeList.create(aK.Node.create(this.EVENT_NODE_TEMPLATE).setData(av,this));}},parentEvent:{},repeat:{value:p,setter:"_setRepeat"},scheduler:{lazyAdd:false,setter:"_setScheduler"},startDate:{setter:"_setDate",valueFn:function(){return new Date();}},visible:{value:true,validator:bc}},EXTENDS:aK.Base,PROPAGATE_ATTRS:[bm,aP,aG,a3,aW,bd,aI,bq,e,ao,w],prototype:{EVENT_NODE_TEMPLATE:'<div class="'+s+'">'+'<div class="'+D+'"></div>'+'<div class="'+aQ+'"></div>'+'<div class="'+bo+'">'+'<span class="'+[k,b].join(q)+'"></span>'+'<span class="'+[k,bs].join(q)+'"></span>'+'<span class="'+[k,v].join(q)+'"></span>'+"</div>"+"</div>",eventStack:null,initializer:function(){var A=this;var L=A.get(n);A[aq]={};aK.Array.each(A.get(aS).PROPAGATE_ATTRS,function(X){A.after(X+I,A._propagateAttrChange);});A._bindUIAttrs();A.syncNodeUI(true);},destroy:function(){var A=this;A.eachRepeatedEvent(function(L,X){L.destroy();});A[aq]={};A.get(n).remove(true);},addPaddingNode:function(){var A=this;A.get(n).push(aK.Node.create(A.EVENT_NODE_TEMPLATE).setData(av,A));A.syncNodeUI();},copyDates:function(L){var A=this;A.set(aP,j.clone(L.get(aP)));A.set(bm,j.clone(L.get(bm)));},copyPropagateAttrValues:function(L,X){var A=this;
A.copyDates(L);aK.Array.each(A.get(aS).PROPAGATE_ATTRS,function(Y){if(!((X||{}).hasOwnProperty(Y))){var bA=L.get(Y);if(!G(bA)){A.set(Y,bA);}}});},getBorderColor:function(){var A=this;return A[aO].hex;},getDaysDuration:function(){var A=this;return j.getDayOffset(A.get(aP),A.get(bm));},getHoursDuration:function(){var A=this;return j.getHoursOffset(A.get(aP),A.get(bm));},getMinutesDuration:function(){var A=this;return j.getMinutesOffset(A.get(aP),A.get(bm));},getSecondsDuration:function(){var A=this;return j.getSecondsOffset(A.get(aP),A.get(bm));},sameEndDate:function(L){var A=this;return j.compare(A.get(aP),L.get(aP));},sameStartDate:function(L){var A=this;return j.compare(A.get(bm),L.get(bm));},isAfter:function(Y){var X=this;var L=X.get(bm);var A=Y.get(bm);return j.after(L,A);},isBefore:function(Y){var X=this;var L=X.get(bm);var A=Y.get(bm);return j.before(L,A);},repeatByDate:function(X){var L=this;var Y=L.uidByDate(X);if(!L[aq][Y]){var A=j.clone(X);var bB=j.clone(X);j.copyHours(A,L.get(bm));j.copyHours(bB,L.get(aP));var bA=new L.get(aS)({endDate:bB,parentEvent:L,scheduler:L.get(af),startDate:A});bA.copyPropagateAttrValues(L);L[aq][Y]=bA;}return L[aq][Y];},intersects:function(Y){var X=this;var bA=X.get(aP);var L=X.get(bm);var A=Y.get(bm);return(X.sameStartDate(Y)||j.between(A,L,bA));},intersectHours:function(X){var L=this;var bA=L.get(aP);var A=L.get(bm);var Y=j.clone(A);j.copyHours(Y,X.get(bm));return(j.compare(A,Y)||j.between(Y,A,bA));},isDayBoundaryEvent:function(){var A=this;return j.isDayBoundary(A.get(bm),A.get(aP));},isDayOverlapEvent:function(){var A=this;return j.isDayOverlap(A.get(bm),A.get(aP));},isRepeatableDate:function(L){var A=this;var X=A.get(aN);return(X&&X.validate(A,L));},getClearEndDate:function(){var A=this;return j.safeClearTime(A.get(aP));},getClearStartDate:function(){var A=this;return j.safeClearTime(A.get(bm));},move:function(L){var A=this;var X=A.getMinutesDuration();A.set(bm,L);A.set(aP,j.add(j.clone(L),j.MINUTES,X));},uidByDate:function(L){var A=this;L=f(L)?j.safeClearTime(L):A.getClearStartDate();return[av,L.getTime()].join(l);},setContent:function(X,L){var A=this;A.get(n).each(function(bA){var Y=bA.one(g+aQ);Y.setContent(X);});if(L){A.eachRepeatedEvent(function(Y,bA){Y.setContent(X);});}},setTitle:function(X,L){var A=this;A.get(n).each(function(Y){var bA=Y.one(g+D);bA.setContent(X);});if(L){A.eachRepeatedEvent(function(Y,bA){Y.setTitle(X);});}},syncNodeUI:function(L){var A=this;A._syncUIAttrs();A.syncNodeColorUI(L);A.syncNodeTitleUI(L);A.syncNodeContentUI(L);},syncNodeColorUI:function(L){var A=this;var Y=A.get(n);var bA=A.getBorderColor();if(Y){var X={borderWidth:A.get(bq),borderColor:bA,backgroundColor:A.get(a3),borderStyle:A.get(aI),color:ai};Y.setStyles(X);}if(L){A.eachRepeatedEvent(function(bB,bC){bB.syncNodeColorUI();});}},syncNodeContentUI:function(L){var A=this;A.setContent(A.get(aG),L);},syncNodeTitleUI:function(L){var A=this;var Y=A._formatDate(A.get(bm));var X=A._formatDate(A.get(aP));A.setTitle([Y,X].join(q+t+q),L);},split:function(){var A=this,X=j.clone(A.get(bm)),Y=j.clone(A.get(aP));if(A.isDayOverlapEvent()&&!A.isDayBoundaryEvent()){var L=j.clone(X);L.setHours(24,0,0,0);return[[X,j.toMidnight(j.clone(X))],[L,j.clone(Y)]];}return[[X,Y]];},eachRepeatedEvent:function(L){var A=this;aK.each(A[aq],L,A);},unlink:function(){var A=this;if(A.get(aL)){A.set(aL,null);}else{A.eachRepeatedEvent(function(L,X){L.unlink();});}A[aq]={};A.syncNodeUI();},_afterDisabledChange:function(L){var A=this;A._uiSetDisabled(L.newVal);},_afterVisibleChange:function(L){var A=this;A._uiSetVisible(L.newVal);},_afterRepeatChange:function(L){var A=this;A._uiSetRepeat(L.newVal);},_afterParentEventChange:function(L){var A=this;A._uiSetParentEvent(L.newVal);},_bindUIAttrs:function(){var A=this;A.after({disabledChange:A._afterDisabledChange,visibleChange:A._afterVisibleChange,parentEventChange:A._afterParentEventChange,repeatChange:A._afterRepeatChange});A._syncUIAttrs();},_propagateAttrChange:function(Y){var A=this;var X=Y.attrName;var L=Y.newVal;A.eachRepeatedEvent(function(bA,bB){var bC=bA[aM+a5(X)];if(bC){bC.apply(A,[bA,X,L]);}else{bA.set(X,Y.newVal);}bA.syncNodeUI();});A.syncNodeUI();},_propagateSetEndDate:function(A,L,Y){var X=j.clone(A.get(aP));j.copyHours(X,Y);A.set(aP,X);},_propagateSetStartDate:function(L,X,Y){var A=j.clone(L.get(bm));j.copyHours(A,Y);L.set(bm,A);},_setColor:function(L){var A=this;A[H]=aY.rgb2hsb(aY.getRGB(L));A[T]=aK.clone(A[H]);A[T].b*=A.get(aW);A[T].s*=A.get(bd);A[aO]=aY.hsb2rgb(A[T]);return L;},_setDate:function(L){var A=this;if(ac(L)){L=new Date(L);}return L;},_setRepeat:function(L){var A=this;if(bj(L)){L=aK.SchedulerEventRepeat[L];}return G(L)?L:null;},_setScheduler:function(X){var A=this;var L=A.get(af);if(L){A.removeTarget(L);}A.addTarget(X);return X;},_syncUIAttrs:function(){var A=this;A._uiSetDisabled(A.get(w));A._uiSetVisible(A.get(ao));A._uiSetParentEvent(A.get(aL));A._uiSetRepeat(A.get(aN));},_formatDate:function(X,Y){var L=this;var A=L.get(bp);Y=Y||L.get(e);return aK.DataType.Date.format(X,{format:Y,locale:A});},_getTitleDateFormat:function(X){var A=this;if(!bj(X)){var L=A.get(af);X=(L&&L.get(Q).get(aX))?d:a6;}return X;},_uiSetDisabled:function(L){var A=this;A.get(n).toggleClass(bg,!!L);},_uiSetParentEvent:function(L){var A=this;A.get(n).toggleClass(aB,!!L);},_uiSetRepeat:function(X){var A=this;var L=!!X&&X!==aK.SchedulerEventRepeat[aZ];A.get(n).toggleClass(am,L);},_uiSetVisible:function(L){var A=this;A.get(n).toggleClass(C,!L);}}});aK.SchedulerEvent=V;aK.SchedulerEventRepeat={never:{description:"Never repeat",validate:function(A,L){return false;},value:"never"},daily:{description:"Every day",validate:function(A,L){return true;},value:"daily"},monthly:{description:"Every month",validate:function(L,X){var Y=L.get(aP);var A=L.get(bm);return(A.getDate()===X.getDate());},value:"monthly"},monWedFri:{description:"Every Monday, Wednesday and Friday",validate:function(A,L){return j.isMonWedOrFri(L);},value:"monWedFri"},tuesThurs:{description:"Every Tuesday and Thursday",validate:function(A,L){return j.isTueOrThu(L);
},value:"tuesThurs"},weekDays:{description:"Every week days",validate:function(A,L){return j.isWeekDay(L);},value:"weekDays"},weekly:{description:"Every week",validate:function(L,X){var Y=L.get(aP);var A=L.get(bm);return(A.getDay()===X.getDay());},value:"weekly"},yearly:{description:"Every year",validate:function(L,X){var Y=L.get(aP);var A=L.get(bm);return((A.getMonth()===X.getMonth())&&(A.getDay()===X.getDay()));},value:"yearly"}};var aw=aK.Lang,a=aw.isArray,G=aw.isObject,Q="activeView",J="allDay",c="arrow",aU="body",aA="bodyContent",o="boundingBox",az="cancel",a2="click",aG="content",aT="date",aH="dateFormat",aj="delete",ba="description",R="edit",bu="event",aS="eventClass",B="footerContent",aE="form",z="header",u="hide",aX="isoTime",aF="link",n="node",O="offsetHeight",bh="offsetWidth",h="overlay",S="overlayOffset",bv="recorder",br="rendered",aN="repeat",a4="save",af="scheduler",m="schedulerChange",av="scheduler-event",ax="scheduler-event-recorder",aD="shadow",aC="show",F="startDateChange",N="strings",a7="template",aV="title",bt="tl",ab="toolbar",bl="submit",bn="value",aR="visibleChange",Z="when",al="x",ak="y",ae="cancel",M="delete",y="edit",aJ="save",bw="-",g=".",ad="",i="#",r=aK.IO.prototype._serialize,E=aK.getClassName,s=E(af,bu),ap=E(af,bu,bv),bx=E(af,bu,bv,h),x=E(af,bu,bv,h,c),bf=E(af,bu,bv,h,c,aD),ah=E(af,bu,bv,h,aU),a8=E(af,bu,bv,h,aG),ag=E(af,bu,bv,h,aT),U=E(af,bu,bv,h,aE),bz=E(af,bu,bv,h,z),ar=E(af,bu,bv,h,aN),D=E(af,bu,aV),K=new aK.Template('<div class="',bf," ",x,'"></div>','<div class="',x,'"></div>','<input type="hidden" name="startDate" value="{startDate}" />','<input type="hidden" name="endDate" value="{endDate}" />','<div class="',bz,'">','<input class="',a8,'" name="content" value="{content}" />',"</div>",'<div class="',ah,'">','<label class="',ag,'">{date}</label>','<select class="',ar,'" name="repeat">','<tpl for="eventRepeat">','<option {[ (parent.repeat && parent.repeat.value) == parent.eventRepeat[$i].value ? \'selected="selected"\' : "" ]} value="{value}">{description}</option>',"</tpl>","</select>","</div>"),by='<form class="'+U+'" id="schedulerEventRecorderForm"></form>';var W=aK.Component.create({NAME:ax,ATTRS:{allDay:{value:false},content:{value:ad},duration:{value:60},dateFormat:{validator:bj,value:"%a, %B %d,"},event:{},eventClass:{valueFn:function(){return aK.SchedulerEvent;}},strings:{value:{},setter:function(A){return aK.merge({"delete":"Delete","description-hint":"e.g., Dinner at Brian's","no-repeat":"No repeat",cancel:"Cancel",description:"Description",edit:"Edit",repeat:"Repeat",save:"Save",when:"When"},A||{});},validator:G},overlay:{validator:G,value:{align:{points:[bt,bt]},visible:false,width:300,zIndex:500}},overlayOffset:{value:[15,-38],validator:a},template:{value:K},toolbar:{setter:function(X){var L=this;var A=L.get(N);return aK.merge({children:[{handler:aK.bind(L._handleSaveEvent,L),label:A[a4]},{handler:aK.bind(L._handleCancelEvent,L),label:A[az]},{handler:aK.bind(L._handleDeleteEvent,L),label:A[aj]}]},X||{});},validator:G,value:{}}},EXTENDS:aK.SchedulerEvent,prototype:{initializer:function(){var A=this;A.get(n).addClass(ap);A.publish(ae,{defaultFn:A._defCancelEventFn});A.publish(M,{defaultFn:A._defDeleteEventFn});A.publish(y,{defaultFn:A._defEditEventFn});A.publish(aJ,{defaultFn:A._defSaveEventFn});A.after(m,A._afterSchedulerChange);A[h]=new aK.Overlay(A.get(h));A[ab]=new aK.Toolbar(A.get(ab));},_afterSchedulerChange:function(Y){var A=this;var X=Y.newVal;var L=X.get(o);L.delegate(a2,aK.bind(A._onClickSchedulerEvent,A),g+s);},_defCancelEventFn:function(L){var A=this;A.get(n).remove();A.hideOverlay();},_defDeleteEventFn:function(X){var A=this;var L=A.get(af);L.removeEvent(A.get(bu));A.hideOverlay();L.syncEventsUI();},_defEditEventFn:function(X){var A=this;var L=A.get(af);A.hideOverlay();L.syncEventsUI();},_defSaveEventFn:function(X){var A=this;var L=A.get(af);L.addEvent(X.newSchedulerEvent);A.hideOverlay();L.syncEventsUI();},_handleCancelEvent:function(L){var A=this;A.fire(ae);L.preventDefault();},_handleDeleteEvent:function(L){var A=this;A.fire(M,{schedulerEvent:A.get(bu)});L.preventDefault();},_handleSaveEvent:function(L){var A=this;A.fire(A.get(bu)?y:aJ,{newSchedulerEvent:A.getEventCopy()});L.preventDefault();},_onClickSchedulerEvent:function(X){var A=this;var L=X.currentTarget.getData(av);if(L){A.set(bu,L);A.showOverlay([X.pageX,X.pageY]);A.get(n).remove();}},_onOverlayVisibleChange:function(Y){var L=this;if(Y.newVal){L.populateForm();if(!L.get(bu)){var X=L[h].get(o);var A=X.one(g+a8);setTimeout(function(){A.selectText();},0);}}else{L.set(bu,null);L.get(n).remove();}},_onSubmitForm:function(L){var A=this;A._handleSaveEvent(L);},_renderOverlay:function(){var L=this;var A=L.get(N);L[h].render();L[ab].render();var X=L[h].get(o);X.addClass(bx);L[h].set(B,L[ab].get(o));L[h].on(aR,aK.bind(L._onOverlayVisibleChange,L));L.formNode=aK.Node.create(by);L[h].set(aA,L.formNode);L.formNode.on(bl,aK.bind(L._onSubmitForm,L));},getEventCopy:function(){var A=this;var X=A.get(bu);if(!X){X=new (A.get(aS))({allDay:A.get(J),endDate:A.get(aP),scheduler:A.get(af),startDate:A.get(bm)});X.copyPropagateAttrValues(A,{content:true});}var L=A.serializeForm();X.set(aG,L[aG]);X.set(aN,L[aN]);return X;},getFormattedDate:function(){var X=this;var L=X.get(aH);var bA=(X.get(bu)||X);var bC=bA.get(aP);var bB=bA.get(af);var A=bA.get(bm);var Y=(bB.get(Q).get(aX)?j.toIsoTimeString:j.toUsTimeString);return[bA._formatDate(A,L),Y(A),be,Y(bC)].join(q);},getTemplateData:function(){var L=this;var A=L.get(N);var X=(L.get(bu)||L);return{content:X.get(aG)||A["description-hint"],date:L.getFormattedDate(),endDate:X.get(aP).getTime(),eventRepeat:L.eventRepeatArray,repeat:X.get(aN),startDate:X.get(bm).getTime()};},hideOverlay:function(){var A=this;A[h].hide();},populateForm:function(){var A=this;if(!A.eventRepeatArray){A.eventRepeatArray=[];aK.each(aK.SchedulerEventRepeat,function(L){A.eventRepeatArray.push({description:L[ba],value:L[bn]});});}A.formNode.setContent(A.get(a7).parse(A.getTemplateData()));
},serializeForm:function(){var A=this;return aK.QueryString.parse(r(A.formNode.getDOM()));},showOverlay:function(Y,bB){var A=this;var X=A.get(S);if(!A[h].get(br)){A._renderOverlay();}A[h].show();if(!Y){var L=(A.get(bu)||A).get(n);var bA=L.one(g+D);bB=[X[0]+bA.get(bh),X[1]+bA.get(O)/2];Y=bA.getXY();}bB=bB||X;Y[0]+=bB[0];Y[1]+=bB[1];A[h].set("xy",Y);}}});aK.SchedulerEventRecorder=W;},"@VERSION@",{skinnable:true,requires:["aui-base","aui-color-util","aui-datatype","aui-template","aui-toolbar","io-form","querystring","overlay"]});AUI.add("aui-scheduler-calendar",function(d){var i=d.Lang,j=i.isArray,c=i.isBoolean,b=i.isString,g=function(o){return(o instanceof d.SchedulerEvent);},a="color",k="disabled",m="events",h="pallete",n="scheduler",e="scheduler-calendar",l="visible";var f=d.Component.create({NAME:e,ATTRS:{color:{valueFn:function(){var p=this;var q=p.get(h);var o=Math.ceil(Math.random()*q.length)-1;return q[o];},validator:b},disabled:{value:false,validator:c},name:{value:"(no name)",validator:b},pallete:{value:["#d96666","#e67399","#b373b3","#8c66d9","#668cb3","#668cd9","#59bfb3","#65ad89","#4cb052","#8cbf40","#bfbf4d","#e0c240","#f2a640","#e6804d","#be9494","#a992a9","#8997a5","#94a2be","#85aaa5","#a7a77d","#c4a883","#c7561e","#b5515d","#c244ab","#603f99","#536ca6","#3640ad","#3c995b","#5ca632","#7ec225","#a7b828","#cf9911","#d47f1e","#b56414","#914d14","#ab2671","#9643a5","#4585a3","#737373","#41a587","#d1bc36","#ad2d2d"],validator:j},scheduler:{lazyAdd:false,setter:"_setScheduler"},visible:{value:true,validator:c}},EXTENDS:d.Base,AUGMENTS:d.SchedulerEventSupport,prototype:{initializer:function(){var o=this;o.after("colorChange",o._afterColorChange);o.after("disabledChange",o._afterDisabledChange);o.after("eventsChange",o._afterEventsChange);o.after("visibleChange",o._afterVisibleChange);o._uiSetColor(o.get(a));o._uiSetDisabled(o.get(k));o._uiSetEvents(o.get(m));o._uiSetVisible(o.get(l));},_afterColorChange:function(p){var o=this;o._uiSetColor(p.newVal);},_afterDisabledChange:function(p){var o=this;o._uiSetDisabled(p.newVal);},_afterEventsChange:function(p){var o=this;o._uiSetEvents(p.newVal);},_afterVisibleChange:function(p){var o=this;o._uiSetVisible(p.newVal);},_propagateAttr:function(p,q){var o=this;o.eachEvent(function(r){r.set(p,q);});},_setScheduler:function(q){var o=this;var p=o.get(n);if(p){o.removeTarget(p);}o.addTarget(q);return q;},_uiSetColor:function(p){var o=this;o._propagateAttr(a,o.get(a));},_uiSetDisabled:function(p){var o=this;o._propagateAttr(k,p);},_uiSetEvents:function(q){var o=this;var p=o.get(n);o._propagateAttr(a,o.get(a));o._propagateAttr(k,o.get(k));o._propagateAttr(l,o.get(l));if(p){p.removeEvents(o);p.addEvents(q);p.syncEventsUI();}},_uiSetVisible:function(p){var o=this;o._propagateAttr(l,p);}}});d.SchedulerCalendar=f;},"@VERSION@",{requires:["aui-scheduler-event"],skinnable:false});AUI.add("aui-scheduler",function(a){},"@VERSION@",{skinnable:true,use:["aui-scheduler-base","aui-scheduler-view","aui-scheduler-event","aui-scheduler-calendar"]});